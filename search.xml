<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>反调试笔记</title>
    <url>//anti-debug-note.html</url>
    <content><![CDATA[<h1 id="反调试技术">反调试技术</h1>
<p><strong>调试技术</strong>可以直接探查出程序运行的机制，程序作者为了隐藏程序底层机制而通过<strong>反调试技术</strong>来反制。</p>
<p>对于一般的程序需要防止核心代码被调试逆向，软件或专利技术被破解；而病毒或恶意代码会隐藏自己的恶意行为防止被跟踪。</p>
<p>所以对于<strong>反调试技术</strong>我们是有了解的必要的。</p>
<h1 id="windows-前置知识">Windows 前置知识</h1>
<p>以下存在未公开结构体 (地址为 32 位，具体请参考微软官方文档)</p>
<h2 id="teb-线程环境块">TEB 线程环境块</h2>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">TEB</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    NT_TIB Tib;                             <span class="comment">/* 00h */</span></span><br><span class="line">    PVOID EnvironmentPointer;               <span class="comment">/* 1Ch */</span></span><br><span class="line">    CLIENT_ID Cid;                          <span class="comment">/* 20h */</span></span><br><span class="line">    PVOID ActiveRpcHandle;                  <span class="comment">/* 28h */</span></span><br><span class="line">    PVOID ThreadLocalStoragePointer;        <span class="comment">/* 2Ch */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">PEB</span> *<span class="title">ProcessEnvironmentBlock</span>;</span>   <span class="comment">/* 30h */</span></span><br><span class="line">    ULONG LastErrorValue;                   <span class="comment">/* 34h */</span></span><br><span class="line">    ULONG CountOfOwnedCriticalSections;     <span class="comment">/* 38h */</span></span><br><span class="line">    PVOID CsrClientThread;                  <span class="comment">/* 3Ch */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">W32THREAD</span>* <span class="title">Win32ThreadInfo</span>;</span>     <span class="comment">/* 40h */</span></span><br><span class="line">    ULONG User32Reserved[<span class="number">0x1A</span>];             <span class="comment">/* 44h */</span></span><br><span class="line">    ULONG UserReserved[<span class="number">5</span>];                  <span class="comment">/* ACh */</span></span><br><span class="line">    PVOID WOW32Reserved;                    <span class="comment">/* C0h */</span></span><br><span class="line">    LCID CurrentLocale;                     <span class="comment">/* C4h */</span></span><br><span class="line">    ULONG FpSoftwareStatusRegister;         <span class="comment">/* C8h */</span></span><br><span class="line">    PVOID SystemReserved1[<span class="number">0x36</span>];            <span class="comment">/* CCh */</span></span><br><span class="line">    LONG ExceptionCode;                     <span class="comment">/* 1A4h */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">ACTIVATION_CONTEXT_STACK</span> *<span class="title">ActivationContextStackPointer</span>;</span> <span class="comment">/* 1A8h */</span></span><br><span class="line">    UCHAR SpareBytes1[<span class="number">0x28</span>];                <span class="comment">/* 1ACh */</span></span><br><span class="line">    GDI_TEB_BATCH GdiTebBatch;              <span class="comment">/* 1D4h */</span></span><br><span class="line">    CLIENT_ID RealClientId;                 <span class="comment">/* 6B4h */</span></span><br><span class="line">    PVOID GdiCachedProcessHandle;           <span class="comment">/* 6BCh */</span></span><br><span class="line">    ULONG GdiClientPID;                     <span class="comment">/* 6C0h */</span></span><br><span class="line">    ULONG GdiClientTID;                     <span class="comment">/* 6C4h */</span></span><br><span class="line">    PVOID GdiThreadLocalInfo;               <span class="comment">/* 6C8h */</span></span><br><span class="line">    ULONG Win32ClientInfo[<span class="number">62</span>];              <span class="comment">/* 6CCh */</span></span><br><span class="line">    PVOID glDispatchTable[<span class="number">0xE9</span>];            <span class="comment">/* 7C4h */</span></span><br><span class="line">    ULONG glReserved1[<span class="number">0x1D</span>];                <span class="comment">/* B68h */</span></span><br><span class="line">    PVOID glReserved2;                      <span class="comment">/* BDCh */</span></span><br><span class="line">    PVOID glSectionInfo;                    <span class="comment">/* BE0h */</span></span><br><span class="line">    PVOID glSection;                        <span class="comment">/* BE4h */</span></span><br><span class="line">    PVOID glTable;                          <span class="comment">/* BE8h */</span></span><br><span class="line">    PVOID glCurrentRC;                      <span class="comment">/* BECh */</span></span><br><span class="line">    PVOID glContext;                        <span class="comment">/* BF0h */</span></span><br><span class="line">    NTSTATUS LastStatusValue;               <span class="comment">/* BF4h */</span></span><br><span class="line">    UNICODE_STRING StaticUnicodeString;     <span class="comment">/* BF8h */</span></span><br><span class="line">    WCHAR StaticUnicodeBuffer[<span class="number">0x105</span>];       <span class="comment">/* C00h */</span></span><br><span class="line">    PVOID DeallocationStack;                <span class="comment">/* E0Ch */</span></span><br><span class="line">    PVOID TlsSlots[<span class="number">0x40</span>];                   <span class="comment">/* E10h */</span></span><br><span class="line">    LIST_ENTRY TlsLinks;                    <span class="comment">/* F10h */</span></span><br><span class="line">    PVOID Vdm;                              <span class="comment">/* F18h */</span></span><br><span class="line">    PVOID ReservedForNtRpc;                 <span class="comment">/* F1Ch */</span></span><br><span class="line">    PVOID DbgSsReserved[<span class="number">0x2</span>];               <span class="comment">/* F20h */</span></span><br><span class="line">    ULONG HardErrorDisabled;                <span class="comment">/* F28h */</span></span><br><span class="line">    PVOID Instrumentation[<span class="number">14</span>];              <span class="comment">/* F2Ch */</span></span><br><span class="line">    PVOID SubProcessTag;                    <span class="comment">/* F64h */</span></span><br><span class="line">    PVOID EtwTraceData;                     <span class="comment">/* F68h */</span></span><br><span class="line">    PVOID WinSockData;                      <span class="comment">/* F6Ch */</span></span><br><span class="line">    ULONG GdiBatchCount;                    <span class="comment">/* F70h */</span></span><br><span class="line">    BOOLEAN InDbgPrint;                     <span class="comment">/* F74h */</span></span><br><span class="line">    BOOLEAN FreeStackOnTermination;         <span class="comment">/* F75h */</span></span><br><span class="line">    BOOLEAN HasFiberData;                   <span class="comment">/* F76h */</span></span><br><span class="line">    UCHAR IdealProcessor;                   <span class="comment">/* F77h */</span></span><br><span class="line">    ULONG GuaranteedStackBytes;             <span class="comment">/* F78h */</span></span><br><span class="line">    PVOID ReservedForPerf;                  <span class="comment">/* F7Ch */</span></span><br><span class="line">    PVOID ReservedForOle;                   <span class="comment">/* F80h */</span></span><br><span class="line">    ULONG WaitingOnLoaderLock;              <span class="comment">/* F84h */</span></span><br><span class="line">    ULONG SparePointer1;                    <span class="comment">/* F88h */</span></span><br><span class="line">    ULONG SoftPatchPtr1;                    <span class="comment">/* F8Ch */</span></span><br><span class="line">    ULONG SoftPatchPtr2;                    <span class="comment">/* F90h */</span></span><br><span class="line">    PVOID *TlsExpansionSlots;               <span class="comment">/* F94h */</span></span><br><span class="line">    ULONG ImpersionationLocale;             <span class="comment">/* F98h */</span></span><br><span class="line">    ULONG IsImpersonating;                  <span class="comment">/* F9Ch */</span></span><br><span class="line">    PVOID NlsCache;                         <span class="comment">/* FA0h */</span></span><br><span class="line">    PVOID pShimData;                        <span class="comment">/* FA4h */</span></span><br><span class="line">    ULONG HeapVirualAffinity;               <span class="comment">/* FA8h */</span></span><br><span class="line">    PVOID CurrentTransactionHandle;         <span class="comment">/* FACh */</span></span><br><span class="line">    PTEB_ACTIVE_FRAME ActiveFrame;          <span class="comment">/* FB0h */</span></span><br><span class="line">    PVOID FlsData;                          <span class="comment">/* FB4h */</span></span><br><span class="line">    UCHAR SafeThunkCall;                    <span class="comment">/* FB8h */</span></span><br><span class="line">    UCHAR BooleanSpare[<span class="number">3</span>];                  <span class="comment">/* FB9h */</span></span><br><span class="line">&#125; TEB, *PTEB;</span><br></pre></td></tr></table></figure>
<h2 id="peb-进程环境块">PEB 进程环境块</h2>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">PEB</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    UCHAR InheritedAddressSpace; 			<span class="comment">/*  00h */</span></span><br><span class="line">    UCHAR ReadImageFileExecOptions; 		<span class="comment">/*  01h */</span></span><br><span class="line">    UCHAR BeingDebugged; 			        <span class="comment">/*  02h */</span></span><br><span class="line">    UCHAR Spare; 			                <span class="comment">/*  03h */</span></span><br><span class="line">    PVOID Mutant; 		                	<span class="comment">/*  04h */</span></span><br><span class="line">    PVOID ImageBaseAddress; 	    		<span class="comment">/*  08h */</span></span><br><span class="line">    PPEB_LDR_DATA Ldr; 		               	<span class="comment">/*  0Ch */</span></span><br><span class="line">    PRTL_USER_PROCESS_PARAMETERS ProcessParameters; 			<span class="comment">/*  10h */</span></span><br><span class="line">    PVOID SubSystemData; 		           	<span class="comment">/*  14h */</span></span><br><span class="line">    PVOID ProcessHeap; 			            <span class="comment">/*  18h */</span></span><br><span class="line">    PVOID FastPebLock; 		            	<span class="comment">/*  1Ch */</span></span><br><span class="line">    PPEBLOCKROUTINE FastPebLockRoutine; 	<span class="comment">/*  20h */</span></span><br><span class="line">    PPEBLOCKROUTINE FastPebUnlockRoutine;	<span class="comment">/*  24h */</span></span><br><span class="line">    ULONG EnvironmentUpdateCount; 			<span class="comment">/*  28h */</span></span><br><span class="line">    PVOID* KernelCallbackTable; 			<span class="comment">/*  2Ch */</span></span><br><span class="line">    PVOID EventLogSection; 		        	<span class="comment">/*  30h */</span></span><br><span class="line">    PVOID EventLog; 		            	<span class="comment">/*  34h */</span></span><br><span class="line">    PPEB_FREE_BLOCK FreeList; 		    	<span class="comment">/*  38h */</span></span><br><span class="line">    ULONG TlsExpansionCounter; 		    	<span class="comment">/*  3Ch */</span></span><br><span class="line">    PVOID TlsBitmap; 			            <span class="comment">/*  40h */</span></span><br><span class="line">    ULONG TlsBitmapBits[<span class="number">0x2</span>]; 		    	<span class="comment">/*  44h */</span></span><br><span class="line">    PVOID ReadOnlySharedMemoryBase; 		<span class="comment">/*  4Ch */</span></span><br><span class="line">    PVOID ReadOnlySharedMemoryHeap; 		<span class="comment">/*  50h */</span></span><br><span class="line">    PVOID* ReadOnlyStaticServerData; 		<span class="comment">/*  54h */</span></span><br><span class="line">    PVOID AnsiCodePageData; 		    	<span class="comment">/*  58h */</span></span><br><span class="line">    PVOID OemCodePageData; 		        	<span class="comment">/*  5Ch */</span></span><br><span class="line">    PVOID UnicodeCaseTableData; 			<span class="comment">/*  60h */</span></span><br><span class="line">    ULONG NumberOfProcessors; 		    	<span class="comment">/*  64h */</span></span><br><span class="line">    ULONG NtGlobalFlag; 		        	<span class="comment">/*  68h */</span></span><br><span class="line">    UCHAR Spare2[<span class="number">0x4</span>]; 		            	<span class="comment">/*  6Ch */</span></span><br><span class="line">    LARGE_INTEGER CriticalSectionTimeout; 	<span class="comment">/*  70h */</span></span><br><span class="line">    ULONG HeapSegmentReserve; 		    	<span class="comment">/*  78h */</span></span><br><span class="line">    ULONG HeapSegmentCommit; 		    	<span class="comment">/*  7Ch */</span></span><br><span class="line">    ULONG HeapDeCommitTotalFreeThreshold; 	<span class="comment">/*  80h */</span></span><br><span class="line">    ULONG HeapDeCommitFreeBlockThreshold; 	<span class="comment">/*  84h */</span></span><br><span class="line">    ULONG NumberOfHeaps; 		        	<span class="comment">/*  88h */</span></span><br><span class="line">    ULONG MaximumNumberOfHeaps; 			<span class="comment">/*  8Ch */</span></span><br><span class="line">    PVOID** ProcessHeaps; 			        <span class="comment">/*  90h */</span></span><br><span class="line">    PVOID GdiSharedHandleTable; 			<span class="comment">/*  94h */</span></span><br><span class="line">    PVOID ProcessStarterHelper; 			<span class="comment">/*  98h */</span></span><br><span class="line">    PVOID GdiDCAttributeList; 		    	<span class="comment">/*  9Ch */</span></span><br><span class="line">    PVOID LoaderLock; 		            	<span class="comment">/*  A0h */</span></span><br><span class="line">    ULONG OSMajorVersion; 			        <span class="comment">/*  A4h */</span></span><br><span class="line">    ULONG OSMinorVersion; 			        <span class="comment">/*  A8h */</span></span><br><span class="line">    ULONG OSBuildNumber; 			        <span class="comment">/*  ACh */</span></span><br><span class="line">    ULONG OSPlatformId; 			        <span class="comment">/*  B0h */</span></span><br><span class="line">    ULONG ImageSubSystem; 			        <span class="comment">/*  B4h */</span></span><br><span class="line">    ULONG ImageSubSystemMajorVersion; 		<span class="comment">/*  B8h */</span></span><br><span class="line">    ULONG ImageSubSystemMinorVersion; 		<span class="comment">/*  C0h */</span></span><br><span class="line">    ULONG GdiHandleBuffer[<span class="number">0x22</span>]; 			<span class="comment">/*  C4h */</span></span><br><span class="line">    PVOID ProcessWindowStation; 			<span class="comment">/*  ??? */</span></span><br><span class="line">&#125; PEB, *PPEB;</span><br></pre></td></tr></table></figure>
<h2 id="tls-线程局部存储">TLS 线程局部存储</h2>
<p>线程局部存储用来将数据与一个正在执行的指定线程关联起来。</p>
<p>它主要是为了避免多个线程同时访存同一全局变量或者静态变量时所导致的冲突，尤其是多个线程同时需要修改这一变量时。为了解决这个问题，我们可以通过TLS机制，为每一个使用该全局变量的线程都提供一个变量值的副本，每一个线程均可以独立地改变自己的副本，而不会和其它线程的副本冲突。从线程的角度看，就好像每一个线程都完全拥有该变量。而从全局变量的角度上来看，就好像一个全局变量被克隆成了多份副本，而每一份副本都可以被一个线程独立地改变。</p>
<h1 id="winapi-反调试">WinAPI 反调试</h1>
<p>在头文件 <code>windows.h</code> 中存在函数
<code>IsDebuggerPresent()</code></p>
<p>当函数返回 <code>true</code> 代表检测到调试器，<code>false</code>
则代表未检测到调试器</p>
<p>相同功能的函数还有 <code>CheckRemoteDebuggerPresent()</code></p>
<p>同时还可以通过
<code>FindWindow</code>、<code>EnumWindows</code>或是<code>GetForegroundWindow</code>粗暴查询主流调试器窗口名</p>
<p>又或者通过
<code>CreateToolhelp32Snapshot</code>、<code>Process32First</code>和<code>Process32Next</code>查询所有的进程来排查主流调试器进程是否存在</p>
<p>甚至可以通过判断父进程是否为<code>explorer.exe</code>来检查是否被调试，因为一般来说双击点开的程序的父进程都是<code>explorer.exe</code></p>
<h1 id="利用-peb-标志位">利用 PEB 标志位</h1>
<p><code>IsDebuggerPresent()</code> 实际上也是取 <code>PEB</code>
结构体中的 <code>BeingDebugged</code> 标志位</p>
<p>当调试器开始调试应用程序的时候，操作系统会将目标应用程序的
<code>PEB</code> 结构体中的 <code>BeingDebugged</code> 标志位置为 1</p>
<p>而 <code>FS[]</code> 寄存器指向 <code>TEB</code> 结构体</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov eax, fs:[30h]		; 取 PEB 首地址</span><br><span class="line">mov eax, [eax+2]		; 取 PEB 首地址偏移 2 的位置</span><br><span class="line">and eax, 0xff			; 只需要低 2 位的 PEB-&gt;BeingDebugged</span><br></pre></td></tr></table></figure>
<p>或者 (<code>NtGlobalFlag</code> 默认为 0 )</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov eax, fs:[30h]		; 取 PEB 首地址</span><br><span class="line">mov eax, [eax+68h]		; 取 PEB 首地址偏移 68h 的位置，即 PEB-&gt;NtGlobalFlag</span><br></pre></td></tr></table></figure>
<p>在 C++ 中可写为 (仅为示例)</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isDebugged</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> flag = <span class="literal">false</span>;</span><br><span class="line">    __asm &#123;</span><br><span class="line">        mov eax, fs:[<span class="number">30</span>h]</span><br><span class="line">        mov eax, [eax+<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">and</span> eax, <span class="number">0xff</span></span><br><span class="line">        mov flag, eax</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="利用堆标志位">利用堆标志位</h1>
<p>不同系统、不同版本可能不太一样，具体请查询微软官方文档。</p>
<p>在Windows
XP系统中，<code>ForceFlags</code>属性位于堆头部偏移量0x10处；在Windows
7系统中，对于32位的应用程序来说<code>ForceFlags</code>属性位于堆头部偏移量
0x44 处。</p>
<p>利用 <code>PEB-&gt;ProcessHeap-&gt;Flags</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov eax, fs:[30h]		; 取 PEB 首地址</span><br><span class="line">mov eax, [eax + 18h]	; 取 PEB 首地址偏移 18h 的位置，即 PEB-&gt;ProcessHeap</span><br><span class="line">mov eax, [eax + 0ch]	; 取 PEB-&gt;ProcessHeap 首地址偏移 0ch 的位置，即 PEB-&gt;ProcessHeap-&gt;Flags (默认为 2)</span><br></pre></td></tr></table></figure>
<p>利用 <code>PEB-&gt;ProcessHeap-&gt;ForceFlags</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov eax, fs:[30h]		; 取 PEB 首地址</span><br><span class="line">mov eax, [eax + 18h]	; 取 PEB 首地址偏移 18h 的位置，即 PEB-&gt;ProcessHeap</span><br><span class="line">mov eax, [eax + 10h]	; 取 PEB-&gt;ProcessHeap 首地址偏移 0ch 的位置，即 PEB-&gt;ProcessHeap-&gt;ForceFlags</span><br></pre></td></tr></table></figure>
<h1 id="使用-ntdll-函数">使用 ntdll 函数</h1>
<p>无论是 <code>kernel32.dll</code> 还是
<code>user32.dll</code>，始终会通过 <code>ntdll.dll</code>
中的函数与驱动层取得联系</p>
<p>其中 <code>ntdll.dll</code> 存在一个<strong>未导出函数</strong>
<code>NtQueryInformationProcess()</code> 可供查询调试端口</p>
<p>定义如下：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="function">DWORD NTAPI <span class="title">NtQueryInformationProcess</span><span class="params">(HANDLE hProcess, ULONG InfoClass, PVOID Buffer, ULONG length, PULONG returnLen)</span></span>;</span><br></pre></td></tr></table></figure>
<p>当我们需要使用时，以下 MSVC 代码可供参考：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="function">DWORD NTAPI <span class="title">NtQueryInformationProcess</span><span class="params">(HANDLE hProcess, ULONG InfoClass, PVOID Buffer, ULONG length, PULONG returnLen)</span></span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib, <span class="meta-string">&quot;ntdll.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isDebugged</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	HANDLE hDebugPort = <span class="literal">NULL</span>;	<span class="comment">// 调试端口</span></span><br><span class="line">    <span class="comment">// (HANDLE)-1 代表当前进程，其他均为查询是否被调试的固定参数</span></span><br><span class="line">	<span class="comment">// 如果正在被调试将返回 -1，否则返回 0</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">NtQueryInformationProcess</span>((HANDLE)<span class="number">-1</span>, <span class="number">7</span>, &amp;hDebugPort, <span class="built_in"><span class="keyword">sizeof</span></span>(HANDLE), <span class="literal">NULL</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> hDebugPort;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>CheckRemoteDebuggerPresent()</code>
实际上内部也调用了此函数</p>
<h1 id="时间检测">时间检测</h1>
<p>利用时间差判断是否代码停留时间过长，可判断是否在被动态调试，适合放在关键代码处运行，从某种意义上可以反制一定的调试手段</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isDebugged</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	DWORD start, end;</span><br><span class="line">	__asm</span><br><span class="line">	&#123;</span><br><span class="line">		rdtsc</span><br><span class="line">		mov start, eax</span><br><span class="line">		rdtsc</span><br><span class="line">		mov end, eax</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (end - start &gt; <span class="number">21</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 时间较长则视为在被调试</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">keyFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	DWORD start, end;</span><br><span class="line">	start = <span class="built_in">GetTickCount</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 部分代码</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line"></span><br><span class="line">	end = <span class="built_in">GetTickCount</span>();</span><br><span class="line">	<span class="keyword">if</span> (end - start &gt; <span class="number">100</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 如果运行时间大于理想时间，则说明在调试中</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * 其他代码</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="硬件断点检测">硬件断点检测</h1>
<p>获取线程上下文，检测硬件断点，查看是否占用</p>
<p>以下 MSVC 代码可供参考：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isDebugged</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	CONTEXT ctx;</span><br><span class="line">	ctx.ContextFlags = CONTEXT_ALL;</span><br><span class="line">	<span class="built_in">GetThreadContext</span>((HANDLE)<span class="number">-1</span>, &amp;ctx);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (ctx.Dr0 || ctx.Dr1 || ctx.Dr2 || ctx.Dr3)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="异常检测">异常检测</h1>
<p>但当调试器捕获异常时，大多数调试器并不会立即将异常传递给被调试程序处理或是直接不传递。我们便可以将这种机制用来反调试。</p>
<blockquote>
<p>但以下代码不一定运行成功——时代在发展，科技在进步。</p>
</blockquote>
<h2 id="一个字节的-interrupt-3-中断">一个字节的 Interrupt 3 中断</h2>
<p>在所有会被调试器处理的异常中，interrupt 3
中断算是一个，它会生成一个单字节的断点。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isDebugged_Int3</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	__try</span><br><span class="line">	&#123;</span><br><span class="line">		__asm <span class="keyword">int</span> <span class="number">3</span></span><br><span class="line">	&#125;</span><br><span class="line">	__except (<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="两个字节的-interrupt-3-中断">两个字节的 Interrupt 3 中断</h2>
<p>使用 MSVC 内联汇编器的 <code>_emit</code>
伪指令可以生成一个两字节的interrupt 3指令。在测试的所有调试器中，只有
OnllyDbg 调试器识别这个异常。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isDebugged_Int3_2Bytes</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	__try</span><br><span class="line">	&#123;</span><br><span class="line">		__asm</span><br><span class="line">		&#123;</span><br><span class="line">			__emit <span class="number">0xCD</span></span><br><span class="line">			__emit <span class="number">0x03</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	__except (<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="interrupt-0x2d-中断">Interrupt 0x2D 中断</h2>
<p>如果执行了interrupt 0x2D，Windows将抛出一个断点异常</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isDebugged_Int2d</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	__try</span><br><span class="line">	&#123;</span><br><span class="line">		__asm <span class="keyword">int</span> <span class="number">0x2d</span></span><br><span class="line">	&#125;</span><br><span class="line">	__except (<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="getlasterror-检测">GetLastError 检测</h2>
<p>当出现异常时，winapi 往往会通过 <code>GetLastError()</code>
函数获取错误原因，而我们也可以通过 <code>SetLastError()</code>
来报错</p>
<p>其中 <code>OutputDebugString()</code>
函数用于在调试器中显示字符串，同时可以用来探测调试器是否存在。</p>
<p>我们可以通过将错误码重置，当使用 <code>OutputDebugString()</code>
函数时，若不存在调试器，则会发生错误，错误码被重新设置；若存在调试器，则之后的错误码则会跟我们重置的错误码相同，以此便可以判断调试器存在。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isDebugged</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	DWORD dwCode = <span class="number">10086</span>;</span><br><span class="line">	<span class="built_in">SetLastError</span>(dwCode);</span><br><span class="line">	<span class="built_in">OutputDebugString</span>(<span class="string">L&quot;hacker!&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">GetLastError</span>() == dwCode)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="利用-tls-回调">利用 TLS 回调</h1>
<p>以下 MSVC 代码可供参考：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 自定义 TLS 回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> NTAPI <span class="title">tls_callback</span><span class="params">(PVOID h, DWORD reason, PVOID pv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">IsDebuggerPresent</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">MessageBoxA</span>(<span class="literal">NULL</span>, <span class="string">&quot;hacker!&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是 x86 还是 x64 系统</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _M_IX86</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span>  comment(linker, <span class="meta-string">&quot;/INCLUDE:__tls_used&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span>  comment(linker, <span class="meta-string">&quot;/INCLUDE:__tls_callback&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span>  comment(linker, <span class="meta-string">&quot;/INCLUDE:_tls_used&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span>  comment(linker, <span class="meta-string">&quot;/INCLUDE:_tls_callback&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个 TLS 区段</span></span><br><span class="line">EXTERN_C</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _M_X64</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> const_seg (<span class="meta-string">&quot;.CRT$XLB&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> data_seg (<span class="meta-string">&quot;.CRT$XLB&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">PIMAGE_TLS_CALLBACK _tls_callback[] = &#123; tls_callback, <span class="number">0</span> &#125;;</span><br><span class="line"><span class="comment">// 结束区段</span></span><br><span class="line">EXTERN_C</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _M_X64</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> const_seg (<span class="meta-string">&quot;.CRT$XLB&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> data_seg (<span class="meta-string">&quot;.CRT$XLB&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>我们可以在 TLS 回调函数中，进行我们的反调试手段，如加壳、加密等</p>
<h1 id="内存校验">内存校验</h1>
<p>将内存值进行 hash 得到哈希值 (如 CRC
算法等)，当内存区段数据被调试，或者是被补丁后，内存值经过同一哈希函数得到的哈希值会发生改变，可以此来判断是否被调试。</p>
<h1 id="注册表查询检测">注册表查询检测</h1>
<p>以下为调试器在注册表中的一个常用位置。 32位系统:
<code>SOFTWARE\Microsoft\Windows NT\CurrentVersion\AeDebug</code>
64位系统:
<code>SOFTWARE\Wow6432Node\Microsoft\WindowsNT\CurrentVersion\AeDebug</code>
该注册表项指定当应用程序发生错误时，触发哪一个调试器。默认情况下，它被设置为<code>Dr.Watson</code>。如果该这册表的键值被修改为<code>OllyDbg</code>
或是其他调试器名，则代码就可以确定它正在被调试。</p>
<h1 id="对数据加密">对数据加密</h1>
<p>在程序开始前，不将正确的数据显露出来</p>
<p>当用以上技术<strong>并未</strong>检测到程序正在调试时，再将相应的数据进行解密</p>
<p>可结合 TLS 回调函数等技术</p>
<p>以下代码仅供参考：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> secret[<span class="number">256</span>] = &#123; <span class="number">0x54</span>, <span class="number">0x65</span>, <span class="number">0x6a</span>, <span class="number">0x7f</span>, <span class="number">0x65</span>, <span class="number">0x4f</span>, <span class="number">0x21</span>, <span class="number">0x63</span>, <span class="number">0x4f</span>, <span class="number">0x78</span>, <span class="number">0x24</span>, <span class="number">0x7e</span>, <span class="number">0x74</span>, <span class="number">0x63</span>, <span class="number">0x20</span>, <span class="number">0x7d</span>, <span class="number">0x75</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">IsDebuggerPresent</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">memcpy</span>(secret, <span class="string">&quot;hacker!&quot;</span>, <span class="number">8</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">17</span>; ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			secret[i] ^= <span class="number">0x10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">init</span>();</span><br><span class="line">	<span class="built_in">puts</span>(secret);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="自修改代码">自修改代码</h1>
<p>将想要加密的 <code>.text</code> 代码区段进行加密</p>
<blockquote>
<p>注意，需要使用 <code>PE Editor</code> 等软件将软件的
<code>.text</code> 代码区段改为可写</p>
</blockquote>
<p>当程序运行时再进行解密，可以在一定程度上反动态调试</p>
<p>可结合 TLS 回调函数等技术</p>
<p>以下代码仅供参考：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">functionA</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">functionB</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">IsDebuggerPresent</span>())</span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		LPBYTE start = (LPBYTE)functionA;</span><br><span class="line">		LPBYTE end = (LPBYTE)functionB;</span><br><span class="line">		<span class="keyword">while</span> (start != end)</span><br><span class="line">		&#123;</span><br><span class="line">			*start ^= <span class="number">0x66</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">init</span>();</span><br><span class="line">	<span class="built_in">functionA</span>();</span><br><span class="line">	<span class="built_in">functionB</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="攻击调试器漏洞">攻击调试器漏洞</h1>
<p>与所有软件一样，调试器也存在漏洞，有时恶意代码编写者为了防止被调试，会攻击这些漏洞。</p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>anti-debug</tag>
        <tag>debug</tag>
        <tag>c++</tag>
      </tags>
  </entry>
  <entry>
    <title>arnold cat 变换 (猫脸变换)</title>
    <url>//arnold-cat-note.html</url>
    <content><![CDATA[<h1 id="猫脸变换简述">猫脸变换简述</h1>
<p>利用Arnold变换（又称猫脸变换）可以对图像进行置乱，使得原本有意义的图像变成一张无意义的图像。该变换可以在其它图像处理前对图像做预处理，例如在数字盲水印嵌入前对水印进行置乱。也可以用于普通的图像加密。</p>
<p>通常一次Arnold变换达不到理想效果，需要对图像进行连续多次的变换。Arnold变换具有周期性，即对图像连续进行Arnold变换，最终又能得到原图像。变换的周期和图像的尺寸有关。</p>
<p>当图像是一张<strong>方形的图像</strong>时，Arnold变换存在<strong>逆变换</strong>。经过N次Arnold变换后的数据可以通过N次逆变换恢复数据。</p>
<p>Arnold变换不仅可以用于图像置乱，也可以用于其它数据的置乱和加密。</p>
<h1 id="原理">原理</h1>
<p><strong>置乱的实质是新位置与旧位置的映射，且该映射是一一对应的。</strong></p>
<p>下图是一次猫脸变换的示意图：</p>
<figure>
<img src="/arnold-cat-note/cat.png" alt="猫脸变换图解">
<figcaption aria-hidden="true">猫脸变换图解</figcaption>
</figure>
<ol type="1">
<li>先在 (a) 原图上做水平方向的错切</li>
<li>然后在 (b) 的基础上再做一次竖直方向的错切</li>
<li>对图像求模，即<strong>切割回填</strong>操作，便得到变换后的图像</li>
</ol>
<h1 id="公式">公式</h1>
<p>其中，<span class="math inline">\(a\)</span>和<span class="math inline">\(b\)</span>为给定参数，<span class="math inline">\(N\)</span>为图片大小 (默认图片为正方形)</p>
<h2 id="arnold-变换">Arnold 变换</h2>
<ul>
<li><p>矩阵公式 <span class="math display">\[
\left(\begin{matrix}
x&#39;\\
y&#39;
\end{matrix}\right)=
\left[\begin{matrix}
1&amp;a\\
b&amp;ab+1
\end{matrix}\right]
\left(\begin{matrix}
x\\
y
\end{matrix}\right)
mod(N)
\]</span></p></li>
<li><p>行列式公式 <span class="math display">\[
\begin{cases}
x&#39;=(x+ay)mod(N)\\
y&#39;=(bx+(ab+1)y)mod(N)
\end{cases}
\]</span></p></li>
</ul>
<h2 id="arnold-逆变换">Arnold 逆变换</h2>
<ul>
<li><p>矩阵公式 <span class="math display">\[
\left(\begin{matrix}
x\\
y
\end{matrix}\right)=
\left[\begin{matrix}
ab+1&amp;-a\\
-b&amp;1
\end{matrix}\right]
\left(\begin{matrix}
x&#39;\\
y&#39;
\end{matrix}\right)
mod(N)
\]</span></p></li>
<li><p>行列式公式 <span class="math display">\[
\begin{cases}
x=((ab+1)x&#39;-ay&#39;)mod(N)\\
y=(-bx&#39;+y)mod(N)
\end{cases}
\]</span></p></li>
</ul>
<h1 id="python-实现">Python 实现</h1>
<p>以下借助了 Pillow 库实现功能</p>
<p>其中<span class="math inline">\(a、b\)</span>为给定参数，<span class="math inline">\(N\)</span>为置乱次数
(shuffle_times)，<code>reverse</code> 为是否倒置变换
(可能会出现变换倒置的问题)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># Anrold 变换</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">infile: 输入图像路径</span></span><br><span class="line"><span class="string">outfile: 输出图像路径</span></span><br><span class="line"><span class="string">a: Anrold 变换参数</span></span><br><span class="line"><span class="string">b: Anrold 变换参数</span></span><br><span class="line"><span class="string">N: 置乱次数 (shuffle_times)</span></span><br><span class="line"><span class="string">reverse: 是否逆变换</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">arnold</span>(<span class="params">infile:<span class="built_in">str</span>, outfile:<span class="built_in">str</span>=<span class="literal">None</span>, a:<span class="built_in">int</span>=<span class="number">1</span>, b:<span class="built_in">int</span>=<span class="number">1</span>, N:<span class="built_in">int</span>=<span class="number">1</span>, reverse:<span class="built_in">bool</span>=<span class="literal">False</span></span>):</span></span><br><span class="line">    inimg = Image.<span class="built_in">open</span>(infile)</span><br><span class="line">    width, height = inimg.size</span><br><span class="line">    indata = inimg.load()</span><br><span class="line">    outimg = Image.new(inimg.mode, inimg.size)</span><br><span class="line">    outdata = outimg.load()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">                <span class="keyword">if</span> reverse:</span><br><span class="line">                    nx = ((a * b + <span class="number">1</span>) * x - a * y) % width</span><br><span class="line">                    ny = (y - b * x) % height</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    nx = (x + a * y) % width</span><br><span class="line">                    ny = (b * x + (a * b + <span class="number">1</span>) * y) % height</span><br><span class="line">                outdata[nx, ny] = indata[x, y]</span><br><span class="line">    </span><br><span class="line">    outimg.save(outfile <span class="keyword">if</span> outfile <span class="keyword">else</span> <span class="string">&quot;arnold_&quot;</span>+infile, inimg.<span class="built_in">format</span>)</span><br><span class="line"></span><br><span class="line">arnold(<span class="string">&quot;before.png&quot;</span>, <span class="string">&quot;encode.png&quot;</span>, <span class="number">9</span>, <span class="number">39</span>, <span class="number">1</span>)</span><br><span class="line">arnold(<span class="string">&quot;encode.png&quot;</span>, <span class="string">&quot;decode.png&quot;</span>, <span class="number">9</span>, <span class="number">39</span>, <span class="number">1</span>, <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
      </tags>
  </entry>
  <entry>
    <title>逆向中反制反调试手段笔记</title>
    <url>//anti-anti-debug-note.html</url>
    <content><![CDATA[<h1 id="isdebuggerpresent-绕过">IsDebuggerPresent 绕过</h1>
<p><code>IsDebuggerPresent</code> 作为 winapi 函数，不可去符号表，在 ida
中可以通过导入表 (imports) 找到函数，然后通过以下几种手段绕过：</p>
<ol type="1">
<li>调试时，修改函数返回值 (即修改 rax 寄存器值)</li>
<li>调试时，修改相应的内存 (内存窗口中查找 <code>fs:[30]</code> 位置，即
<code>PEB</code> 地址，偏移为 0x68 的位置即为 <code>BeingDebugged</code>
)</li>
<li>将调用函数后的条件语句修改 (<code>jz</code> → <code>jnz</code> /
<code>jnz</code> → <code>jz</code>)</li>
<li>将相应代码区段 patch <code>nop</code></li>
<li>动态调试时，直接跳过函数运行</li>
</ol>
<h1 id="peb-标志位绕过">PEB 标志位绕过</h1>
<p>需要通过 ida 查找是否有涉及到 <code>fs</code> 寄存器的汇编代码</p>
<p>然后再进行相应的操作，如 patch <code>nop</code> 等。</p>
<h1 id="自修改代码绕过">自修改代码绕过</h1>
<p>如以下例题</p>
<figure>
<img src="/anti-anti-debug-note/473_af0_6f0.png" alt="ques">
<figcaption aria-hidden="true">ques</figcaption>
</figure>
<h2 id="静态分析">静态分析</h2>
<p>通过 ida 静态分析，找到相应的修改算法，通过 ida python
逆向修改代码区段</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">judge=<span class="number">0x600B00</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">182</span>):</span><br><span class="line">    addr=<span class="number">0x600B00</span>+i</span><br><span class="line">    byte=get_bytes(addr,<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 获取指定地址的指定字节数</span></span><br><span class="line">    byte=<span class="built_in">ord</span>(byte)^<span class="number">0xC</span></span><br><span class="line">    <span class="comment"># 打patch修改字节 </span></span><br><span class="line">    patch_byte(addr,byte)</span><br></pre></td></tr></table></figure>
<h2 id="动态分析">动态分析</h2>
<p>通过 ida 或是 ollydbg
等动态调试器，在解密代码后下断点，可以直接将其自修改后的程序导出，但会存在数据可能发生错误的问题。</p>
<p>最好将对应自修改后的代码与之前的代码进行结合分析。</p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>anti-debug</tag>
        <tag>c</tag>
        <tag>re</tag>
      </tags>
  </entry>
  <entry>
    <title>文件头笔记</title>
    <url>//file-header-note.html</url>
    <content><![CDATA[<table>
<colgroup>
<col style="width: 40%">
<col style="width: 38%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>文件类型</th>
<th>文件头</th>
<th>特征值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>JPEG (jpg)</td>
<td>FFD8FF</td>
<td>ÿØÿà</td>
</tr>
<tr class="even">
<td>PNG (png)</td>
<td>89504E47</td>
<td>PNG</td>
</tr>
<tr class="odd">
<td>GIF (gif)</td>
<td>47494638</td>
<td>GIF89a (GIF87a)</td>
</tr>
<tr class="even">
<td>ZIP Archive (zip)</td>
<td>504B0304</td>
<td>PK</td>
</tr>
<tr class="odd">
<td>TIFF (tif)</td>
<td>49492A00</td>
<td>II*</td>
</tr>
<tr class="even">
<td>Windows Bitmap (bmp)</td>
<td>424D</td>
<td>BM</td>
</tr>
<tr class="odd">
<td>RAR Archive (rar)</td>
<td>52617221</td>
<td>Rar!</td>
</tr>
<tr class="even">
<td>Wave (wav)</td>
<td>57415645</td>
<td>WAVE</td>
</tr>
<tr class="odd">
<td>AVI (avi)</td>
<td>41564920</td>
<td>AVI</td>
</tr>
<tr class="even">
<td>MPEG (mpg) 音频数据和视频数据</td>
<td>000001BA</td>
<td></td>
</tr>
<tr class="odd">
<td>MPEG (mpg) 视频数据</td>
<td>000001B3</td>
<td></td>
</tr>
<tr class="even">
<td>7Z</td>
<td>377ABCAF271C</td>
<td>7z¼¯'</td>
</tr>
<tr class="odd">
<td>CAD (dwg)</td>
<td>41433130</td>
<td>AC10</td>
</tr>
<tr class="even">
<td>Adobe Photoshop (psd)</td>
<td>38425053</td>
<td>8BPS</td>
</tr>
<tr class="odd">
<td>Rich Text Format (rtf)</td>
<td>7B5C727466</td>
<td>{</td>
</tr>
<tr class="even">
<td>XML (xml)</td>
<td>3C3F786D6C</td>
<td>&lt;?xml</td>
</tr>
<tr class="odd">
<td>Email [thorough only] (eml)</td>
<td>44656C69766572792D646174653A</td>
<td>Delivery-date:</td>
</tr>
<tr class="even">
<td>Outlook Express (dbx)</td>
<td>CFAD12FEC5FD746F</td>
<td></td>
</tr>
<tr class="odd">
<td>Outlook (pst)</td>
<td>2142444E</td>
<td>!BDN</td>
</tr>
<tr class="even">
<td>MS Word/Excel (xls / doc)</td>
<td>D0CF11E0</td>
<td></td>
</tr>
<tr class="odd">
<td>MS Access (mdb)</td>
<td>5374616E64617264204A</td>
<td>Standard J</td>
</tr>
<tr class="even">
<td>WordPerfect(wpd)</td>
<td>FF575043</td>
<td>ÿWPC</td>
</tr>
<tr class="odd">
<td>Adobe Acrobat (pdf)</td>
<td>255044462D312E</td>
<td>%PDF</td>
</tr>
<tr class="even">
<td>Quicken (qdf)</td>
<td>AC9EBD8F</td>
<td></td>
</tr>
<tr class="odd">
<td>Windows Password (pwl)</td>
<td>E3828596</td>
<td></td>
</tr>
<tr class="even">
<td>Real Audio (ram)</td>
<td>2E7261FD</td>
<td>.raý</td>
</tr>
<tr class="odd">
<td>Real Media (rm)</td>
<td>2E524D46</td>
<td>.RMF</td>
</tr>
<tr class="even">
<td>Quicktime (mov)</td>
<td>6D6F6F76</td>
<td>moov</td>
</tr>
<tr class="odd">
<td>Windows Media (asf)</td>
<td>3026B2758E66CF11</td>
<td></td>
</tr>
<tr class="even">
<td>MIDI (mid)</td>
<td>4D546864</td>
<td>MThd</td>
</tr>
<tr class="odd">
<td>Win PE</td>
<td>4D5A</td>
<td>MZ</td>
</tr>
<tr class="even">
<td>ELF</td>
<td>7F 45 4C 46</td>
<td>.ELF</td>
</tr>
<tr class="odd">
<td>VMDK</td>
<td>4B 44 4D</td>
<td>KDM</td>
</tr>
<tr class="even">
<td>Java-class</td>
<td>CA FE BA BE</td>
<td>Êþº¾</td>
</tr>
<tr class="odd">
<td>Postscript (eps / ps)</td>
<td>252150532D41646F6265</td>
<td>%!PS-Adobe</td>
</tr>
</tbody>
</table>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>file</tag>
      </tags>
  </entry>
  <entry>
    <title>base64 笔记</title>
    <url>//base64-note.html</url>
    <content><![CDATA[<h1 id="base64-原理">Base64 原理</h1>
<p>Base64编码是使用64个可打印ASCII字符（A-Z、a-z、0-9、+、/）将任意字节序列数据编码成ASCII字符串，另有“=”符号用作后缀用途。</p>
<p>Base64将输入字符串按字节切分，取得每个字节对应的二进制值（若不足8比特则高位补0），然后将这些二进制数值串联起来，再按照6比特一组进行切分（因为2^6=64），最后一组若不足6比特则末尾补0。将每组二进制值转换成十进制，然后在上述表格中找到对应的符号并串联起来就是Base64编码结果。</p>
<p>由于二进制数据是按照8比特一组进行传输，因此Base64按照6比特一组切分的二进制数据必须是24比特的倍数（6和8的最小公倍数）。24比特就是3个字节，若原字节序列数据长度不是3的倍数时且剩下1个输入数据，则在编码结果后加2个=；若剩下2个输入数据，则在编码结果后加1个=。</p>
<p>完整的Base64定义可见RFC1421和RFC2045。因为Base64算法是将3个字节原数据编码为4个字节新数据，所以Base64编码后的数据比原始数据略长，为原来的4/3。在电子邮件中，根据RFC822规定，每76个字符，还需要加上一个回车换行。可以估算编码后数据长度大约为原长的135.1%。</p>
<p>Base64可用于任意数据的底层二进制数据编码，以应用于只能传输ASCII字符的场合。不过最常用于文本数据的处理传输，例如在MIME格式的电子邮件中，Base64可以用来编码邮件内容，方便在不同语言计算机间传输而不乱码，注意是传输而不是显示，例如在西欧地区计算机上使用UTF-8编码即可正常显示中文（安装有对应字库），但是它未必能正常传输中文，这时转换为Base64便无此顾虑。</p>
<p>Base64编码若无特别说明，通常约定非ASCII字符按照UTF-8字符集进行编码处理。</p>
<p>base64编码编码Uuencode编码类似，但base64将0~63之间的数字通过查表换字符，所以可能存在不用默认表而用另一个表进行base64编码加密</p>
<h1 id="c-实现">C++ 实现</h1>
<h2 id="加密---encode">加密 - Encode</h2>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">string <span class="title">encode</span><span class="params">(<span class="keyword">const</span> string&amp; plain)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 转码表</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">char</span> table[] = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>;</span><br><span class="line">	<span class="comment">// 计算加密字符数</span></span><br><span class="line">	<span class="keyword">size_t</span> count = plain.<span class="built_in">size</span>() / <span class="number">3</span>;</span><br><span class="line">	<span class="keyword">size_t</span> remain = plain.<span class="built_in">size</span>() % <span class="number">3</span>;</span><br><span class="line">	<span class="function">string <span class="title">result</span><span class="params">(count * <span class="number">4</span> + (remain ? <span class="number">4</span> : <span class="number">0</span>), <span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="keyword">size_t</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (i != count)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 3 bytes 为一组进行加密</span></span><br><span class="line">		<span class="comment">// 取第一个 byte 的前 6 位</span></span><br><span class="line">		result[i * <span class="number">4</span>] = table[plain[i * <span class="number">3</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">		<span class="comment">// 取第一个 byte 的后 2 位与第二个 byte 的前 4 位组合</span></span><br><span class="line">		result[i * <span class="number">4</span> + <span class="number">1</span>] = table[((plain[i * <span class="number">3</span>] &amp; <span class="number">0x3</span>) &lt;&lt; <span class="number">4</span>) | (plain[i * <span class="number">3</span> + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>)];</span><br><span class="line">		<span class="comment">// 取第二个 byte 的后 4 位与第三个 byte 的前 2 位组合</span></span><br><span class="line">		result[i * <span class="number">4</span> + <span class="number">2</span>] = table[((plain[i * <span class="number">3</span> + <span class="number">1</span>] &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">2</span>) | (plain[i * <span class="number">3</span> + <span class="number">2</span>] &gt;&gt; <span class="number">6</span>)];</span><br><span class="line">		<span class="comment">// 取第三个 byte 的后 6 位</span></span><br><span class="line">		result[i * <span class="number">4</span> + <span class="number">3</span>] = table[plain[i * <span class="number">3</span> + <span class="number">2</span>] &amp; <span class="number">0x3f</span>];</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 迭代至下一个 3 bytes</span></span><br><span class="line">		++i;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 若多出 1 byte</span></span><br><span class="line">	<span class="keyword">if</span> (remain == <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 取 byte 前 6 位</span></span><br><span class="line">		result[i * <span class="number">4</span>] = table[plain[i * <span class="number">3</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">		<span class="comment">// 取 byte 后 2 位，剩余 4 位补 0</span></span><br><span class="line">		result[i * <span class="number">4</span> + <span class="number">1</span>] = table[(plain[i * <span class="number">3</span>] &amp; <span class="number">0x3</span>) &lt;&lt; <span class="number">4</span>];</span><br><span class="line">		<span class="comment">// 剩余补 &#x27;=&#x27; 凑满 4 的倍数长度</span></span><br><span class="line">		result[i * <span class="number">4</span> + <span class="number">2</span>] = result[i * <span class="number">4</span> + <span class="number">3</span>] = <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 若多出 2 bytes</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 取第一个 byte 前 6 位</span></span><br><span class="line">		result[i * <span class="number">4</span>] = table[plain[i * <span class="number">3</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">		<span class="comment">// 取第一个 byte 的后 2 位与第二个 byte 的前 4 位组合</span></span><br><span class="line">		result[i * <span class="number">4</span> + <span class="number">1</span>] = table[((plain[i * <span class="number">3</span>] &amp; <span class="number">0x3</span>) &lt;&lt; <span class="number">4</span>) | (plain[i * <span class="number">3</span> + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>)];</span><br><span class="line">		<span class="comment">// 取第二个 byte 的后 4 位，剩余 2 位补 0</span></span><br><span class="line">		result[i * <span class="number">4</span> + <span class="number">2</span>] = table[(plain[i * <span class="number">3</span> + <span class="number">1</span>] &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">2</span>];</span><br><span class="line">		<span class="comment">// 剩余补 &#x27;=&#x27; 凑满 4 的倍数长度</span></span><br><span class="line">		result[i * <span class="number">4</span> + <span class="number">3</span>] = <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="解密---decode">解密 - Decode</h2>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">string <span class="title">decode</span><span class="params">(<span class="keyword">const</span> string&amp; code)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 映射表</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">char</span> table[] = &#123;</span><br><span class="line">		<span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>,</span><br><span class="line">		<span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>,</span><br><span class="line">		<span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">62</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">63</span>,</span><br><span class="line">		<span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">57</span>, <span class="number">58</span>, <span class="number">59</span>, <span class="number">60</span>, <span class="number">61</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>,</span><br><span class="line">		<span class="number">64</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>,</span><br><span class="line">		<span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>,</span><br><span class="line">		<span class="number">64</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>, <span class="number">36</span>, <span class="number">37</span>, <span class="number">38</span>, <span class="number">39</span>, <span class="number">40</span>,</span><br><span class="line">		<span class="number">41</span>, <span class="number">42</span>, <span class="number">43</span>, <span class="number">44</span>, <span class="number">45</span>, <span class="number">46</span>, <span class="number">47</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="function"><span class="keyword">static</span> string <span class="title">bad</span><span class="params">(<span class="string">&quot;decode bad!&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 如果长度不是 4 的倍数，则返回 bad 字符串</span></span><br><span class="line">	<span class="keyword">if</span> ((code.<span class="built_in">size</span>() &amp; <span class="number">0x3</span>) != <span class="number">0</span>) <span class="keyword">return</span> bad;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 计算解密字符</span></span><br><span class="line">	<span class="keyword">size_t</span> count = code.<span class="built_in">size</span>() / <span class="number">4</span>;</span><br><span class="line">	<span class="function">string <span class="title">result</span><span class="params">(count * <span class="number">3</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="keyword">size_t</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> h, l;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (i != count)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 以 4 bytes 为一组进行解密</span></span><br><span class="line">		<span class="comment">// 取映射表对应数 (每个数作 6 bit 计算)</span></span><br><span class="line">		h = table[code[i * <span class="number">4</span>]];</span><br><span class="line">		l = table[code[i * <span class="number">4</span> + <span class="number">1</span>]];</span><br><span class="line">		<span class="comment">// 若一组中前两个字符不在 base64 加密字符范围，则返回 bad 字符串</span></span><br><span class="line">		<span class="keyword">if</span> (h == <span class="number">64</span> || l == <span class="number">64</span>) <span class="keyword">return</span> bad;</span><br><span class="line">		<span class="comment">// 将第一个数的前 4 bit 与第二个数的前 4 bit 组合</span></span><br><span class="line">		result[i * <span class="number">3</span>] = (h &lt;&lt; <span class="number">2</span>) | (l &gt;&gt; <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 取映射表对应数</span></span><br><span class="line">		h = table[code[i * <span class="number">4</span> + <span class="number">2</span>]];</span><br><span class="line">		<span class="comment">// 若一组中第三个数不在 base64 加密字符范围，则说明为 &#x27;=&#x27;，即解密结束 (严格来说需判断是否为&#x27;=&#x27;)</span></span><br><span class="line">		<span class="keyword">if</span> (h != <span class="number">64</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 将第二个数的前 2 bit 与第三个数的前 4 bit 组合</span></span><br><span class="line">			result[i * <span class="number">3</span> + <span class="number">1</span>] = (l &lt;&lt; <span class="number">4</span>) | (h &gt;&gt; <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 取映射表对应数</span></span><br><span class="line">			l = table[code[i * <span class="number">4</span> + <span class="number">3</span>]];</span><br><span class="line">			<span class="keyword">if</span> (l != <span class="number">64</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">// 将第三个数的前 2 bit 与第二个数的 6 bit 组合</span></span><br><span class="line">				result[i * <span class="number">3</span> + <span class="number">2</span>] = (h &lt;&lt; <span class="number">6</span>) | l;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 迭代至下三个数 (每个数作 6 bit 计算)</span></span><br><span class="line">		++i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="python-实现">Python 实现</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># encode</span></span><br><span class="line">base64.b64encode(<span class="string">&quot;Duzou&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># decode</span></span><br><span class="line">base64.b64decode(<span class="string">&quot;RHV6b3VfMXNfczBfaDRuZHNPbWU=&quot;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="bash">bash</h1>
<h2 id="加密---encode-1">加密 - Encode</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> Duzou | base64</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意，bash 的 echo 会默认加一个回车在末尾</p>
</blockquote>
<h2 id="解密---decode-1">解密 - Decode</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> RHV6b3VfMXNfczBfaDRuZHNPbWU= | base64 -d</span><br></pre></td></tr></table></figure>
<h1 id="在线网站">在线网站</h1>
<ul>
<li>https://www.qqxiuzi.cn/bianma/base64.htm</li>
</ul>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>crypto</tag>
        <tag>base64</tag>
      </tags>
  </entry>
  <entry>
    <title>ECC 笔记</title>
    <url>//ecc-note.html</url>
    <content><![CDATA[<h1 id="ecc-简介">ECC 简介</h1>
<p>椭圆曲线密码学(Elliptic Curve Cryptography，
ECC)，又称<strong>椭圆曲线密码体制</strong>、<strong>椭圆曲线加密算法</strong>等。椭圆曲线加密算法在比特币、目前的二代居民身份证和区块链领域有着广泛的应用。</p>
<p>在很多情况中，ECC在性能(更少的计算量)和带宽(更短的签名和密钥)上都比RSA和离散对数(DL)方案更具有优势。</p>
<p>ECC椭圆曲线加密，它的安全性基于椭圆曲线上的离散对数问题。</p>
<h1 id="ecc-原理">ECC 原理</h1>
<h2 id="ecc-常用椭圆曲线定义">ECC 常用椭圆曲线定义</h2>
<blockquote>
<p><span class="math inline">\(Z_p\ (p&gt;3)\)</span>
上的椭圆曲线指满足以下条件的所有对 <span class="math inline">\((x, y)\in
Z_p\)</span> 的集合 <span class="math display">\[
y^2\equiv x^3+ax+b\ mod\ p
\]</span> 以及一个无穷大的虚数点<span class="math inline">\(\partial\)</span>，其中 <span class="math display">\[
a,b\in Z_p
\]</span> 并且满足条件 <span class="math inline">\(4a^3+27b^2\neq 0\
mod\ p\)</span>。</p>
</blockquote>
<p>密码学应用感兴趣的时定义中给出的基于<strong>素数域</strong>的曲线。如果在<span class="math inline">\(Zp\)</span>上画出这个椭圆曲线，则得到的从远处看不像是一条曲线。</p>
<h2 id="求解-e_pab">求解 <span class="math inline">\(E_p(a,b)\)</span></h2>
<p>设 <span class="math inline">\(E_p(a,b)\)</span>
表示椭圆曲线上的点集： <span class="math display">\[
\{(x,y)|0\leq x\leq p,0\leq y\leq p, 且x,y均为整数 \}
\]</span> 求 <span class="math inline">\(E_p(a,b)\)</span>
点集步骤：</p>
<ol type="1">
<li>对每一个 <span class="math inline">\(x(0\leq x&lt;p\
且x为整数)\)</span>，计算 <span class="math inline">\(x^3+ax+b\ (mod\
p)\)</span></li>
<li>决定以上求得的值在<span class="math inline">\(mod\
p\)</span>下是否有平方根，计算 <span class="math inline">\(y^2\ (mod\
p)\)</span>
<ul>
<li>如果没有，则求曲线上没有与这一相对应的点</li>
<li>如果有，则求出两个平方根</li>
</ul></li>
</ol>
<p>以下是求解的 python 实现</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_points</span>(<span class="params">p, a, b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [(x, y) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(p) <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(p) <span class="keyword">if</span> (y*y - (x*x*x + a*x + b)) % p == <span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<h2 id="椭圆曲线上的群操作">椭圆曲线上的群操作</h2>
<p>设点 <span class="math inline">\(P=(x_1,y_1)\)</span> 和 <span class="math inline">\(Q=(x_2,y_2)\)</span>，我们需要计算第三个点<span class="math inline">\(R\)</span>的坐标，使得 <span class="math display">\[
P+Q=R\\
(x_1,y_1)+(x_2,y_2)=(x_3,y_3)
\]</span>
在这里我们只关注<strong>素数域</strong>上的加法法则，得到以下表达式
<span class="math display">\[
x_3=s^2-x_1-x_2\ mod\ p\\
y_3=s(x_1-x_3)-y_1\ mod\ p
\]</span> ​ 其中 <span class="math display">\[
s=\begin{cases}
\frac{y_2-y_1}{x_2-x_1}mod\ p;\ 当P\neq Q(相异点相加)\\
\frac{3x_1^2+a}{2y_1}mod\ p;\ 当P=Q(相同点相加)
\end{cases}
\]</span> 在相异点加法中，参数<span class="math inline">\(s\)</span>指的是经过<span class="math inline">\(P\)</span>和<span class="math inline">\(Q\)</span>的直线的斜率；而在相同点加法中，参数<span class="math inline">\(s\)</span>指的是经过点<span class="math inline">\(P\)</span>的切线的斜率。</p>
<h2 id="ecdlp-椭圆曲线离散对数">ECDLP 椭圆曲线离散对数</h2>
<p>首先已知存在定理：</p>
<blockquote>
<p>曲线上的点<span class="math inline">\(\partial\)</span>一起构成了循环子群。在某些条件下，椭圆曲线上的所有点可以形成一个循环群。</p>
</blockquote>
<p>在建立 <span class="math inline">\(DL\)</span>
密码体制时，知道群的阶至关重要，我们可以根据 <strong>Hasse's
定理</strong>了解它的大概数量：</p>
<blockquote>
<p>给定一个椭圆曲线<span class="math inline">\(Ep\)</span>，曲线上点的个数表示为<span class="math inline">\(\#E\)</span>，并且在以下范围内： <span class="math display">\[
p+1-2\sqrt{p}\leq \#E\leq p+1+2\sqrt{p}
\]</span></p>
</blockquote>
<p><strong>Hasse's 定理</strong>也称为<strong>Hasse's
边界</strong>，它说明了点的个数大概在素数<span class="math inline">\(p\)</span>的范围内。这个结论具有非常大的实用性。例如，如果需要一个拥有<span class="math inline">\(2^{160}\)</span>个元素的椭圆曲线，我们必须使用一个长度大约为
160 位的素数。</p>
<p>以下给出椭圆曲线离散对数问题(ECDLP)的定义：</p>
<blockquote>
<p>给定一个椭圆曲线<span class="math inline">\(E\)</span>，考虑本原<span class="math inline">\(P\)</span>和另一个元素<span class="math inline">\(Q\)</span>。则 <span class="math inline">\(DL\)</span> 问题是找到整数<span class="math inline">\(k\ (1\leq k\leq \#E)\)</span>，满足： <span class="math display">\[
kP=Q
\]</span></p>
</blockquote>
<p>其中，椭圆曲线加密的数学原理：</p>
<blockquote>
<p>点<span class="math inline">\(P\)</span>称为基点 (base point)；<span class="math inline">\(k\)</span>为私有密钥 (private key)；<span class="math inline">\(Q\)</span>为公开密钥 (public key)</p>
<ul>
<li>若给定<span class="math inline">\(k\)</span>和<span class="math inline">\(P\)</span>，根据加法法则，计算<span class="math inline">\(Q\)</span>很容易。</li>
<li>但给定<span class="math inline">\(P\)</span>和<span class="math inline">\(Q\)</span>，求<span class="math inline">\(k\)</span>非常困难 (实际应用 ECC 时，素数<span class="math inline">\(p\)</span>会取得非常大，穷举出<span class="math inline">\(k\)</span>将十分困难)</li>
</ul>
</blockquote>
<h2 id="基于椭圆曲线的-diffie-hellman-密钥交换">基于椭圆曲线的
Diffie-Hellman 密钥交换</h2>
<p>首先我们必须统一域参数，即实现所需要的合适的椭圆曲线以及曲线上的一个本原元：</p>
<p><strong>ECDH 域参数</strong></p>
<blockquote>
<ul>
<li>选择一个素数<span class="math inline">\(p\)</span>和椭圆曲线</li>
</ul>
<p><span class="math display">\[
E:y^2\equiv x^3+ax+b\ mod\ P
\]</span></p>
<ul>
<li>选择一个本原元<span class="math inline">\(P=(x_p,y_p)\)</span></li>
</ul>
<p>素数<span class="math inline">\(p\)</span>、由系数<span class="math inline">\(a\)</span>和<span class="math inline">\(b\)</span>给出的曲线以及本原元<span class="math inline">\(P\)</span>都是域参数。</p>
</blockquote>
<p>请注意：实际上找到一个合适的椭圆曲线是一项比较困难的任务。</p>
<p><strong>椭圆曲线 Diffie-Hellman 密钥交换 (ECDH)</strong></p>
<blockquote>
<p>对于 <strong>Alice</strong>：</p>
<p>​ 选择 <span class="math inline">\(k_{prA}=a\in
\{2,3,...,\#E-1\}\)</span></p>
<p>​ 计算 <span class="math inline">\(k_{pubA}=aP=A=(x_A,y_A)\)</span></p>
<p>对于 <strong>Bob</strong>：</p>
<p>​ 选择 <span class="math inline">\(k_{prB}=b\in
\{2,3,...,\#E-1\}\)</span></p>
<p>​ 计算 <span class="math inline">\(k_{pubB}=bP=B=(x_B,y_B)\)</span></p>
<p>交换 <strong>Alice</strong> 和 <strong>Bob</strong> 的密钥 <span class="math inline">\(A,B\)</span></p>
<p>对于 <strong>Alice</strong> 来说：</p>
<p>​ 计算 <span class="math inline">\(aB=T_{AB}\)</span></p>
<p>对于 <strong>Bob</strong> 来说：</p>
<p>​ 计算 <span class="math inline">\(bA=T_{AB}\)</span></p>
<p>故 <strong>Alice</strong> 和 <strong>Bob</strong>
之间的联合密钥：<span class="math inline">\(T_{AB}=(x_{AB},
y_{AB})\)</span></p>
</blockquote>
<h2 id="elgamal-加密算法">ElGamal 加密算法</h2>
<h3 id="密钥生成">密钥生成</h3>
<p>选择一个素数<span class="math inline">\(p\)</span>以及两个小于<span class="math inline">\(p\)</span>的随机数<span class="math inline">\(g\)</span>和<span class="math inline">\(x\)</span>，计算 <span class="math display">\[
y=g^x\ mod\ p
\]</span> 以<span class="math inline">\((y,g,p)\)</span>作为公开密钥
(public key)，<span class="math inline">\(x\)</span>作为私有密钥
(private key)</p>
<h3 id="加密">加密</h3>
<p>明文消息为<span class="math inline">\(m\)</span>，随机选取一个与<span class="math inline">\(p-1\)</span>互素的整数<span class="math inline">\(k\)</span>，计算 <span class="math display">\[
c_1=g^k\ mod\ p\\
c_2=my^k\ mod\ p
\]</span> 密文为<span class="math inline">\(C=(c_1,c_2)\)</span></p>
<h3 id="解密">解密</h3>
<p><span class="math display">\[
m=\frac{c_2}{c_1}mod\ p
\]</span></p>
<p>因为 <span class="math display">\[
\frac{c_2}{c_1}mod\ p=\frac{my^k}{g^{kx}}mod\ p=\frac{my^k}{y^k}mod\
p=m\ mod\ p
\]</span></p>
<h2 id="ec-elgamal">EC ElGamal</h2>
<h3 id="密钥生成-1">密钥生成</h3>
<p>选一条素数域椭圆曲线，得 <span class="math inline">\(E_p(a,b)\)</span>，将明文信息<span class="math inline">\(m\)</span>嵌入到曲线上的点<span class="math inline">\(P_m\)</span>，再对点<span class="math inline">\(P_m\)</span>做加密变换。</p>
<p>取 <span class="math inline">\(E_p(a,b)\)</span> 的一个生成元<span class="math inline">\(G\)</span>，<span class="math inline">\(E_p(a,b)\)</span>和<span class="math inline">\(G\)</span>作为公开参数。用户A选则随机整数 <span class="math display">\[
n_A作为密钥(private\ key)，以P_A=n_AG作为公钥(public\ key)
\]</span></p>
<h3 id="加密-1">加密</h3>
<p>用户B向用户A发送消息<span class="math inline">\(P_m\)</span>，选取一个随机正整数<span class="math inline">\(k\)</span>，产生以下点对作为密文： <span class="math display">\[
C_m=\{kG,P_m+kP_A\}
\]</span></p>
<h3 id="解密-1">解密</h3>
<p>以密文对中的第二个点减去自己的密钥与第一个点的点乘，即 <span class="math display">\[
P_m+kP_A-n_AkG=P_m+k(n_AG)-n_AkG=P_m
\]</span></p>
<h1 id="eccsagemath-实现">ECC&amp;sagemath 实现</h1>
<h2 id="加密-2">加密</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 获取素数 p, a, b</span></span><br><span class="line">p = random_prime(<span class="number">1</span> &lt;&lt; <span class="number">257</span>, <span class="literal">False</span>, <span class="number">1</span> &lt;&lt; <span class="number">256</span>)</span><br><span class="line">a = random_prime(<span class="number">1</span> &lt;&lt; <span class="number">257</span>, <span class="literal">False</span>, <span class="number">1</span> &lt;&lt; <span class="number">256</span>)</span><br><span class="line">b = random_prime(<span class="number">1</span> &lt;&lt; <span class="number">257</span>, <span class="literal">False</span>, <span class="number">1</span> &lt;&lt; <span class="number">256</span>)</span><br><span class="line"><span class="comment"># 构造在素数p域上的椭圆曲线</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line"><span class="comment"># 假设 m 点为我们的明文</span></span><br><span class="line">m = E.random_point()</span><br><span class="line"><span class="comment"># 获取基点</span></span><br><span class="line">G = E.random_point()</span><br><span class="line"><span class="comment"># 得到私钥 k</span></span><br><span class="line">k = random_prime(<span class="number">1</span> &lt;&lt; <span class="number">257</span>, <span class="literal">False</span>, <span class="number">1</span> &lt;&lt; <span class="number">256</span>)</span><br><span class="line"><span class="comment"># 得到公钥</span></span><br><span class="line">K = k * G</span><br><span class="line"><span class="comment"># 使用随机整数 r 进行加密，得到密文 c1, c2</span></span><br><span class="line">r = random_prime(<span class="number">1</span> &lt;&lt; <span class="number">257</span>, <span class="literal">False</span>, <span class="number">1</span> &lt;&lt; <span class="number">256</span>)</span><br><span class="line">c1 = m + r*K</span><br><span class="line">c2 = r*G</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a = <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;b = <span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;k = <span class="subst">&#123;k&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1 = <span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2 = <span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;m = <span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>Output</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = <span class="number">128793297744506472538564656403224353239237790297856868063135293480657949718107</span></span><br><span class="line">a = <span class="number">169525633276763035731120099301596679606634597125967649372511273475112363403657</span></span><br><span class="line">b = <span class="number">198042220010210729246139661419765709873418351966965680886669963511628185483527</span></span><br><span class="line">k = <span class="number">206223544016520338020994485092105731388506670455347138071664112683983647251049</span></span><br><span class="line">c1 = (<span class="number">120774540425763335415920992448661415223098467838556300826760573949754740635371</span> : <span class="number">31715597141680277543788087553074283575900846707702192323467421200922884354981</span> : <span class="number">1</span>)</span><br><span class="line">c2 = (<span class="number">25578971254124014433500544217127701457691693095066572228632002958021823241423</span> : <span class="number">105137323155370344541775539884363939121440305371187190617792029879165314583114</span> : <span class="number">1</span>)</span><br><span class="line">m = (<span class="number">52087445795594278491856078932932443344636991761169005384048985847142638285440</span> : <span class="number">15902591507684804608199095029425478914739638495574120728111164694188566421928</span> : <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h2 id="解密-2">解密</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 构造在素数p域上的椭圆曲线</span></span><br><span class="line">p = <span class="number">128793297744506472538564656403224353239237790297856868063135293480657949718107</span></span><br><span class="line">a = <span class="number">169525633276763035731120099301596679606634597125967649372511273475112363403657</span></span><br><span class="line">b = <span class="number">198042220010210729246139661419765709873418351966965680886669963511628185483527</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line"><span class="comment"># 私钥</span></span><br><span class="line">k = <span class="number">206223544016520338020994485092105731388506670455347138071664112683983647251049</span></span><br><span class="line"><span class="comment"># 密文点对</span></span><br><span class="line">c1 = E(<span class="number">120774540425763335415920992448661415223098467838556300826760573949754740635371</span>, <span class="number">31715597141680277543788087553074283575900846707702192323467421200922884354981</span>)</span><br><span class="line">c2 = E(<span class="number">25578971254124014433500544217127701457691693095066572228632002958021823241423</span>, <span class="number">105137323155370344541775539884363939121440305371187190617792029879165314583114</span>)</span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">m = c1-k*c2</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;m = <span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>Output</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m = (<span class="number">52087445795594278491856078932932443344636991761169005384048985847142638285440</span> : <span class="number">15902591507684804608199095029425478914739638495574120728111164694188566421928</span> : <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h1 id="eccpython-实现">ECC&amp;Python 实现</h1>
<h2 id="生成-ecc-密钥">生成 ECC 密钥</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> ECC</span><br><span class="line"></span><br><span class="line"><span class="comment">#生成ECC密钥</span></span><br><span class="line">key = ECC.generate(curve=<span class="string">&#x27;NIST P-256&#x27;</span>) <span class="comment">#使用椭圆曲线NIST P-256</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#输出密钥（包括私钥k，基点G）</span></span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line"><span class="comment">#公钥（point_x，point_y是基点G的坐标）</span></span><br><span class="line"><span class="built_in">print</span>(key.public_key())</span><br><span class="line"></span><br><span class="line"><span class="comment">#椭圆曲线</span></span><br><span class="line"><span class="built_in">print</span>(key.curve)</span><br><span class="line"></span><br><span class="line"><span class="comment">#私钥k</span></span><br><span class="line"><span class="built_in">print</span>(key.d)</span><br><span class="line"></span><br><span class="line"><span class="comment">#导出为pem密钥文件</span></span><br><span class="line"><span class="built_in">print</span>(key.export_key(<span class="built_in">format</span>=<span class="string">&#x27;PEM&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#导入密钥文件</span></span><br><span class="line">key = ECC.import_key(f.read())</span><br></pre></td></tr></table></figure>
<h2 id="查询公开椭圆曲线参数">查询公开椭圆曲线参数</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> fastecdsa.curve <span class="keyword">as</span> curve</span><br><span class="line"></span><br><span class="line"><span class="comment">#P-384的a</span></span><br><span class="line">curve.P384.a</span><br><span class="line"></span><br><span class="line"><span class="comment">#P-384的b</span></span><br><span class="line">curve.P384.b</span><br><span class="line"></span><br><span class="line"><span class="comment">#P-384的p</span></span><br><span class="line">curve.P384.p</span><br></pre></td></tr></table></figure>
<h1 id="ecc已公开椭圆曲线参数">ECC已公开椭圆曲线参数</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#NIST P-256（Secp256r1）</span></span><br><span class="line"><span class="comment">#p = 2^224(2^32 − 1) + 2^192 + 2^96 − 1</span></span><br><span class="line">p = <span class="number">115792089210356248762697446949407573530086143415290314195533631308867097853951</span></span><br><span class="line">a = <span class="number">115792089210356248762697446949407573530086143415290314195533631308867097853948</span></span><br><span class="line">b = <span class="number">41058363725152142129326129780047268409114441015993725554835256314039467401291</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Secp256k1（比特币使用）</span></span><br><span class="line"><span class="comment">#p = 2^256 − 2^32 − 2^9 − 2^8 − 2^7 − 2^6 − 2^4 − 1 = 2^256 – 2^32 – 977 </span></span><br><span class="line">p = <span class="number">115792089237316195423570985008687907853269984665640564039457584007908834671663</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#NIST P-384</span></span><br><span class="line"><span class="comment">#p = 2^384 – 2^128 – 2^96 + 2^32 – 1</span></span><br><span class="line">p = <span class="number">39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319</span></span><br><span class="line">a = -<span class="number">3</span></span><br><span class="line">b = <span class="number">27580193559959705877849011840389048093056905856361568521428707301988689241309860865136260764883745107765439761230575</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#NIST P-521</span></span><br><span class="line">p = <span class="number">6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151</span></span><br><span class="line">a = -<span class="number">3</span></span><br><span class="line">b = <span class="number">1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984</span></span><br></pre></td></tr></table></figure>
<h1 id="ecc-求解">ECC 求解</h1>
<h2 id="普通明文映射">普通明文映射</h2>
<p>task.sage</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">a = getPrime(<span class="number">256</span>)</span><br><span class="line">b = getPrime(<span class="number">256</span>)</span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">m = E.random_point()</span><br><span class="line">G = E.random_point()</span><br><span class="line">k = getPrime(<span class="number">256</span>)</span><br><span class="line">K = k * G</span><br><span class="line">r = getPrime(<span class="number">256</span>)</span><br><span class="line">c1 = m + r * K</span><br><span class="line">c2 = r * G</span><br><span class="line">cipher_left = s2n(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]) * m[<span class="number">0</span>]</span><br><span class="line">cipher_right = s2n(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:]) * m[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a = <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;b = <span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;k = <span class="subst">&#123;k&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;E = <span class="subst">&#123;E&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1 = <span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2 = <span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_left = <span class="subst">&#123;cipher_left&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_right = <span class="subst">&#123;cipher_right&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txt</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = <span class="number">74997021559434065975272431626618720725838473091721936616560359000648651891507</span></span><br><span class="line">a = <span class="number">61739043730332859978236469007948666997510544212362386629062032094925353519657</span></span><br><span class="line">b = <span class="number">87821782818477817609882526316479721490919815013668096771992360002467657827319</span></span><br><span class="line">k = <span class="number">93653874272176107584459982058527081604083871182797816204772644509623271061231</span></span><br><span class="line">E = Elliptic Curve defined by y^<span class="number">2</span> = x^<span class="number">3</span> + <span class="number">61739043730332859978236469007948666997510544212362386629062032094925353519657</span>*x + <span class="number">12824761259043751634610094689861000765081341921946160155432001001819005935812</span> over Finite Field of size <span class="number">74997021559434065975272431626618720725838473091721936616560359000648651891507</span></span><br><span class="line">c1 = (<span class="number">14455613666211899576018835165132438102011988264607146511938249744871964946084</span> : <span class="number">25506582570581289714612640493258299813803157561796247330693768146763035791942</span> : <span class="number">1</span>)</span><br><span class="line">c2 = (<span class="number">37554871162619456709183509122673929636457622251880199235054734523782483869931</span> : <span class="number">71392055540616736539267960989304287083629288530398474590782366384873814477806</span> : <span class="number">1</span>)</span><br><span class="line">cipher_left = <span class="number">68208062402162616009217039034331142786282678107650228761709584478779998734710</span></span><br><span class="line">cipher_right = <span class="number">27453988545002384546706933590432585006240439443312571008791835203660152890619</span></span><br></pre></td></tr></table></figure>
<p>exp.sage</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = <span class="number">74997021559434065975272431626618720725838473091721936616560359000648651891507</span></span><br><span class="line">a = <span class="number">61739043730332859978236469007948666997510544212362386629062032094925353519657</span></span><br><span class="line">b = <span class="number">87821782818477817609882526316479721490919815013668096771992360002467657827319</span></span><br><span class="line">k = <span class="number">93653874272176107584459982058527081604083871182797816204772644509623271061231</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">c1 = E(<span class="number">14455613666211899576018835165132438102011988264607146511938249744871964946084</span>, <span class="number">25506582570581289714612640493258299813803157561796247330693768146763035791942</span>)</span><br><span class="line">c2 = E(<span class="number">37554871162619456709183509122673929636457622251880199235054734523782483869931</span>, <span class="number">71392055540616736539267960989304287083629288530398474590782366384873814477806</span>)</span><br><span class="line">cipher_left = <span class="number">68208062402162616009217039034331142786282678107650228761709584478779998734710</span></span><br><span class="line">cipher_right = <span class="number">27453988545002384546706933590432585006240439443312571008791835203660152890619</span></span><br><span class="line">m = c1 - k*c2</span><br><span class="line">cipher_left = cipher_left * inverse_mod(<span class="built_in">int</span>(m[<span class="number">0</span>]), p) % p</span><br><span class="line">cipher_right = cipher_right * inverse_mod(<span class="built_in">int</span>(m[<span class="number">1</span>]), p) % p</span><br><span class="line"><span class="built_in">print</span>(cipher_left, cipher_right)</span><br></pre></td></tr></table></figure>
<h2 id="离散对数问题">离散对数问题</h2>
<blockquote>
<p>以下使用 sagemath，数据量不能太大</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">1234577</span></span><br><span class="line">b = <span class="number">3213242</span></span><br><span class="line">p = <span class="number">7654319</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line"><span class="comment"># 生成元</span></span><br><span class="line">G = E(<span class="number">5234568</span>, <span class="number">2287747</span>)</span><br><span class="line"><span class="comment"># k = 1584718</span></span><br><span class="line"><span class="comment"># K = k*G</span></span><br><span class="line"><span class="comment"># 公钥</span></span><br><span class="line">K = E(<span class="number">2366653</span>, <span class="number">1424308</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解私钥，自动选择bsgs或Pohlig Hellman算法</span></span><br><span class="line">discrete_log(K,G,operation=<span class="string">&#x27;+&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解私钥，Pollard rho算法</span></span><br><span class="line">discrete_log_rho(K,G,operation=<span class="string">&#x27;+&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解私钥，Pollard Lambda算法，能够确定所求值在某一小范围时效率较高</span></span><br><span class="line">discrete_log_lambda(K,G,(<span class="number">1500000</span>,<span class="number">2000000</span>),operation=<span class="string">&#x27;+&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="查看-ecc-的-pem-密钥文件信息">查看 ECC 的 pem 密钥文件信息</h2>
<p>使用 openssl</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#查看ECC私钥信息</span></span><br><span class="line">openssl ec -<span class="keyword">in</span> p384-key.pem -text -noout</span><br><span class="line"><span class="comment">#查看ECC公钥信息</span></span><br><span class="line">openssl ec -pubin -<span class="keyword">in</span> public.pem -text -noout</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>crypto</tag>
        <tag>ecc</tag>
        <tag>sagemath</tag>
      </tags>
  </entry>
  <entry>
    <title>Git的使用笔记</title>
    <url>//git-note.html</url>
    <content><![CDATA[<h1 id="git的使用">Git的使用</h1>
<h2 id="git的user配置">Git的User配置</h2>
<p>打开 <strong>Git Bash </strong>(使用命令行也可以)</p>
<p>配置全局 <code>name</code></p>
<blockquote>
<p><strong>Github </strong>用户名</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.name name</span><br></pre></td></tr></table></figure>
<p>配置全局 <code>email</code></p>
<blockquote>
<p><strong>Github</strong> 邮箱</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.email email</span><br></pre></td></tr></table></figure>
<p>以我的Github账户为例：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.name HasegawaAzusa</span><br><span class="line">git config --global user.email xxx@qq.com</span><br></pre></td></tr></table></figure>
<h2 id="使用ssh方式远程连接github">使用SSH方式远程连接Github</h2>
<p>打开<strong>Git Bash</strong>(使用命令行也可以)</p>
<p>先在本地生成对应邮箱的<strong>SSH RSA公钥密钥</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>
<p>使用<strong>默认生成路径</strong>，<strong>默认空key</strong></p>
<p>前往 <code>~/.ssh</code>
目录下寻找密钥（其中默认<strong><code>id_rsa</code></strong>是密钥信息，<strong><code>id_rsa.pub</code></strong>为公钥信息）</p>
<p>在 <strong>Github</strong> 中新建 <strong>SSH keys (Github - Settings
- SSH and GPG keys - New SSH key)</strong></p>
<p><code>Title</code> 任意，<code>Key</code>
填入<strong>公钥信息</strong> (<code>id_rsa.pub</code> 文件内容)</p>
<figure>
<img src="/git-note/sshkeys.png" alt="sshkeys">
<figcaption aria-hidden="true">sshkeys</figcaption>
</figure>
<p>输入以下，验证是否连接成功</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh git@github.com</span><br></pre></td></tr></table></figure>
<p>成功结果如下</p>
<figure>
<img src="/git-note/success.png" alt="success">
<figcaption aria-hidden="true">success</figcaption>
</figure>
<blockquote>
<p><a href="/ssh-note.html#ssh-keygen">ssh-keygen参数详解</a></p>
<p><a href="ssh-note.html#ssh">ssh参数详解</a></p>
</blockquote>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>鬼脚图笔记</title>
    <url>//guijiao-note.html</url>
    <content><![CDATA[<h1 id="简述">简述</h1>
<p>鬼脚图，又称画鬼脚，在日本称作阿弥陀签（あみだくじ），是一种游戏，也是一种简易决策方法，常被拿作抽签或者决定分配组合。</p>
<p>体现了决策中的唯一性、公平性、奇偶性。是一种简单的决策游戏，但因为在现实生活中有更为简单的决策游戏，即剪刀、石头、布相对于画鬼脚更为简单，所以一般不常见到。</p>
<h1 id="画法">画法</h1>
<p>在竖线的一端分别写上参与人，将需分配的事物或工作分成与人数的同等分后分别写在另一端。然后在每两个竖线相隔的区域，每个人任意的画上横线。每个人画横线的条数一般不限，但横线间不可交叉且横线不可横跨穿过两个间隔。</p>
<p>如下图中，A、B、C、D为参与人，1、2、3、4为要抽签的事物：</p>
<figure>
<img src="/guijiao-note/start.png" alt="start">
<figcaption aria-hidden="true">start</figcaption>
</figure>
<p>随后人们在竖线之间画上随机的横线，千万不可重合交叉：</p>
<figure>
<img src="/guijiao-note/process.png" alt="process">
<figcaption aria-hidden="true">process</figcaption>
</figure>
<h1 id="玩法">玩法</h1>
<p>每个人从自己的名字直走，遇到横线则拐弯。</p>
<p>以下以A为例子：</p>
<figure>
<img src="/guijiao-note/play.png" alt="play">
<figcaption aria-hidden="true">play</figcaption>
</figure>
<p>不难看出，实际上无论是从上面出发还是从下面出发，结果是不变的。</p>
]]></content>
      <tags>
        <tag>note</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo-asset-image：update link as:--&gt;/.io//xxx.png</title>
    <url>//errors/hexo-image-link-error.html</url>
    <content><![CDATA[<h1 id="错误分析">错误分析</h1>
<p>hexo-asset-image 无法识别 hexo 默认的永久链接
(<code>permalink</code>) 时，导致无法自动生成静态资源文件夹路径</p>
<figure>
<img src="/errors/hexo-image-link-error/update-link-error.png" alt="update-link-error">
<figcaption aria-hidden="true">update-link-error</figcaption>
</figure>
<h1 id="修复错误">修复错误</h1>
<p>有以下两种解决方案：</p>
<ol type="1">
<li>修改 hexo 的站点配置文件</li>
<li>为每篇文章手动配置 <code>permalink</code></li>
</ol>
<blockquote>
<p>建议两者一起使用</p>
</blockquote>
<h2 id="修改-hexo-的站点配置文件">修改 hexo 的站点配置文件</h2>
<p>将 <code>URL</code> 配置中的 <code>permalink</code>
参数置空或改为英文文件夹名 (详细配置请参考<a href="/hexo-note.html#网址-URL">网址-URL</a>)</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">permalink:</span> </span><br></pre></td></tr></table></figure>
<h2 id="为每篇文章手动配置-permalink">为每篇文章手动配置
<code>permalink</code></h2>
<p>在你的博文的 <code>Front-matter</code> 中添加 <code>permalink</code>
参数 (详细配置请参考<a href="/hexo-note.html#hexo%20博文头%20-%20Front-matter">Front-matter</a>)</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">permalink:</span> <span class="string">/project/index.html</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>error</tag>
        <tag>hexo</tag>
        <tag>hexo-asset-image</tag>
      </tags>
  </entry>
  <entry>
    <title>有关条形码的认识</title>
    <url>//barcode-note.html</url>
    <content><![CDATA[<h1 id="条形码分类">条形码分类</h1>
<h2 id="upc-条形码统一产品代码">UPC 条形码（统一产品代码）</h2>
<figure>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN8AAADJCAYAAACjdueqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAADjZJREFUeJzt23tM1XX8x/HXAcUj5yAKFlF4aZVjqIDYNAjEtVCnaU2YK0uNNpXlH2baZuVl6cw2m4bpTCGZbujMSynq0LxNty6Y5mbTNDUjHZhWEipHxPP6/eHP7y/8YuAl39jv9djOpp/v53wvx8+TA9+DHpKEiNxzIdYnIPL/leITMaL4RIwoPhEjik/EiOITMdLibuzE4/EAAK5/anHj32+cd93Ntt/q+I37u3H8Rjc7z5sd51aP19jzGzv+nZ53U6/jTl//G7c39Xyb+rybHb+p6+hm59HU8caOf6ef0umdT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMxovhEjCg+ESOKT8SI4hMx0sL6BJqC5F0Zb2xeY8/7t4/X1P3c6nGauv12r8/6dbvd/VrTO5+IEcUnYkTxiRhRfCJGmhzfgQMHEB8fD4/Hg5MnT/6Lp3T7vvrqKzzzzDPw+XyIiopCeno6SkpKXPM2b96MPn36oF27dvD5fHj66aexfv36f9z37t27ERISgr59+9Ybnzx5MjweT4OPyZMn15t76dIlvPXWW4iLi0Pr1q3RvXt3FBcX3/F1365z587d9NyvP06dOuXMX7FiBVJTU9GuXTu0bt0aKSkpWLJkiWu/27ZtQ2pqKsLDw9GmTRsMGTIER48edc0rKytD//79ERERAb/fj6ysLJSVlTV4rs19/TV17dXDRgSDQc6dO5dhYWGMi4sjAP7888+NPe2e27lzJ0NCQtitWzfm5+dz4cKFTElJIQCWlJQ481avXk2Px8OMjAwuWrSI+fn5TEhIIADu2LGjwX0HAgHGx8cTADMzM+tty8vLo9/vZ0FBgetRVlbmzAsGg8zKymKrVq04depUFhcXc8CAAQTAdevW/SuvSWMCgUCD511QUMD09HRGRUXxwoULJMmPP/6YAJiXl8cvv/ySW7Zs4WuvvUYAnDVrlrPPNWvWEACfeuopFhQUcOHChYyNjWVMTAwrKiqceQcPHmR4eDiTkpJYUFDABQsWMCUlheHh4fzhhx+ceffD+mvq2rtRo/Ht2LGDPp+Py5cv5+zZs5vlxZNk7969+dBDD/H8+fPOWFVVFaOjo5mWluaMxcfHMykpiVeuXHHGzp49S7/fz+eee67BfU+bNo0PPvggn3zySVd8L730Ejt16tTo+a1du5YAuGzZMmesrq6OKSkpHDduXBOv8t44fvw4vV4vFy1a5Ix169aNPXr0cM1NSEhg165dnb937NiRjz/+OC9fvuyMHTlyhC1atOCECROcsezsbEZFRfGPP/5wxv78809GR0czOzvbGbsf1l9T196NGo3v8OHDPHToEEk224snyU8++YRr1qxxjffp04edO3cmSdbW1nLevHncsmWLa16vXr2YkJDgGj906BDDwsK4dOlSZmZmuuIbOHAgu3fv3uj5ZWdnMzY2llevXm3iFdkZMGAAU1JS6p1rQkIC09PTXXN79+7NxMREkuSpU6cIgJMmTWpwn48++ijJa/8OXq+XY8eOdc0bPXo0vV4va2trSd4f668pa68hjX7IHh8ff7vfBt9TY8eOdY2RxIkTJ9CtWzcAQMuWLfHGG2+45gUCAfzyyy9IS0tzPX/MmDFITU1Fbm4uli1b5npuVVUV2rRpU29fXq/XNe+bb75BRkYGQkKu/ZgdDAadPzcnpaWlKC0txa5du+qd3/jx45GXl4cFCxZg2LBh8Hq9KC4uRllZGT799FMAcOaHh4e79hsXF4fS0lJcvHgRJ0+eRCAQQHJysmteYmIiAoEAfvzxR3Tv3v2+WH9NWXsNaX7/+nfR7NmzcerUKUyYMMG1raamBuXl5di1axcGDx6M2tpaTJ06td6cJUuWYO/evVi8ePFNj1FVVYXq6moMHToUkZGRaN26NTp06IDFixc7v2lRV1eH06dPo1OnTpg3bx46deqE0NBQPPzww/joo48QDAbv7oXfgRkzZiA9PR2ZmZn1xseMGYOCggJMmjQJMTExiIyMxMSJE1FYWIjc3FwAQGxsLCIjI7Fnz556zyWJffv2Abh2k+e3334DADzwwAOu48fExACAM+d+9U9rz3Erb6/N9W2/IYWFhQwNDeXbb7/d4PaVK1cSAAGwR48e3L9/f73tFRUVbNu2LadPn+6MNfRtZ1xcHFu0aMFx48Zxw4YNLC4uZlZWFgFw5syZJK/9LAOAnTt3ZmZmJtetW8dNmzZxxIgRBMAZM2bc1Wu/Xdu2bSMAlpaWurZt3bqV4eHhzMnJYUlJCbdv386XX36ZYWFhXLt2rTNvypQpBMApU6bw5MmTPHLkCEeNGsWYmBgC4LFjx7h582YC4IYNG1zHWb9+/U1vVNwv66+xtXfdfzK+adOmEQDfeeedm845ffo0169fz8WLFzMrK4ter5fLly93tufk5LBLly4MBALOWEPxlZeX88yZM/XGgsEg09LS2KpVK54/f57V1dUEwI4dO7Kmpqbe3H79+tHr9Tp3FS3l5OSwQ4cOrvG6ujp26NCBGRkZrm1ZWVmMiYlxfkarqalhXl4ePR4PATAkJIQjR47k9OnTCYCVlZXcuXMnAXD16tWu/X322WcEwO3bt7u23Q/rrylr77r/VHxXr17lyJEjGRoaWu9OXWOCwSCHDh1Kn8/H6upqlpSU0OPxcNOmTayurnYe6enpTE9PZ3V1tbPYbmbOnDkEwK+//pok6fP5+MILL7jmffjhhwTA77///tYu9i67dOkSfT4fX3/9dde2n376iQD4/vvvu7Z98MEHBMDDhw/XG6+srGRZWRnPnj1L8tqNFJ/Px2AwyMOHDxMAFy5c6Nrf/PnzCcC5yfJ3zXn93c7auy/+V0NTjR8/HitXrsSqVauQnZ3t2l5ZWYm1a9ciLS0NPXr0cMY9Hg969eqFdevW4fjx49i4cSNIYtCgQQ0eJyIiAjNnzsSUKVNQVVWF0NBQ+P3+enOqq6sB/N/Nh8TERFRUVLj2FQgEAACtWrW6vYu+S7Zs2YKLFy9iyJAhrm38359da2trXdsuX74M4Npr+HcxMTHOz28AsGvXLvTq1QsejwdPPPEEfD4f9u/f79rfd999h4iICHTp0uWOrudea2ztNehW6m7OX3k+//xz1+doN6qsrKTH4+GgQYNc2/r168eQkBCeO3eOx44d4549e1yP5ORkJicnc8+ePSwvL2d5eTk9Hg9HjhxZb181NTXs0qUL27dv73yeOHfuXHo8Hn777bfOvGAwyJ49ezI6Opp1dXV36ZW4PW+++SYB8Pfff3dtq6urY0REBFNTU13b+vTpQ5/P51zn8OHDmZSUVO96rn/GWVRU5Iy98sorbNu2rfPOSF779/H7/czNzW3wHJvr+mvK2mtIo+98u3fvdn41aO/evQCAVatWITo6GgDw4osvur7q32tXrlzBxIkT8cgjj6C2thaFhYWuOcOHD0dMTAwmTJiAuXPnIisrC4MHD0ZISAg2btyIrVu3YsyYMYiOjkZ0dDQee+wx1z4iIyMBAOnp6c7Y6NGjsWTJEgQCATz77LO4cOECioqKcPToURQVFaFFi2sv8dixY1FYWIj+/fs7dwxXrFiBffv2Yf78+QgNDf2XXp2mOXr0KCIjIxEVFeXaFhoainfffReTJ09GTk4Ohg8fjtDQUKxatQq7d+/GrFmznOscMmQIVqxYgeeffx7Dhg3DiRMnMGfOHGRkZGDEiBHOPt977z2UlJSgb9++yM3NBUksXboULVu2xPTp0515zX39NXXtNfTxS6PvfKNGjXLuCjb0aA5fhSoqKv7xHAHw119/JXnte/P8/HwmJibS6/UyMjKSKSkpnDNnTr3femlIQzdcrly5wvz8fCYnJzMiIoJ+v599+/bl5s2bXc8/c+YMX331VbZv355hYWFMSkriF198cddehzuRlpbW4M2Wv1u+fDl79uxJr9dLr9fLlJQULl261DWvqKiIXbt2pdfrZWxsLMePH8+//vrLNe/AgQPs378/fT4f/X4/Bw4cyIMHD9ab09zX362svRt5yPvkv/2K/Mf8pz9kF2nOFJ+IEcUnYkTxiRhRfCJGFJ+IEcUnYkTxiRj5HwdYeLHETCxmAAAAAElFTkSuQmCC" alt="UPC-A">
<figcaption aria-hidden="true">UPC-A</figcaption>
</figure>
<p>只能存储数字 (0-9)；有 A、B、C、D、E 五个版本，版本 A-12 位数字，版本
E-7 位数字；最后一位为校验位。</p>
<p>校验码计算顺序：</p>
<ol type="1">
<li>将所有<strong>奇数位置</strong> (第 1、3、5、7、9 和 11 位)
上的数字相加。</li>
<li>然后，将<strong>步骤 1 所得的值</strong>乘以 3。</li>
<li>将所有<strong>偶数位置</strong> (第 2、4、6、8 和 10 位)
上的数字相加。</li>
<li>然后，将该和与<strong>步骤 2 所得的值</strong>相加。</li>
<li>确定一个值与<strong>步骤 4
所得的值</strong>相加时，结果为10的倍数，该值即为校验位的值。</li>
</ol>
<blockquote>
<p>校验码计算示范：</p>
<ol type="1">
<li>1 + 3 + 5 + 7 + 9 + 1 = 26</li>
<li>26 * 3 = 78</li>
<li>2 + 4 + 6 + 8 + 0 = 20</li>
<li>78 + 20 = 108</li>
<li>108 + <strong>2</strong> = 110 (110 % 10 == 0)</li>
</ol>
<p>故校验码为 2</p>
</blockquote>
<h2 id="ean-条形码">EAN 条形码</h2>
<figure>
<img src="data:image/png;base64,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" alt="EAN-13">
<figcaption aria-hidden="true">EAN-13</figcaption>
</figure>
<p>只能存储数字 (0-9)；可以双向扫描
(可以由左至右或由右至左扫描)；存在一位检查码在最右边；存在左、中、右线以区分左、右码；分为
EAN-13 码与 EAN-8 码。</p>
<p>起始符和终止符3个模块的编码均为101，中间分隔符5个模块的编码是01010。左侧数据符和右侧数据符的编码方式不同。在左侧数据符中，有A和B两种编码方式，右侧数据符中有C编码方式。其中A和C之间是反码关系，B和C之间是倒序关系。在左侧数据符中的编码方式选A还是B，由前置码字符决定。</p>
<h2 id="codabar-库德巴条形码">Codabar 库德巴条形码</h2>
<figure>
<img src="data:image/png;base64,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" alt="Codabar">
<figcaption aria-hidden="true">Codabar</figcaption>
</figure>
<p>也被称作“血库用码”; 能存储数字 (0-9) 和字符 ($/-:+); 无校验码。</p>
<h2 id="pdf417-二维条形码">PDF417 二维条形码</h2>
<figure>
<img src="data:image/png;base64,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" alt="PDF417">
<figcaption aria-hidden="true">PDF417</figcaption>
</figure>
<p>能存储所有ASCII字符。</p>
<h2 id="aztec-二维码">Aztec 二维码</h2>
<figure>
<img src="data:image/png;base64,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" alt="Aztec">
<figcaption aria-hidden="true">Aztec</figcaption>
</figure>
<p>能存储所有 ASCII 字符。</p>
<h2 id="qrcode-二维码">QRCode 二维码</h2>
<figure>
<img src="data:image/png;base64,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" alt="QRCode">
<figcaption aria-hidden="true">QRCode</figcaption>
</figure>
<p>能存储所有 ASCII 字符和汉字。</p>
<h2 id="data-matrix-数据矩阵">Data Matrix 数据矩阵</h2>
<figure>
<img src="data:image/png;base64,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" alt="Data Matrix">
<figcaption aria-hidden="true">Data Matrix</figcaption>
</figure>
<p>支持所有 ASCII 字符、所有 ISO 字符和所有扩展二进制编码十进制交换码
(EBCDIC) 字符。</p>
<h2 id="maxicode-码">MaxiCode 码</h2>
<figure>
<img src="data:image/png;base64,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7rnnnsLMir/8y78c+LMPfvCDxdSpUyt5/bPPPruYPn16sW/fvmH//oUXXijMrFixYsWIY6xYsaLo6+vr6vX+7d/+rejr6ys++9nPFo8++mhhZsUNN9zQU/ZepH79G2+8sTCz4vTTTy/mzZs3bN13795dzJw5s3j/+99fmFnxta99rbJ8RVEUO3bsKA4//PCiv7+/uO+++4b8/Z49e4qzzz67MLPimmuuCfraX/rSlwozK/76r/+65zE+9rGPVXb+ACr4CA9ZWbJkiZ111llmZrZq1SprtVojfjTy4IMP2mmnnWYHHXSQTZkyxRYsWGBXX3217d69e8jPrlu3zn7+53/e+vv77eijj7YvfvGL9ld/9VfWarVs06ZNg352z549NmPGDGu1WqXmMn78eHvxxRftN37jN2zWrFk2adIkO/744+3v//7vB/3cwQcfbI888ohdffXV1tfXN+qYL730kl1yySU2b948mzx5ss2aNctOPfVUe/DBB3vOmfr125YtW2bbtm2zhx9+eMjf3Xffffbyyy/b8uXLh922m2Nhy5YtNm7cOLv00ksHbbtt2zabMmWKLV261IqiMLOhH+GtX7/etm/fbmvWrLEzzzxzyOv39/fbbbfdZp/5zGfs5JNPHvR3W7dutWXLltnMmTNt4sSJdsQRR9hFF11k//u//ztknJtuusnmzZtn/f399s53vtOuvfZa27dv37Bz/ud//mdbsWKFzZo1y/r7+23evHl25ZVX2quvvjrkZ9/2trfZnj17hh0HaKzUHRxQpf/8z/8sbrjhhsLMiuuuu6546qmnih07dgy5A7V58+ai1WoVixcvLu69997ioYceKi655JLCzIrVq1cPGnP9+vWFmRWLFy8uNm7cWGzYsKF497vfXSxevHjYf9mvWLGiOOKII0bM2O0dqIMOOqhYtGhR8ZnPfKZ44IEHihtvvLE4+OCDi9mzZxd79uwZdrvHHnts1DtAS5YsKaZPn16sW7eu+PrXv17cc889xfLly4tx48YVDz/88Ih5upXi9dt3oJ555plixowZxTnnnDPkZ04//fTiuOOOK+6+++4hd6A8x8LFF19c9PX1FU888cSgsWfNmlU899xzg/5s+vTpA/9//PHHF319fcXLL7/smts3vvGNYvz48cUJJ5xQbNiwofi7v/u74sYbbyymTZtWHHPMMcXu3bsHfvZP/uRPCjMrPvCBDxQPPvhg8cADDxRnnHFGccwxxww5Tp944omiv7+/WLhw4cC411xzTTFlypTilFNOKd54441BOS699NKu74gCTUEDhey03yTvuuuugT/rbKBuvPHG4pRTTil+8pOfDNr2xBNPLA466KBBf3bUUUcVs2fPHvRmtWPHjuKwww6L2kCZWfHHf/zHg/7893//9wszKx599NFhtxutgdm9e3cxbty44oILLhj053v37i0+97nPFY888siIebqV4vXbDdR3v/vdYvXq1UV/f3/x4osvDvz997///aLVahU333zzsA2U51j46U9/WrzrXe8qFi5cWOzdu7e49dZbCzMb8rFcZwM1efLkYsGCBe65HX/88cXBBx9cvPTSS4P+fN26dYWZFbfddtvAn82bN6847LDDBjXX+/btK4499tghx+nJJ59cHHroocULL7wwaNwvfOELhZkVGzduHPTnNFDIER/hAcO45JJL7Jvf/KbNnj170J8vWLDAdu3aZS+99JKZme3cudO+973v2WmnnWaTJk0a+Lnp06fb2WefPezY//M//xPsy9SrVq0a9P9HH320mZk9//zz7rEmTpxos2fPtgceeMDuv//+gS9TT5gwwdasWWOLFi0qHzjx619wwQX2f//3f/YXf/EXA39266232sSJE4fUsq3bY8HMbPLkyXbnnXfav//7v9vll19ul112mZ1//vnDfizX9sYbb9ju3btt+vTprrm8/PLL9k//9E92+umn28yZMwf93YoVK8zMBj6ufP75523btm122mmnWX9//8DPtVot+7Vf+7VB2+7cudO2bt1qS5YssWnTptmePXsG/vvQhz5kZmaPPPLIoG2mTJlib7zxhr344ouuOQB1RgMFDGP37t12/fXX2/ve9z6bPXu2TZ482SZNmmR33HGHmdnA90bavxY/3G/Hvetd7xr0/3v37rUNGzbY448/bh/+8IdLZ+zr6xvypt7+7aw33njDPd64ceNs8+bNNmvWLDvzzDNt5syZtnTpUlu7dq3t2LGjdF6F1z/uuOPs2GOPtVtuucXM3tyPt99+u61cuXJIE9LW7bHQ9t73vtc++9nP2k033WTTpk2zm266adRMfX19NnXqVHfz8aMf/cjMzObOnTvk737u535u0M/85Cc/MTOzt7/97UN+tvPYfe6552zfvn1211132eTJkwf9N2/ePDMz++///u9B2yxfvtz6+vrsqquusldeecU1D6CuaKCAYXzkIx+xK664wk466ST76le/ak8++aQ9/fTTQ+4ktL84O27c0FOp88/OPvtsO+ecc+yjH/2oXX311fHCl/De977XvvOd79jWrVvt8ssvt507d9qnP/1pO/rooytZ56eK17/gggvsmWeesSeeeMK+9rWv2fbt2+38888f8ee7PRYO9Mwzz9i4cePs+eeft+3bt4+ZaeHChbZt2zZ77rnn3PMp9n8xfbg/6+YXFUZqtlesWGGPPfbYsP91Hr8nnnii3X777fZnf/Znw65vBTQRDRTQ4Uc/+pFt3rzZfvVXf9XWrl1rixcvtne/+922YMGCIXdCDj30UDN782O5Ts8+++yg/7/uuuvsiiuusNtvv92+9KUvxZtASa1Wy97//vfbmjVr7Fvf+pY9/vjj9sorr9iaNWsa8frnnnuu9ff324YNG+yOO+6wuXPn2pIlS4b9Wc+x0HbnnXfaV7/6VfvzP/9ze+c732nnnnuu7d27d9RMH/nIR6woCvv85z8/4s+8/vrrtmjRooHf8ps7d661Wq1hG7Qf/vCHAz9j9tZx2r4TdaAf/OAHg/5/7ty51tfXZ7t377YTTzxx2P8WLFgwaJtnn33WLrzwQjv55JOH/S1HoIlooIAO7Te79scgbU8++eTAm0P7X+1z5syxt7/97fbNb37TXn/99YGf3bVrl23YsGHQ9r/wC79g1113nS1cuNDWr18fcwo9eeqpp2zVqlW2bdu2QX9+wgkn2KGHHjrsr8XX8fUPOeQQO/PMM23z5s22efNm+9jHPjbsHUQz37Fg9uZHWxdffLGdddZZdu6559qtt95q3/72t+33fu/3Rs30W7/1WzZ//nxbt26d3XzzzUP+/rXXXrNVq1bZ1q1b7YgjjjCzN79nd9JJJ9k3vvGNIR//3XvvvWZm9sEPftDMzN7xjnfY3Llz7aGHHhq09MLevXtt48aNg7adOnWqnXzyyfa3f/u39v3vf3/Q3z3zzDP28Y9/fMg/Dr7yla/Yzp077bbbbrNTTz111LkCTcFK5ECHI444wo466ii766677JRTTrGjjjrKtm7dauvXr7eLL77YbrrpJrvjjjvs13/91+3www+31atXD6zf84lPfMJ++tOf2jXXXGO/9Eu/NOyjQ4488kj7l3/5l8rm88QTTwx8/PW9731v4M/a3wOaP3++nXrqqTZ37lzbsmWL/eM//qN9+tOftnnz5tmePXvs7rvvtueee86uueaaWr7+cC644ALbsGGDtVotO++880b8Oc+xMHfuXDvvvPNs/Pjx9sUvftHM3vxo65JLLrE/+qM/suXLl4/YXEydOtU2b95sy5Yts09+8pN2yy232NKlS23mzJn2X//1X3bPPffYCy+8YL/7u79rn/rUpwa2u/766+1XfuVXbOnSpXb55ZfbrFmz7Mknn7TPfe5z9su//MuDvmv327/923bZZZfZsmXLbPXq1bZ3715bv369HXbYYUOa1htuuMFOOeUUW7x4sV111VU2f/58+4//+A+79tprrb+/366//vpBP79z507r6+sb9vtYQGMl/i1AoHLdLGPw9NNPF4sXLy6mTZtWHHLIIcWZZ55ZfPe73y1++MMfFu95z3uK/v7+4tprry2Koihef/314sorryzmzJlTTJo0qfjFX/zF4s477xz4FfYtW7YMev1QyxgM92vjd911V2Fmxd133z3wZ5deemlhZiP+d+655w787LPPPlusWrWqmDNnTjFx4sTibW97W7Fo0aLiK1/5ysgFHUPq1z9wGYO2ffv2FUceeWSxePHiQT873DIG3R4La9euHXJcFcWbSxscffTRxeGHHz6wzlPnMgZtr732WnH99dcXJ554YjFjxoxi0qRJxfz584tzzjmnePzxx4ed32OPPVZ84AMfKKZPn15MmDChmDdvXnHFFVcUr7766qCf27dvX3HttdcWRxxxRDFhwoTiyCOPLK699tpi06ZNhZkVmzZtGvTzTz31VLFy5crikEMOKfr6+oo5c+YUF1100aD1rNpYxgA5ahXFMN9ABFDaddddZ1deeaV961vfspNOOmngz1euXGlPP/30kO+eAHV12WWX2dq1awd9jA00Hd+BAkr60z/9UzvjjDOG/Pr23/zN39jEiRPtPe95z6A/7+/vt1deeWXY354C6ujFF18ctL4UkAMaKKCkd7zjHfbggw/a8uXL7e6777ZNmzbZRz/6UXv44YftwgsvtIMPPnjQzy9cuNB27Nhhf/AHf1Dpd6GA0LZv324bN260jRs32rHHHps6DlApPsIDArj//vvthhtusO985zu2e/dumz9/vp133nl26aWXDvkNr127dtl5551nDz30kL322mv2s5/9zMaPr8fvc2zZssWWLVvW1c++733vs3/4h39o1OtjsJUrV9rmzZtt4cKFduutt9JEISs0UAC69uqrr3b93a0pU6bYUUcd1ajXB4A2GigAAAAnvgMFAADgRAMFAADgRAMFAADgRAMFAADg9P/bQ9XUHViWZAAAAABJRU5ErkJggg==" alt="MaxiCode">
<figcaption aria-hidden="true">MaxiCode</figcaption>
</figure>
<p>能存储所有 ASCII 字符。</p>
<h2 id="code-16k-码">Code 16K 码</h2>
<figure>
<img src="data:image/png;base64,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XCxJSk1NrdBxoNy1117r03d4du3a5Qx7q8XfXC6X/v73v3vs5DFw4EBn+JdffvH7st17OzZv3tzjNNHR0crPz9fBgwf16KOP+r0GX9RFndu3b3eGr7zyyuoX6cXy5cud76I8+OCDuvDCCz1Od8stt6hr166SpI8++kiFhYXOuMzMTJ08eVKS9NBDD6lx48aV5g8PD69yvVevXu3cQ3vmmWece1qnS0xM1C233CJJev/9963djHc/FseNG6d169bpmWee0TfffKMDBw7oxx9/1AsvvKCmTZvqxIkTuv322326R/jpp5/q1ltvVWFhoS644AJlZ2erZcuW1aotODjYGXbvadtQEUSSLrnkEvXs2VPXXXed12mioqKc4cOHD1cY9+233zrDffr08drGnXfeecZali9fLkm66KKLKizzbIqPj1e7du08jgsNDXVe9Hl5eX5fdvkbnySNGDHCa9i5H3g21EWd+/btc4ajo6Nr3M7pVq9e7Qy7f6Dy5MYbb5QknThxosIHrm+++cYZruo4qaq35sqVK53ha665pso6evfuLalsm2zZsqXKac8W9+P8m2++0ccff6znn39el19+uSIjI9WpUyc9/fTTSk9PlyQVFhbq6aefrrLNFStWaNCgQTpx4oQk6bffftP7779f7dpiYmKcD0Tl7xkN2TnTfbu2SktLtWjRIi1btkw7d+5UXl6ejhw54nQLP3LkiDOtcesqLsn5tCmVhZo3iYmJXscdP35cU6ZM0YoVKyRJzz77bE1Wo0bO1EMnJCREJ06c8NpzrjZuvfVW9e7dW6tWrVJ2drbatm2rvn37qm/fvurTp48SExM99lSSpLVr13rtqdW6dWv17NmzQdXpPr8/t7X7G3lcXFyV05Z/Y1+Stm3b5rxmd+zY4fx/27Ztvc7fsWNHr+O2bt3qcTln8tNPPyk+Pl5S3e5z9zPC/v37e+3pOnDgQCUlJWnZsmVasmSJDh8+XOmrF+WmTJkiSRoyZIi+//575ebmasyYMYqNja32U2DGjx+vJ554Qunp6Zo6dapGjx7t8WpMQ0AQqazb8rBhwypdcvPV0aNHnWFvlxuksks6AQEBlR5U+PLLL2vcuHEqLS1VTEyMnn32WT344IM1qqUmAgPtvQwCAwOVmZmpSZMmaebMmTp8+LCysrKUlZUlqexMdNCgQXrkkUd01VVXVZj3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" alt="Code 16K">
<figcaption aria-hidden="true">Code 16K</figcaption>
</figure>
<p>ASCII 全部 128 个字符。</p>
<h2 id="codablock-f-码">Codablock-F 码</h2>
<figure>
<img src="data:image/png;base64,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XvPmzTO0rWHDhobPz58/H5JlUlBQoKZOnepynv/617+GpA26YxlZs3fvXtWvXz9ls9l8+i1ERUWpYcOGqUOHDvlV76effqrq1q1rqa46deqolStXlvGcm1WuXNlQbziFYpvvTx06rjdvgrksV69eHZR9zYABA5RSSu3Zs0e1atVK3XnnnSoqKspUbuzYsWU6P7c7wqqPOnbsaPjCNW3aVH3++efq7Nmz6tSpU+rUqVOG8hU1rB4/flxFREQYltX06dPVtWvXTGUrSlj99ttvVevWrd22kSDGMrLiypUrLv8I+vqy2+1q5syZqrCw0HLdc+fO9auuuXPnBnGJEFa90XW9eVOew2ppOTk5auzYsYZysbGx6sqVK2U6T7ez8nURiAaOHTtmGP7www+lXbt24WmMxrZv3y4lJSWO4T59+shLL73ksuzvf/97Q1l3du/eLe+++65juG7dujJjxgxL7enUqZOlcsFQUlIir732mkybNs1wei0mJqZCnG6zgmVkzdGjR6V///7yr3/9y/RZVFSUdO3aVVq0aCG1atWShIQEycnJkdOnT8vu3btl7969ht9ZUVGRzJw5U/bu3St//vOfJSYmxmPdn3zyiUyePNnwXqNGjeSxxx6TDh06SM2aNeXy5cuyf/9+ef/99+Xw4cOOcpMnT5aUlBT5xS9+EeASgK9Yb9YkJCTI7NmzA55Oamqq6b34+Hh54403ZN++fbJz504REcnPz5ddu3ZJ7969A66zQgh3Wi5PiouLDUcLIyMjVUlJicdxKuqR1ZdeesnwL/LDDz8MeJoffPCBYZotWrTwe1qhOrKalZWl7rvvPkNdVapUUcuXL1cDBgzgqKFiGVl17NgxVbNmTdORnHr16ql33nlH5eTkeBz/xx9/VNOmTVOVKlUyTWPIkCEex7148aKqXr26YZzhw4e7PFOi1M1LOcaNG2coX716dXXp0iW/598Tjqy6pvt68yaUR1br1atXptN35a233jLUuWTJkqDXebvgBisflJSUGI5M3LoDFWbOF4+np6eHqSXhNXHiRNm+fbtjuH379rJ//3757//+7zC2Si8sI+8KCgrkF7/4hanXihEjRsjRo0dlxIgREh8f73Ea9evXl1mzZsk///lPadmypeGzVatWyZIlS9yOu2DBArl8+bJjuGfPnrJ06VKJi4tzWT4qKkpef/116dev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V0K53pyPhjdo0EBlZWW5neamTZtMZzP+8pe/+DWft9z6Q3Drdc8993g8YqsUYbW84QYrTaxevdowPG3aNK930E+cOFEaNGjgGL5w4YJ89dVXLst+88038sUXXziGbTabfPDBBx67u5k0aZL85je/kRs3bsi1a9eszEa5dP36dcnNzZW3335bHnroIbflqlSpIs8//7zhvVsdPIeD87oeP36813HuuusumTdvnoiIVKpUSdLS0uTgwYNBaZ8OyvsyOnTokGG4devWPt/9H4jSN+iIiNSqVcuv6TiP53zDUlZWlvz97393DEdERMjy5cslNjbW7TQbNGgg77//vthsNss3WwV7O+usqKhISkpK5PXXX5du3bq5LRcfHy8ZGRkSEfGfXfLRo0dl165dlupxFqr1VlhYKHPnzjW8l5GRISkpKW6n2bNnT5k6darhvYULF/rVPhGRGTNmyB//+EfHcHp6unz++edStWpVv6cJ/RBWNbF69WrZsGGDrFixQubOnSs9e/b0Ok5kZKT06NHD8J6ru3lFRNauXWsY7tWrl6U7Q+fNm+dxh+HO9evXDcO63wXZpk0bGTp0qNdype+QFbl552m4unS5dOmSYbhSpUqWxhs8eLCcO3dO8vLy5NChQ6Z5up2U92V08eJFw/Add9wR0vqvXLliGPY3ADj/KS7d96eIyMqVKw3DPXr0kObNm3ud7r333iv33Xef5XYEezvrSkpKigwfPtxruaZNm8qDDz5oaq8/QrXeNmzYIKdPn3YMd+nSRbp06eJ1us59KGdmZprabMXbb78ts2bNcgw3bNhQNm3aJDVr1vR5WuHA0/ms43GrmmjTpo1f49WrV88w7PyP+hbnI4B9+vSxNP2kpCQZNGiQ/OlPf/KpXT/++KNh2GpICJdhw4ZZKle9enWJj4939EdZUlIiOTk5kpiYGMzmueR81OP//u//ZNy4cV7Hi4qKkqSkpGA1SyvlfRk5h9VQf8/y8/MNw9HR0X5Nx3k855208xFE59DmycMPPyzbtm2zVDbY21lXBg8e7LVv01t69eolGzZscAx//fXXluspLVTrbf369Ybhn//855amm5qaKnv27JGqVatKYmKiJCYmGo4qW7FmzRoZO3asYzg5OVk2b94s9evX92k6oeS8H3TeT8I9jqyWc86nBN39U/vuu+8Mw23btrVch6dT465c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" alt="生成的图像">
<figcaption aria-hidden="true">生成的图像</figcaption>
</figure>
<p>使用 FNC4 移位字符时 128 个低位 ASCII 字符和完整的 256 个字符扩展
ASCII 集。</p>
<h1 id="条形码的生成与识别">条形码的生成与识别</h1>
<h2 id="条形码生成">条形码生成</h2>
<ul>
<li>https://products.aspose.app/barcode/generate</li>
</ul>
<h2 id="条形码识别">条形码识别</h2>
<ul>
<li>https://products.aspose.app/barcode/recognize</li>
</ul>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>barcode</tag>
      </tags>
  </entry>
  <entry>
    <title>hgame misc week4 题目 - 摆烂</title>
    <url>//wp/hgame-bailan.html</url>
    <content><![CDATA[<h1 id="题目描述">题目描述</h1>
<p>题名：摆烂</p>
<p>描述：CTF 好难啊</p>
<p>附件：</p>
<p>链接：https://pan.baidu.com/s/1ox2iQPBUMmcJy3FtFYOAEw
提取码：flag</p>
<h1 id="解决方案">解决方案</h1>
<p>一开始打开压缩包发现是加密的，便先用 010editor 打开查看文件二进制</p>
<p>结果 010editor
直接一个先手报错，不由得往下查看文件格式如何出错，最后可在文件末尾发现关键文件签名<code>89504E47</code>即特征<code>‰PNG</code></p>
<p>将文件末尾的 png 图提取出来，得到一个不存在伪加密的压缩包和图片</p>
<figure>
<img src="/wp/hgame-bailan/bailan.png" alt="bailan">
<figcaption aria-hidden="true">bailan</figcaption>
</figure>
<p>压缩包丢进 ARCHPR 暴力破解，我们接着分析这张分离出来的图片</p>
<p>用 010editor
检查发现这张图片存在<code>acTL</code>、<code>fcTL</code>和<code>fdTL</code>数据块，便知道这张图片为
APNG 格式，即 PNG 动图</p>
<p>我们使用 https://products.aspose.app/imaging/zh-hans/image-view
在线分离帧，得到下面两张图片</p>
<figure>
<img src="/wp/hgame-bailan/bailan_page_0.png" alt="bailan_page_0">
<figcaption aria-hidden="true">bailan_page_0</figcaption>
</figure>
<figure>
<img src="/wp/hgame-bailan/bailan_page_1.png" alt="bailan_page_1">
<figcaption aria-hidden="true">bailan_page_1</figcaption>
</figure>
<p>我们使用 Stegsolve.jar 分别查看，并且使用 image combiner
功能混合图片，其中 xor 时发现两张图片不太一样，但并未探查出什么结果</p>
<p>不由得想到了盲水印 (bwm)，我们使用
https://github.com/chishaxie/BlindWaterMark 工具对两张图片进行盲水印提取
(<code>python .\bwm.py .\bailan_page_0.png .\bailan_page_1.png hui.png</code>)，得到下面这张图片</p>
<figure>
<img src="/wp/hgame-bailan/hui.png" alt="hui">
<figcaption aria-hidden="true">hui</figcaption>
</figure>
<p>手读可得一串密码：4C*9wfg976</p>
<p>这时候可想而知 ARCHPR
没有那么高效，密码还未破解到这位数，输入密码可解压压缩包得到四张二维码拼图</p>
<p>猜测它们来自一张二维码，其中发现 <code>CTF.png</code>
这张图片与其他图片 dpi 不太一样，且二维码拼图保留着白边。</p>
<p>最终根据白边和 dpi 关系，将二维码拼凑完整 (有些对齐失败无伤大雅)</p>
<figure>
<img src="/wp/hgame-bailan/barcode.png" alt="barcode">
<figcaption aria-hidden="true">barcode</figcaption>
</figure>
<p>扫描得到一串汉字：</p>
<blockquote>
<p>在这种困难的抉择下，本人思来想去‌‌‌‌‍‬‬‌，寝食难安。 既然如此‌‌‌‌‍‬‍﻿，
亚伯拉罕·林肯在不经意间这样说过，你活了多少岁不算什么‌‌‌‌‍‬‌‍，‌‌‌‌‍‬﻿‍重要的是你是如何度过这些岁月的。‌‌‌‌‍‬‍‍这启发了我，‌‌‌‌‍﻿‬﻿
CTF‌‌‌‌‌﻿‌‍好难，到底应该如何实现。‌‌‌‌‍‍﻿﻿‌‌‌‌‍‍‍﻿ ‌‌‌‌‌﻿‍‌‌‌‌‌‍‬﻿‬总结的来说‌‌‌‌‍‍‍‌‌‌‌‌‍‍﻿﻿，
‌‌‌‌‍‍‍‌‌‌‌‌‌﻿‌‌‌‌‌‌‍‍﻿﻿‌‌‌‌‍﻿‌‌我们都知道‌‌‌‌‌﻿‌‍‌‌‌‌‍‌‌‍，只要有意义‌‌‌‌‍﻿‬‍，‌‌‌‌‍‍﻿﻿那么就必须慎重考虑‌‌‌‌‍﻿‌‬。‌‌‌‌‌﻿‌‌‌‌‌‌‍‍‍‌‌‌‌‌‍﻿‍‌ 我认为，
每个人都不得不面对这些问题‌‌‌‌‍‬‍‍。‌‌‌‌‍‬﻿‬ 在面对这种问题时，‌‌‌‌‍﻿﻿‍
CTF好难，到底应该如何实现。</p>
</blockquote>
<p>复制进 vscode 后发现存在一些非法 unicode
字符，猜测为0宽字符加密，使用网站
http://330k.github.io/misc_tools/unicode_steganography.html
解密最终得到我们心心念念的 flag</p>
]]></content>
      <tags>
        <tag>hgame</tag>
        <tag>wp</tag>
        <tag>misc</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo 插件笔记</title>
    <url>//hexo-plugins-note.html</url>
    <content><![CDATA[<h2 id="hexo-插件---hexo-word-counter">hexo 插件 -
<code>hexo-word-counter</code></h2>
<p>实现字数统计与阅读时间预估功能</p>
<ul>
<li><p><strong>安装指令</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-word-counter --save</span><br></pre></td></tr></table></figure></li>
<li><p><strong>hexo 配置</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">symbols:</span> <span class="literal">true</span>					<span class="comment"># 显示博文字数</span></span><br><span class="line">  <span class="attr">time:</span> <span class="literal">true</span>					<span class="comment"># 显示预计阅读时间</span></span><br><span class="line">  <span class="attr">total_symbols:</span> <span class="literal">true</span>			<span class="comment"># 在页脚显示总字数</span></span><br><span class="line">  <span class="attr">total_time:</span> <span class="literal">true</span>				<span class="comment"># 在页脚显示总阅读时间</span></span><br><span class="line">  <span class="attr">awl:</span> <span class="number">4</span>						<span class="comment"># 平均字长 (用于计算)</span></span><br><span class="line">  <span class="attr">wpm:</span> <span class="number">275</span>						<span class="comment"># 每分钟阅读的平均字数 (用于计算)</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>NexT 主题配置</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span>			<span class="comment"># 字数和阅读时间是否分行显示</span></span><br><span class="line">  <span class="attr">item_text_total:</span> <span class="literal">true</span>			<span class="comment"># 页脚是否显示字数和阅读时间 (默认不显示)</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="hexo-插件---hexo-generator-searchdb">hexo 插件 -
<code>hexo-generator-searchdb</code></h2>
<p>实现本地搜索功能</p>
<ul>
<li><p><strong>安装指令</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure></li>
<li><p><strong>hexo 配置</strong></p>
<ul>
<li><code>path</code> → 搜索记录文件</li>
<li><code>field</code> → 搜索内容</li>
<li><code>format</code> → 搜索后缀</li>
<li><code>limit</code> → 最大搜索限制</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Local search</span></span><br><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">10000</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>NexT 主题配置</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">trigger:</span> <span class="string">auto</span>					<span class="comment"># 是否无视回车自动搜索 (auto | maual)</span></span><br><span class="line">  <span class="attr">top_n_per_article:</span> <span class="number">1</span>			<span class="comment"># 每个搜索展示几个结果</span></span><br><span class="line">  <span class="attr">unescape:</span> <span class="literal">false</span>				<span class="comment"># 读取内容</span></span><br><span class="line">  <span class="attr">preload:</span> <span class="literal">false</span>				<span class="comment"># 预读取页面内容</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="hexo-插件---hexo-all-minifier">hexo 插件 -
<code>hexo-all-minifier</code></h2>
<p>可以对html、css、js、images进行压缩，即把重复的代码合并，把多余的空格去掉，用算法对images进行压缩，加快网页加载速度。</p>
<ul>
<li><p><strong>安装指令</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-all-minifier --save</span><br></pre></td></tr></table></figure></li>
<li><p><strong>hexo 配置</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">html_minifier:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">ignore_error:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">css_minifier:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;*.min.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">js_minifier:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mangle:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">output:</span></span><br><span class="line">  <span class="attr">compress:</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;*.min.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">image_minifier:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">interlaced:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">multipass:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">optimizationLevel:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">pngquant:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">progressive:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="next-插件---hexo-related-popular-posts">NexT 插件 -
<code>hexo-related-popular-posts</code></h2>
<p>实现热门相关帖子功能</p>
<ul>
<li><p><strong>安装指令</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-related-popular-posts --save</span><br></pre></td></tr></table></figure></li>
<li><p><strong>NexT 主题配置</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">related_posts:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span>					<span class="comment"># 是否开启插件</span></span><br><span class="line">  <span class="attr">title:</span>						<span class="comment"># related-popular-posts 的名字 (默认使用相关文章)</span></span><br><span class="line">  <span class="attr">display_in_home:</span> <span class="literal">false</span>		<span class="comment"># 是否在首页使用相关/热门帖子</span></span><br><span class="line">  <span class="attr">params:</span></span><br><span class="line">    <span class="attr">maxCount:</span> <span class="number">5</span>					<span class="comment"># 最大显示</span></span><br><span class="line">    <span class="comment">#PPMixingRate: 0.0			# 热门与相关的混合比例</span></span><br><span class="line">    <span class="comment">#isDate: false				# 是否显示日期</span></span><br><span class="line">    <span class="comment">#isImage: false				# 是否显示图像</span></span><br><span class="line">    <span class="comment">#isExcerpt: false			# 是否显示摘录</span></span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>hexo</tag>
        <tag>NexT</tag>
        <tag>plugins</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo 搭建 blog 笔记</title>
    <url>//hexo-note.html</url>
    <content><![CDATA[<h1 id="hexo-搭建-blog">hexo 搭建 blog</h1>
<h2 id="hexo-前置环境">hexo 前置环境</h2>
<ul>
<li><p><strong>Git</strong></p>
<p>Git 需要绑定好 Github 的账号与邮箱，并能够建立连接</p>
<blockquote>
<p><a href="/git-note.html#Git的User配置">绑定账号与邮箱</a></p>
<p><a href="/git-note.html#使用SSH方式远程连接Github">Git使用SSH与Github建立远程连接</a></p>
</blockquote></li>
<li><p><strong>Node.js</strong></p>
<p>尽量请使用 Node.js LTS 版本</p></li>
</ul>
<h2 id="hexo-安装">hexo 安装</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli		<span class="comment"># npm 安装 hexo</span></span><br></pre></td></tr></table></figure>
<h2 id="hexo-初始化">hexo 初始化</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo init blog				<span class="comment"># 初始化 hexo</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>blog</strong> 是 hexo
初始化的文件夹，是<strong>博客根目录</strong>，可以更换成自己喜欢的文件夹名</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> blog						<span class="comment"># 切换到博客根目录</span></span><br><span class="line">npm install					<span class="comment"># 自动化安装依赖文件，完成 hexo 初始化</span></span><br></pre></td></tr></table></figure>
<p>以下用 <code>~/</code> 指代<strong>博客根目录</strong>。</p>
<h2 id="hexo-生成静态网页文件">hexo 生成静态网页文件</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo generate				<span class="comment"># 自动化生成静态网页文件</span></span><br></pre></td></tr></table></figure>
<p>可选的额外选项：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo g						<span class="comment"># 简化指令</span></span><br></pre></td></tr></table></figure>
<h2 id="hexo-服务">hexo 服务</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo server					<span class="comment"># 开启服务</span></span><br></pre></td></tr></table></figure>
<p>开启hexo服务后，即可通过本地访问 blog 页面（默认为
<code>localhost:4000</code> ）预览博客页面。</p>
<p>可选的额外选项：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo s						<span class="comment"># 简化指令</span></span><br><span class="line">hexo s -s					<span class="comment"># 静态模式</span></span><br><span class="line">hexo s -p 5000				<span class="comment"># 更改端口</span></span><br><span class="line">hexo s -i 192.168.1.5		<span class="comment"># 自定义ip</span></span><br></pre></td></tr></table></figure>
<h2 id="hexo-部署">hexo 部署</h2>
<p>这里通过 Github 的免费托管仓库进行部署博客。</p>
<p>先用 Github 创建一个名为 <code>&lt;username&gt;.github.io</code>
的仓库</p>
<blockquote>
<p>以我为例创建的仓库名为 <code>HasegawaAzusa.github.io</code></p>
</blockquote>
<p>在博客根目录下安装 <code>hexo-deployer-git</code> 部署插件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
<p>更改 hexo 站点配置文件 (<code>~/_config.yml</code>) 中的 <a href="#部署%20-%20Deployment">Deployment配置项</a></p>
<p>以我为例更改的配置项结果为</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:HasegawaAzusa/HasegawaAzusa.github.io.git</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>repo</code> 使用 ssh 链接的原因：我的 git 使用 ssh 与 github
进行远程连接</p>
<p>git 使用 https 与 github 进行远程连接请使用 https 链接</p>
</blockquote>
<p>在<strong>博客根目录</strong>下，输入部署指令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo deploy					<span class="comment"># 部署指令</span></span><br></pre></td></tr></table></figure>
<p>可选的额外指令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo d						<span class="comment"># 简化指令</span></span><br><span class="line">hexo clean					<span class="comment"># 清理缓存 (在自动化生成前最好清理缓存)</span></span><br><span class="line">hexo g -d					<span class="comment"># 一个命令完成自动化生成 (generate) 并部署 (deploy)</span></span><br></pre></td></tr></table></figure>
<p>等待一段时间后，可以通过
<code>https://&lt;username&gt;.github.io</code> 访问自己的博客。</p>
<blockquote>
<p>以我为例链接为 https://hasegawaazusa.github.io</p>
</blockquote>
<h1 id="hexo-入门">hexo 入门</h1>
<h2 id="hexo-更新">hexo 更新</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm update -g hexo-cli		<span class="comment"># 使用 npm 更新 hexo</span></span><br></pre></td></tr></table></figure>
<h2 id="hexo-新建博文">hexo 新建博文</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new hello				<span class="comment"># 新建博文</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>hello</strong>可自由更改，对应生成的md文件名</p>
</blockquote>
<p>可选的额外选项：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo n hello				<span class="comment"># 简化指令</span></span><br><span class="line">hexo n post hello			<span class="comment"># 新编博文并立即发布。默认 ~/source/_posts/hello.md</span></span><br><span class="line">hexo n draft hello			<span class="comment"># 新编博文但暂不发布。默认 ~/source/_drafts/hello.md</span></span><br><span class="line">hexo n page hello			<span class="comment"># 新建页面（标签页，分类页等）。默认 ~/source/hello</span></span><br></pre></td></tr></table></figure>
<p>然后进入 <code>~/source/_posts/</code> 找到 <code>hello.md</code>
，打开文件，内容如下</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">title: hello</span><br><span class="line">date: <span class="number">1970</span><span class="number">-1</span><span class="number">-1</span> <span class="number">8</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">tags: [hello, demo]</span><br></pre></td></tr></table></figure>
<p>该头为 <code>Front-matter</code> ，参数如下：</p>
<ul>
<li><p><strong><code>title</code></strong> → 博文标题</p></li>
<li><p><strong><code>date</code></strong> →
发布日期，默认为文件创建日期</p></li>
<li><p><strong><code>tags</code></strong> → 博文标签</p></li>
</ul>
<p>修改后，在正文处输入内容即可编辑博文内容。<code>.md</code>格式文本示例如下：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: hello</span><br><span class="line">date: 1970-1-1 8:00:00</span><br><span class="line"><span class="section">tags: [hello, demo]</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"><span class="section"># First Blog</span></span><br><span class="line">This is my <span class="strong">**first**</span> blog!</span><br><span class="line">Do you like?</span><br></pre></td></tr></table></figure>
<h2 id="hexo-主题">hexo 主题</h2>
<p>进入 https://hexo.io/themes/ 进行挑选合适的主题</p>
<p>这里以配置 <code>NexT</code> 主题为例：</p>
<p>打开 <code>Powershell</code> 输入以下命令，安装 <code>NexT</code>
主题</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-theme-next --save</span><br></pre></td></tr></table></figure>
<p>更改 hexo 站点配置文件 (<code>~/_config.yml</code>) 中的 <a href="#扩展%20-%20Extensions"><code>Extensions</code>配置项</a></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br></pre></td></tr></table></figure>
<p>重新进行网页生成即可</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean					<span class="comment"># 清除缓存</span></span><br><span class="line">hexo g -d					<span class="comment"># 重新生成并部署</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>了解 NexT 主题的更多信息可以使用<a href="/next-note.html">NexT
笔记</a></p>
</blockquote>
<h2 id="hexo-博文插入超链接">hexo 博文插入超链接</h2>
<p>对于站外的超链接，直接将外站的完整链接贴入括号内即可
(<code>[value](link)</code>)，例如</p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">点击[<span class="string">这里</span>](<span class="link">https://hasegawaazusa.github.io</span>)进入博客</span><br></pre></td></tr></table></figure>
<p>效果如下</p>
<blockquote>
<p>点击<a href="https://hasegawaazusa.github.io">这里</a>进入博客</p>
</blockquote>
<p>对于站内的超链接，最好使用另一篇博客的 <code>permalink</code> 贴入
(有关 <code>permalink</code> 可参考<a href="#hexo%20博文头%20-%20Front-matter">hexo 配置详解</a>)，例如</p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">点击[<span class="string">这里</span>](<span class="link">/hexo-note.html</span>)进入博客</span><br></pre></td></tr></table></figure>
<p>效果如下</p>
<blockquote>
<p>点击<a href="/hexo-note.html">这里</a>进入博客</p>
</blockquote>
<p>若需要导航，可以使用 <code>permalink#title</code> ，例如</p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">点击[<span class="string">这里</span>](<span class="link">/hexo-note.html#hexo 博文插入超链接</span>)进入博客</span><br></pre></td></tr></table></figure>
<p>效果如下</p>
<blockquote>
<p>点击<a href="/hexo-note.html#hexo%20博文插入超链接">这里</a>进入博客</p>
</blockquote>
<h2 id="hexo-博文插入图片">hexo 博文插入图片</h2>
<p>更改hexo配置文件 (<code>next/_config.yml</code>) 中的<a href="#文章%20-%20Writing">Writing配置项</a></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>该选项为真时，新建博文会对应生成一个与文章同名的文件夹，可以将相关图片资源放进此文件夹内</p>
</blockquote>
<p>在<strong>博客根目录</strong>下安装<strong><code>hexo-asset-image</code></strong>插件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure>
<p>将相关图片资源放进对应文件夹并直接使用文件夹内的资源即可。</p>
<p>特别地，对于 <code>Typora</code> 使用者，可以在
<code>文件 - 偏好设置 - 图像</code> 中修改设置：</p>
<figure>
<img src="/hexo-note/typorasetting.png" alt="typorasetting">
<figcaption aria-hidden="true">typorasetting</figcaption>
</figure>
<p>这样，当 <code>Typora</code> 插入图片时，会自动将图片资源复制进入
hexo 可以检索的 asset 文件夹</p>
<h2 id="hexo-添加标签页">hexo 添加标签页</h2>
<p>在博客根目录下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure>
<p>在 Front-matter 中添加：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">type:</span> <span class="string">tags</span></span><br></pre></td></tr></table></figure>
<figure>
<img src="/hexo-note/index.png" alt="index">
<figcaption aria-hidden="true">index</figcaption>
</figure>
<p>完成后 hexo 便会自动生成标签页</p>
<blockquote>
<p>记得在菜单中添加进入方式</p>
</blockquote>
<h2 id="hexo-添加关于页">hexo 添加关于页</h2>
<p>在博客根目录下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page about</span><br></pre></td></tr></table></figure>
<p>在 Front-matter 中添加：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">type:</span> <span class="string">about</span></span><br></pre></td></tr></table></figure>
<p>在正文中输入关于页内容即可</p>
<blockquote>
<p>记得在添加进入方式</p>
</blockquote>
<h2 id="hexo-添加-404-页面">hexo 添加 404 页面</h2>
<p>在博客根目录下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page 404</span><br></pre></td></tr></table></figure>
<p>在 Front-matter 中添加：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">permalink:</span> <span class="string">/404</span></span><br></pre></td></tr></table></figure>
<p>在正文中输入你需要的内容即可</p>
<p>如果需要其他自定义页面，可以使用 <code>layout</code> 参数</p>
<h1 id="hexo-配置详解">hexo 配置详解</h1>
<h2 id="hexo-博文头---front-matter">hexo 博文头 - Front-matter</h2>
<table>
<colgroup>
<col style="width: 12%">
<col style="width: 43%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">参数</th>
<th style="text-align: left;">意义</th>
<th style="text-align: left;">默认值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>layout</code></td>
<td style="text-align: left;">排版</td>
<td style="text-align: left;"><a href="https://hexo.io/docs/configuration#Writing"><code>config.default_layout</code></a></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>title</code></td>
<td style="text-align: left;">标题</td>
<td style="text-align: left;">文件名</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>date</code></td>
<td style="text-align: left;">发布日期</td>
<td style="text-align: left;">文件创建日期</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>updated</code></td>
<td style="text-align: left;">更新日期</td>
<td style="text-align: left;">文件更新日期</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>comments</code></td>
<td style="text-align: left;">简介</td>
<td style="text-align: left;"><code>true</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>tags</code></td>
<td style="text-align: left;">标签</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>categories</code></td>
<td style="text-align: left;">分类</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>permalink</code></td>
<td style="text-align: left;">永久链接的相对路径
(如<code>/index.html</code>)</td>
<td style="text-align: left;"><code>null</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>excerpt</code></td>
<td style="text-align: left;">纯文本摘录 (需要使用插件<a href="https://hexo.io/docs/tag-plugins#Post-Excerpt">Post-Excerpt</a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>disableNunjucks</code></td>
<td style="text-align: left;">是否禁用 Nunjucks 的宏
(<code>&#123;&#123; &#125;&#125;</code> / <code>&#123;% %&#125;</code>)
和 <a href="https://hexo.io/docs/tag-plugins">tag plugins</a> 插件</td>
<td style="text-align: left;"><code>false</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>lang</code></td>
<td style="text-align: left;">指定语言</td>
<td style="text-align: left;"><code>_config.yml</code></td>
</tr>
</tbody>
</table>
<h2 id="hexo-站点配置文件">hexo 站点配置文件</h2>
<p>即 <code>~/_config.yml</code> 参数详解</p>
<h3 id="网站---site">网站 - Site</h3>
<ul>
<li><code>title</code> → 博客标题</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Hexo</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">&#x27;&#x27;</span>				<span class="comment"># 博客副标题</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&#x27;&#x27;</span>				<span class="comment"># 博客描述 (与搜索引擎的收录有关)</span></span><br><span class="line"><span class="attr">keywords:</span>					<span class="comment"># 博客关键字，支持多个关键字 (与搜索引擎的收录有关)</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">John</span> <span class="string">Doe</span>			<span class="comment"># 博客作者名</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">en</span>				<span class="comment"># 博客使用的语言 (可设置为zh-Hans或zh-CN以支持中文)</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">&#x27;&#x27;</span>				<span class="comment"># 博客时区 (默认使用电脑时区)</span></span><br></pre></td></tr></table></figure>
<h3 id="网址---url">网址 - URL</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## Set your site url here. For example, if you use GitHub Page, set url as &#x27;https://username.github.io/project&#x27;</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">http://example.com</span>						<span class="comment"># 博客网址，必须以 http:// 或 https:// 开头</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span>		<span class="comment"># 文章连接生成规则</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"><span class="attr">pretty_urls:</span></span><br><span class="line">  <span class="attr">trailing_index:</span> <span class="literal">true</span> <span class="comment"># Set to false to remove trailing &#x27;index.html&#x27; from permalinks</span></span><br><span class="line">  <span class="attr">trailing_html:</span> <span class="literal">true</span> <span class="comment"># Set to false to remove trailing &#x27;.html&#x27; from permalinks</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>一般只需要修改<strong><code>url</code></strong></p>
</blockquote>
<h3 id="目录---directory">目录 - Directory</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Directory</span></span><br><span class="line"><span class="attr">source_dir:</span> <span class="string">source</span>			<span class="comment"># 资源文件夹，这个文件夹用来存放内容。</span></span><br><span class="line"><span class="attr">public_dir:</span> <span class="string">public</span>			<span class="comment"># 公共文件夹，这个文件夹用于存放生成的站点文件。</span></span><br><span class="line"><span class="attr">tag_dir:</span> <span class="string">tags</span>				<span class="comment"># 标签文件夹。</span></span><br><span class="line"><span class="attr">archive_dir:</span> <span class="string">archives</span>		<span class="comment"># 归档文件夹。</span></span><br><span class="line"><span class="attr">category_dir:</span> <span class="string">categories</span>	<span class="comment"># 分类文件夹。</span></span><br><span class="line"><span class="attr">code_dir:</span> <span class="string">downloads/code</span>	<span class="comment"># Include code 文件夹， source_dir 下的子目录。</span></span><br><span class="line"><span class="attr">i18n_dir:</span> <span class="string">:lang</span>				<span class="comment"># 国际化（i18n）文件夹</span></span><br><span class="line"><span class="attr">skip_render:</span>				<span class="comment"># 跳过指定文件的渲染。详见参考</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>一般无需修改</p>
</blockquote>
<h3 id="文章---writing">文章 - Writing</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Writing</span></span><br><span class="line"><span class="attr">new_post_name:</span> <span class="string">:title.md</span>	<span class="comment"># 新文章的文件名称</span></span><br><span class="line"><span class="attr">default_layout:</span> <span class="string">post</span>		<span class="comment"># 预设布局</span></span><br><span class="line"><span class="attr">titlecase:</span> <span class="literal">false</span>			<span class="comment"># 把标题转换为 title case</span></span><br><span class="line"><span class="attr">external_link:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>				<span class="comment"># 在新标签中打开链接</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">site</span>				<span class="comment"># 作用域，网站/文章 (site / post)</span></span><br><span class="line">  <span class="attr">exclude:</span> <span class="string">&#x27;&#x27;</span>				<span class="comment"># 需要排除的域名。主域名和子域名如 www 需分别配置</span></span><br><span class="line"><span class="attr">filename_case:</span> <span class="number">0</span>			<span class="comment"># 把文件名称转换为 (1) 小写或 (2) 大写 (0 = 不转换) </span></span><br><span class="line"><span class="attr">render_drafts:</span> <span class="literal">false</span>		<span class="comment"># 显示草稿</span></span><br><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">false</span>	<span class="comment"># 启动 Asset 文件夹</span></span><br><span class="line"><span class="attr">relative_link:</span> <span class="literal">false</span>		<span class="comment"># 把链接改为与根目录的相对位址</span></span><br><span class="line"><span class="attr">future:</span> <span class="literal">true</span>				<span class="comment"># 显示未来的文章</span></span><br><span class="line"><span class="attr">highlight:</span>					<span class="comment"># 代码块的设置, 请参考 Highlight.js 进行设置	</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hljs:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">prismjs:</span>					<span class="comment"># 代码块的设置, 请参考 PrismJS 进行设置</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">preprocess:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong><a href="https://hexo.io/docs/syntax-highlight#Highlight-js">Highlight.js</a></strong></p>
<p><strong><a href="https://hexo.io/docs/syntax-highlight#PrismJS">PrismJS</a></strong></p>
</blockquote>
<h3 id="首页设置---home-page-setting">首页设置 - Home page setting</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Home page setting</span></span><br><span class="line"><span class="comment"># per_page: Posts displayed per page. (0 = disable pagination)</span></span><br><span class="line"><span class="comment"># order_by: Posts order. (Order by date descending by default)</span></span><br><span class="line"><span class="attr">index_generator:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">&#x27;&#x27;</span>					<span class="comment"># 首页的根目录。默认为&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">10</span>				<span class="comment"># 每页显示文章的数量。默认为 10 (0 = 关闭分页功能)</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span>			<span class="comment"># 显示文章的顺序。默认为 -date (date 是按日期升序排序)</span></span><br></pre></td></tr></table></figure>
<h3 id="分类-标签---category-tag">分类 &amp; 标签 - Category &amp;
Tag</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Category &amp; Tag</span></span><br><span class="line"><span class="attr">default_category:</span> <span class="string">uncategorized</span>		<span class="comment"># 默认分类</span></span><br><span class="line"><span class="attr">category_map:</span>						<span class="comment"># 分类别名</span></span><br><span class="line"><span class="attr">tag_map:</span>							<span class="comment"># 标签别名</span></span><br></pre></td></tr></table></figure>
<h3 id="日期-时间格式---date-time-format">日期 / 时间格式 - Date / Time
format</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Date / Time format</span></span><br><span class="line"><span class="comment">## Hexo uses Moment.js to parse and display date</span></span><br><span class="line"><span class="comment">## You can customize the date format as defined in</span></span><br><span class="line"><span class="comment">## http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line"><span class="attr">date_format:</span> <span class="string">YYYY-MM-DD</span>			<span class="comment"># 日期格式</span></span><br><span class="line"><span class="attr">time_format:</span> <span class="string">HH:mm:ss</span>			<span class="comment"># 时间格式</span></span><br><span class="line"><span class="comment">## updated_option supports &#x27;mtime&#x27;, &#x27;date&#x27;, &#x27;empty&#x27;</span></span><br><span class="line"><span class="attr">updated_option:</span> <span class="string">&#x27;mtime&#x27;</span>			<span class="comment"># 当 Front Matter 中没有指定 updated 时 updated 的取值</span></span><br></pre></td></tr></table></figure>
<h3 id="分页---pagination">分页 - Pagination</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Pagination</span></span><br><span class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></span><br><span class="line"><span class="attr">per_page:</span> <span class="number">10</span>					<span class="comment"># 每页显示的文章量 (0 = 关闭分页功能)</span></span><br><span class="line"><span class="attr">pagination_dir:</span> <span class="string">page</span>			<span class="comment"># 分页目录</span></span><br></pre></td></tr></table></figure>
<h3 id="扩展---extensions">扩展 - Extensions</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">landscape</span>				<span class="comment"># 当前主题名称。值为 false 时禁用主题</span></span><br></pre></td></tr></table></figure>
<h3 id="部署---deployment">部署 - Deployment</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span>						<span class="comment"># 部署方式</span></span><br><span class="line">  <span class="attr">repo:</span> 						<span class="comment"># 库（Repository）地址，SSH比较好</span></span><br><span class="line">  <span class="attr">branch:</span> 						<span class="comment"># 可选，分支名称（Github默认为master）</span></span><br><span class="line">  <span class="attr">message:</span> 						<span class="comment"># 自定义提交信息（默认为Site updated: &#123;&#123; now(&quot;YYYY-MM-DD HH:mm:ss&quot;) &#125;&#125;）</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>git</tag>
        <tag>hexo</tag>
        <tag>nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title>hgame-ezrsa</title>
    <url>//hgame/ezrsa.html</url>
    <content><![CDATA[<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extendedGCD</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="comment">#a*xi + b*yi = ri</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:         </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a     </span><br><span class="line">    <span class="keyword">else</span>:         </span><br><span class="line">        x, y, q = extendedGCD(b, a % b) </span><br><span class="line">        <span class="comment"># q = gcd(a, b) = gcd(b, a%b)         </span></span><br><span class="line">        x, y = y, (x - (a // b) * y)         </span><br><span class="line">        <span class="keyword">return</span> x, y, q</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">computeD</span>(<span class="params">fn, e</span>):</span></span><br><span class="line">    (x, y, r) = extendedGCD(fn, e)</span><br><span class="line">    <span class="comment">#y maybe &lt; 0, so convert it</span></span><br><span class="line">    <span class="keyword">if</span> y &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> fn + y</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fastExpMod</span>(<span class="params">b,e,c</span>):</span></span><br><span class="line">    result = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> e != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> (e &amp; <span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">            result = (result * b) % c</span><br><span class="line">        e &gt;&gt;= <span class="number">1</span></span><br><span class="line">        b = (b * b ) % c</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">l = [(<span class="number">12433</span>, <span class="number">149</span>, <span class="number">197</span>, <span class="number">104</span>), (<span class="number">8147</span>, <span class="number">131</span>, <span class="number">167</span>, <span class="number">6633</span>), (<span class="number">10687</span>, <span class="number">211</span>, <span class="number">197</span>, <span class="number">35594</span>), (<span class="number">19681</span>, <span class="number">131</span>, <span class="number">211</span>, <span class="number">15710</span>), (<span class="number">33577</span>, <span class="number">251</span>, <span class="number">211</span>, <span class="number">38798</span>), (<span class="number">30241</span>, <span class="number">157</span>, <span class="number">251</span>, <span class="number">35973</span>), (<span class="number">293</span>, <span class="number">211</span>, <span class="number">157</span>, <span class="number">31548</span>), (<span class="number">26459</span>, <span class="number">179</span>, <span class="number">149</span>, <span class="number">4778</span>), (<span class="number">27479</span>, <span class="number">149</span>, <span class="number">223</span>, <span class="number">32728</span>), (<span class="number">9029</span>, <span class="number">223</span>, <span class="number">137</span>, <span class="number">20696</span>), (<span class="number">4649</span>, <span class="number">149</span>, <span class="number">151</span>, <span class="number">13418</span>), (<span class="number">11783</span>, <span class="number">223</span>, <span class="number">251</span>, <span class="number">14239</span>), (<span class="number">13537</span>, <span class="number">179</span>, <span class="number">137</span>, <span class="number">11702</span>), (<span class="number">3835</span>, <span class="number">167</span>, <span class="number">139</span>, <span class="number">20051</span>), (<span class="number">30983</span>, <span class="number">149</span>, <span class="number">227</span>, <span class="number">23928</span>), (<span class="number">17581</span>, <span class="number">157</span>, <span class="number">131</span>, <span class="number">5855</span>), (<span class="number">35381</span>, <span class="number">223</span>, <span class="number">179</span>, <span class="number">37774</span>), (<span class="number">2357</span>, <span class="number">151</span>, <span class="number">223</span>, <span class="number">1849</span>), (<span class="number">22649</span>, <span class="number">211</span>, <span class="number">229</span>, <span class="number">7348</span>), (<span class="number">1151</span>, <span class="number">179</span>, <span class="number">223</span>, <span class="number">17982</span>), (<span class="number">8431</span>, <span class="number">251</span>, <span class="number">163</span>, <span class="number">30226</span>), (<span class="number">38501</span>, <span class="number">193</span>, <span class="number">211</span>, <span class="number">30559</span>), (<span class="number">14549</span>, <span class="number">211</span>, <span class="number">151</span>, <span class="number">21143</span>), (<span class="number">24781</span>, <span class="number">239</span>, <span class="number">241</span>, <span class="number">45604</span>), (<span class="number">8051</span>, <span class="number">179</span>, <span class="number">131</span>, <span class="number">7994</span>), (<span class="number">863</span>, <span class="number">181</span>, <span class="number">131</span>, <span class="number">11493</span>), (<span class="number">1117</span>, <span class="number">239</span>, <span class="number">157</span>, <span class="number">12579</span>), (<span class="number">7561</span>, <span class="number">149</span>, <span class="number">199</span>, <span class="number">8960</span>), (<span class="number">19813</span>, <span class="number">239</span>, <span class="number">229</span>, <span class="number">53463</span>), (<span class="number">4943</span>, <span class="number">131</span>, <span class="number">157</span>, <span class="number">14606</span>), (<span class="number">29077</span>, <span class="number">191</span>, <span class="number">181</span>, <span class="number">33446</span>), (<span class="number">18583</span>, <span class="number">211</span>, <span class="number">163</span>, <span class="number">31800</span>), (<span class="number">30643</span>, <span class="number">173</span>, <span class="number">191</span>, <span class="number">27293</span>), (<span class="number">11617</span>, <span class="number">223</span>, <span class="number">251</span>, <span class="number">13448</span>), (<span class="number">19051</span>, <span class="number">191</span>, <span class="number">151</span>, <span class="number">21676</span>), (<span class="number">18367</span>, <span class="number">179</span>, <span class="number">157</span>, <span class="number">14139</span>), (<span class="number">18861</span>, <span class="number">149</span>, <span class="number">191</span>, <span class="number">5139</span>), (<span class="number">9581</span>, <span class="number">211</span>, <span class="number">193</span>, <span class="number">25595</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">    e = i[<span class="number">0</span>]</span><br><span class="line">    p = i[<span class="number">1</span>]</span><br><span class="line">    q = i[<span class="number">2</span>]</span><br><span class="line">    c = i[<span class="number">3</span>]</span><br><span class="line">    n = p * q</span><br><span class="line">    fn = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = computeD(fn, e)</span><br><span class="line">    m = fastExpMod(c, d, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(m), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>hgame</tag>
        <tag>wp</tag>
        <tag>ctf</tag>
        <tag>rsa</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>latex 数学公式笔记</title>
    <url>//latex-math-note.html</url>
    <content><![CDATA[<h1 id="字母">字母</h1>
<table style="width:100%;">
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th>letter</th>
<th>exp</th>
<th>letter</th>
<th>exp</th>
<th>letter</th>
<th>exp</th>
<th>letter</th>
<th>exp</th>
<th>letter</th>
<th>exp</th>
<th>letter</th>
<th>exp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\alpha\)</span></td>
<td><code>\alpha</code></td>
<td><span class="math inline">\(\kappa\)</span></td>
<td><code>\kappa</code></td>
<td><span class="math inline">\(\psi\)</span></td>
<td><code>\psi</code></td>
<td><span class="math inline">\(\digamma\)</span></td>
<td><code>\digamma</code></td>
<td><span class="math inline">\(\Delta\)</span></td>
<td><code>\Delta</code></td>
<td><span class="math inline">\(\Theta\)</span></td>
<td><code>\Theta</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta\)</span></td>
<td><code>\beta</code></td>
<td><span class="math inline">\(\lambda\)</span></td>
<td><code>\lambda</code></td>
<td><span class="math inline">\(\rho\)</span></td>
<td><code>\rho</code></td>
<td><span class="math inline">\(\varepsilon\)</span></td>
<td><code>\varepsilon</code></td>
<td><span class="math inline">\(\Gamma\)</span></td>
<td><code>\Gamma</code></td>
<td><span class="math inline">\(\Upsilon\)</span></td>
<td><code>\Upsilon</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\chi\)</span></td>
<td><code>\chi</code></td>
<td><span class="math inline">\(\mu\)</span></td>
<td><code>\mu</code></td>
<td><span class="math inline">\(\sigma\)</span></td>
<td><code>\sigma</code></td>
<td><span class="math inline">\(\varkappa\)</span></td>
<td><code>\varkappa</code></td>
<td><span class="math inline">\(\Lambda\)</span></td>
<td><code>\Lambd</code>a</td>
<td><span class="math inline">\(\Xi\)</span></td>
<td><code>\Xi</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\delta\)</span></td>
<td><code>\delta</code></td>
<td><span class="math inline">\(\nu\)</span></td>
<td><code>\nu</code></td>
<td><span class="math inline">\(\tau\)</span></td>
<td><code>\tau</code></td>
<td><span class="math inline">\(\varphi\)</span></td>
<td><code>\varphi</code></td>
<td><span class="math inline">\(\Omega\)</span></td>
<td><code>\Omega</code></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\epsilon\)</span></td>
<td><code>\epsilon</code></td>
<td><span class="math inline">\(o\)</span></td>
<td><code>o</code></td>
<td><span class="math inline">\(\theta\)</span></td>
<td><code>\theta</code></td>
<td><span class="math inline">\(\varpi\)</span></td>
<td><code>\varpi</code></td>
<td><span class="math inline">\(\Phi\)</span></td>
<td><code>\Phi</code></td>
<td><span class="math inline">\(\aleph\)</span></td>
<td><code>\aleph</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\eta\)</span></td>
<td><code>\eta</code></td>
<td><span class="math inline">\(\omega\)</span></td>
<td><code>\omega</code></td>
<td><span class="math inline">\(\upsilon\)</span></td>
<td><code>\upsilon</code></td>
<td><span class="math inline">\(\varrho\)</span></td>
<td><code>\varrho</code></td>
<td><span class="math inline">\(\Pi\)</span></td>
<td><code>\Pi</code></td>
<td><span class="math inline">\(\beth\)</span></td>
<td><code>\beth</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\gamma\)</span></td>
<td><code>\gamma</code></td>
<td><span class="math inline">\(\phi\)</span></td>
<td><code>\phi</code></td>
<td><span class="math inline">\(\xi\)</span></td>
<td><code>\xi</code></td>
<td><span class="math inline">\(\varsigma\)</span></td>
<td><code>\varsigma</code></td>
<td><span class="math inline">\(\Psi\)</span></td>
<td><code>\Psi</code></td>
<td><span class="math inline">\(\daleth\)</span></td>
<td><code>\daleth</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\iota\)</span></td>
<td><code>\iota</code></td>
<td><span class="math inline">\(\pi\)</span></td>
<td><code>\pi</code></td>
<td><span class="math inline">\(\zeta\)</span></td>
<td><code>\zeta</code></td>
<td><span class="math inline">\(\vartheta\)</span></td>
<td><code>\vartheta</code></td>
<td><span class="math inline">\(\Sigma\)</span></td>
<td><code>\Sigma</code></td>
<td><span class="math inline">\(\gimel\)</span></td>
<td><code>\gimel</code></td>
</tr>
</tbody>
</table>
<p>特别地还有</p>
<table style="width:100%;">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th>letter</th>
<th>exp</th>
<th>letter</th>
<th>exp</th>
<th>letter</th>
<th>exp</th>
<th>letter</th>
<th>exp</th>
<th>letter</th>
<th>exp</th>
<th>letter</th>
<th>exp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\partial\)</span></td>
<td><code>\partial</code></td>
<td><span class="math inline">\(\infty\)</span></td>
<td><code>\infty</code></td>
<td><span class="math inline">\(\ell\)</span></td>
<td><code>\ell</code></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="符号">符号</h1>
<table>
<colgroup>
<col style="width: 16%">
<col style="width: 41%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="header">
<th>name</th>
<th>example</th>
<th>effort</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(叉) 乘与除</td>
<td><code>a\times b\div c</code></td>
<td><span class="math inline">\(a\times b\div c\)</span></td>
</tr>
<tr class="even">
<td>求模</td>
<td><code>a\mod&#123;b&#125;+c\pmod&#123;m&#125;</code></td>
<td><span class="math inline">\(a\mod{b}+c\pmod{m}\)</span></td>
</tr>
<tr class="odd">
<td>点乘</td>
<td><code>a\cdot b</code></td>
<td><span class="math inline">\(a\cdot b\)</span></td>
</tr>
<tr class="even">
<td>正负与负正</td>
<td><code>\pm a\mp b</code></td>
<td><span class="math inline">\(\pm a\mp b\)</span></td>
</tr>
<tr class="odd">
<td>交集与并集</td>
<td><code>A\cup B\cap C</code></td>
<td><span class="math inline">\(A\cup B\cap C\)</span></td>
</tr>
<tr class="even">
<td>逻辑运算</td>
<td><code>p\bigvee q\bigwedge \lnot r</code></td>
<td><span class="math inline">\(p\bigvee q\bigwedge \lnot
r\)</span></td>
</tr>
<tr class="odd">
<td>全称和特称</td>
<td><code>\forall p\ \exists q</code></td>
<td><span class="math inline">\(\forall p\ \exists q\)</span></td>
</tr>
<tr class="even">
<td>上标与下标</td>
<td><code>C^n_m</code></td>
<td><span class="math inline">\(C^n_m\)</span></td>
</tr>
<tr class="odd">
<td>分数</td>
<td><code>\frac&#123;a&#125;&#123;b&#125;+\frac c2</code></td>
<td><span class="math inline">\(\frac{a}{b}+\frac c2\)</span></td>
</tr>
<tr class="even">
<td>开方</td>
<td><code>\sqrt[3]&#123;5&#125;+\sqrt&#123;2&#125;</code></td>
<td><span class="math inline">\(\sqrt[3]{5}+\sqrt{2}\)</span></td>
</tr>
<tr class="odd">
<td>求和</td>
<td><code>\displaystyle\sum&#123;p_i&#125;+\sum_&#123;i=1&#125;^&#123;n&#125;&#123;p_i&#125;</code></td>
<td><span class="math inline">\(\displaystyle\sum{p_i}+\sum_{i=1}^{n}{p_i}\)</span></td>
</tr>
<tr class="even">
<td>连乘</td>
<td><code>\displaystyle\prod&#123;a_i&#125;+\prod_&#123;i=1&#125;^&#123;n&#125;a_i</code></td>
<td><span class="math inline">\(\displaystyle\prod{a_i}+\prod_{i=1}^{n}a_i\)</span></td>
</tr>
<tr class="odd">
<td>求导</td>
<td><code>f'(x)</code></td>
<td><span class="math inline">\(f&#39;(x)\)</span></td>
</tr>
<tr class="even">
<td>趋近于</td>
<td><code>x\to 0</code></td>
<td><span class="math inline">\(x\to 0\)</span></td>
</tr>
<tr class="odd">
<td>积分</td>
<td><code>\int_a^b&#123;f(x)dx&#125;+\iint&#123;g(x)dx&#125;</code></td>
<td><span class="math inline">\(\int_a^b{f(x)dx}+\iint{g(x)dx}\)</span></td>
</tr>
<tr class="even">
<td>曲线积分</td>
<td><code>\oint f(x)+\oiint g(x)</code></td>
<td><span class="math inline">\(\oint f(x)+\oiint g(x)\)</span></td>
</tr>
<tr class="odd">
<td>小于等于与大于等于</td>
<td><code>a\leq b\geq c</code></td>
<td><span class="math inline">\(a\leq b\geq c\)</span></td>
</tr>
<tr class="even">
<td>远大于与远小于</td>
<td><code>a\ll b\gg c</code></td>
<td><span class="math inline">\(a\ll b\gg c\)</span></td>
</tr>
<tr class="odd">
<td>恒等于与不等于</td>
<td><code>a\equiv b\neq c</code></td>
<td><span class="math inline">\(a\equiv b\neq c\)</span></td>
</tr>
<tr class="even">
<td>约等于</td>
<td><code>a\approx b</code></td>
<td><span class="math inline">\(a\approx b\)</span></td>
</tr>
<tr class="odd">
<td>可逆等号</td>
<td><code>A\rightleftharpoons B+C</code></td>
<td><span class="math inline">\(A\rightleftharpoons B+C\)</span></td>
</tr>
<tr class="even">
<td>全等与相似</td>
<td><code>A\cong B\simeq C</code></td>
<td><span class="math inline">\(A\cong B\simeq C\)</span></td>
</tr>
<tr class="odd">
<td>属于与不属于</td>
<td><code>A\in B\notin C</code></td>
<td><span class="math inline">\(A\in B\notin C\)</span></td>
</tr>
<tr class="even">
<td>包含于</td>
<td><code>A\subseteq B\supseteq C</code></td>
<td><span class="math inline">\(A\subseteq B\supseteq C\)</span></td>
</tr>
<tr class="odd">
<td>平行与垂直</td>
<td><code>a\parallel b\perp c</code></td>
<td><span class="math inline">\(a\parallel b\perp c\)</span></td>
</tr>
<tr class="even">
<td>三角形</td>
<td><code>\bigtriangleup ABC</code></td>
<td><span class="math inline">\(\bigtriangleup ABC\)</span></td>
</tr>
<tr class="odd">
<td>极限</td>
<td><code>\displaystyle\lim_&#123;x\to 0&#125;f(x)</code></td>
<td><span class="math inline">\(\displaystyle\lim_{x\to
0}f(x)\)</span></td>
</tr>
<tr class="even">
<td>三角函数</td>
<td><code>\sin x\cos x\tan x</code></td>
<td><span class="math inline">\(\sin x\cos x\tan x\)</span></td>
</tr>
<tr class="odd">
<td>各种省略号</td>
<td><code>\cdots\ \ddots\ \vdots</code></td>
<td><span class="math inline">\(\cdots\ \ddots\ \vdots\)</span></td>
</tr>
<tr class="even">
<td>推导符号</td>
<td><code>p\Rightarrow q\Leftrightarrow r</code></td>
<td><span class="math inline">\(p\Rightarrow q\Leftrightarrow
r\)</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>需要注意的是，<strong>微分符号</strong>并无自带，可以使用宏定义创造：<code>\def\d&#123;\mathrm&#123;d&#125;&#125;</code></p>
<p>然后使用 <code>\d</code> 便可输出正体 <code>d</code>，效果如下：
<span class="math display">\[
\def\d{\mathrm{d}}
\d x
\]</span></p>
<h1 id="公式">公式</h1>
<h2 id="矩阵">矩阵</h2>
<p>使用 <code>\begin&#123;matrix&#125;</code> 与 <code>\end&#123;matrix&#125;</code>
包含，使用 <code>&amp;</code> 空开矩阵元素，使用 <code>\\</code>
进行换行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">1 &amp; 2 &amp; 3 \\</span><br><span class="line">4 &amp; 5 &amp; 6 \\</span><br><span class="line">7 &amp; 8 &amp; 9</span><br><span class="line">\end&#123;matrix&#125;</span><br></pre></td></tr></table></figure>
<p>效果如下 <span class="math display">\[
\begin{matrix}
1 &amp; 2 &amp; 3 \\
4 &amp; 5 &amp; 6 \\
7 &amp; 8 &amp; 9
\end{matrix}
\]</span> 还可以这样写</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\left\&#123;</span><br><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">  1 &amp; 2 &amp; 3 \\</span><br><span class="line">  4 &amp; 5 &amp; 6 \\</span><br><span class="line">  7 &amp; 8 &amp; 9</span><br><span class="line">\end&#123;matrix&#125;</span><br><span class="line">\right\&#125;</span><br><span class="line">\left[</span><br><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">  1 &amp; \cdots &amp; n_1 \\</span><br><span class="line">  \vdots &amp; \ddots &amp; \vdots \\</span><br><span class="line">  m &amp; \cdots &amp; n_m</span><br><span class="line">\end&#123;matrix&#125;</span><br><span class="line">\right]</span><br><span class="line">\left(</span><br><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">  1 &amp; 2 &amp; 3 \\</span><br><span class="line">  4 &amp; 5 &amp; 6 \\</span><br><span class="line">  7 &amp; 8 &amp; 9</span><br><span class="line">\end&#123;matrix&#125;</span><br><span class="line">\right)</span><br><span class="line">\left|</span><br><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">1 &amp; 2 &amp; 3 \\</span><br><span class="line">4 &amp; 5 &amp; 6 \\</span><br><span class="line">7 &amp; 8 &amp; 9</span><br><span class="line">\end&#123;matrix&#125;</span><br><span class="line">\right|</span><br></pre></td></tr></table></figure>
<p><span class="math display">\[
\left\{
\begin{matrix}
  1 &amp; 2 &amp; 3 \\
  4 &amp; 5 &amp; 6 \\
  7 &amp; 8 &amp; 9
\end{matrix}
\right\}
\left[
\begin{matrix}
  1 &amp; \cdots &amp; n_1 \\
  \vdots &amp; \ddots &amp; \vdots \\
  m &amp; \cdots &amp; n_m
\end{matrix}
\right]
\left(
\begin{matrix}
  1 &amp; 2 &amp; 3 \\
  4 &amp; 5 &amp; 6 \\
  7 &amp; 8 &amp; 9
\end{matrix}
\right)
\left|
\begin{matrix}
1 &amp; 2 &amp; 3 \\
4 &amp; 5 &amp; 6 \\
7 &amp; 8 &amp; 9
\end{matrix}
\right|
\]</span></p>
<p><strong>增广矩阵</strong>需要使用特殊的写法，即使用
<code>\begin&#123;array&#125;&#123;cc|c&#125;</code> 和 <code>\end&#123;array&#125;</code>
包含矩阵内容，其中 <code>c</code> 为占位符：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\left[</span><br><span class="line">\begin&#123;array&#125;&#123;cc|c&#125;</span><br><span class="line">  1 &amp; 2 &amp; 3 \\</span><br><span class="line">  4 &amp; 5 &amp; 6 \\</span><br><span class="line">  7 &amp; 8 &amp; 9</span><br><span class="line">\end&#123;array&#125;</span><br><span class="line">\right]</span><br></pre></td></tr></table></figure>
<p>效果如下 <span class="math display">\[
\left[
\begin{array}{cc|c}
  1 &amp; 2 &amp; 3 \\
  4 &amp; 5 &amp; 6 \\
  7 &amp; 8 &amp; 9
\end{array}
\right]
\]</span></p>
<h2 id="方程组">方程组</h2>
<p>使用 <code>\begin&#123;cases&#125;</code> 与 <code>\end&#123;cases&#125;</code>
包含，使用 <code>\\</code> 进行换行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\begin&#123;cases&#125;</span><br><span class="line">x\equiv a_1\pmod&#123;m_1&#125;\\</span><br><span class="line">x\equiv a_2\pmod&#123;m_2&#125;\\</span><br><span class="line">\cdots\\</span><br><span class="line">x\equiv a_n\pmod&#123;m_n&#125;</span><br><span class="line">\end&#123;cases&#125;</span><br></pre></td></tr></table></figure>
<p>效果如下 <span class="math display">\[
\begin{cases}
x\equiv a_1\pmod{m_1}\\
x\equiv a_2\pmod{m_2}\\
\cdots\\
x\equiv a_n\pmod{m_n}
\end{cases}
\]</span></p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>latex</tag>
        <tag>math</tag>
      </tags>
  </entry>
  <entry>
    <title>Mersenne Twister 梅森旋转算法笔记</title>
    <url>//mersenne-twister-note.html</url>
    <content><![CDATA[<h1 id="梅森旋转算法简介">梅森旋转算法简介</h1>
<p>梅森旋转算法（Mersenne Twister Algorithm，简称
MT）是为了解决过去伪随机数发生器（Pseudo-Random Number Generator，简称
PRNG）产生的伪随机数质量不高而提出的新算法。该算法由松本眞（Makoto
Matsumoto）和西村拓士（Takuji Nishimura）在 1997
年提出，期间还得到了「算法之神」高德纳（Donald Ervin Knuth）的帮助。</p>
<p>Mersenne
Twister这个名字来自周期长度取自梅森质数的这样一个事实。这个算法通常使用两个相近的变体，不同之处在于使用了不同的梅森素数。一个更新的和更常用的是MT19937,
32位字长。还有一个变种是64位版的MT19937-64。对于一个<em>k</em>位的长度，Mersenne
Twister会在<span class="math inline">\([0,2^{k}-1]\)</span>的区间之间生成离散型均匀分布的随机数。</p>
<p>其是多种语言的默认随机数算法，如Python、PHP和Matlab等。同时从C++11开始，C++中可以使用
<code>std::mtl9937_64</code> 使用梅森旋转算法。</p>
<p>目前被视为是最好的随机数算法。</p>
<h1 id="算法描述">算法描述</h1>
<p>以下使用 MT19937 代替称呼梅森旋转算法。</p>
<p>MT19937 需要有一个 624 大小的 int32
数组来保存<strong>寄存器状态</strong>。</p>
<p>以下是算法步骤：</p>
<ol type="1">
<li>利用 seed 初始化寄存器状态</li>
<li>对寄存器状态进行旋转</li>
<li>根据寄存器状态提取伪随机数</li>
</ol>
<p>下面使用 python 对算法进行剖析。</p>
<h2 id="mt19937-初始化">MT19937 初始化</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MT19937</span>:</span></span><br><span class="line">    <span class="comment"># 常量初始化</span></span><br><span class="line">    n = <span class="number">624</span></span><br><span class="line">    m = <span class="number">397</span></span><br><span class="line">    a = <span class="number">0x9908b0df</span></span><br><span class="line">    b = <span class="number">0x9d2c5680</span></span><br><span class="line">    c = <span class="number">0xefc60000</span></span><br><span class="line">    kInitOperand = <span class="number">0x6c078965</span></span><br><span class="line">    kMaxBits = <span class="number">0xffffffff</span></span><br><span class="line">    kUpperBits = <span class="number">0x80000000</span></span><br><span class="line">    kLowerBits = <span class="number">0x7fffffff</span></span><br><span class="line">    <span class="comment"># 寄存器状态</span></span><br><span class="line">    register = [<span class="number">0</span>] * n</span><br><span class="line">    <span class="comment"># 寄存器状态量</span></span><br><span class="line">    state = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 将数字变为 32 位整数</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_int32</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        <span class="keyword">return</span> x &amp; <span class="number">0xffffffff</span></span><br></pre></td></tr></table></figure>
<h2 id="初始化寄存器状态">初始化寄存器状态</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 初始化寄存器状态</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">seed</span>(<span class="params">self, seed</span>):</span></span><br><span class="line">    self.register[<span class="number">0</span>] = seed</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">        self.register[i] = self._int32(self.kInitOperand *</span><br><span class="line">                (self.register[i-<span class="number">1</span>] ^ self.register[i-<span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, seed = <span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> seed:</span><br><span class="line">        self.seed(seed)</span><br></pre></td></tr></table></figure>
<h2 id="旋转">旋转</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 旋转</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">twist</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.n):</span><br><span class="line">        x = self._int32((self.register[i] &amp; self.kUpperBits) +</span><br><span class="line">                        (self.register[(i + <span class="number">1</span>) % self.n] &amp; self.kLowerBits))</span><br><span class="line">        self.register[i] = self.register[(i + self.m) % self.n] ^ (x &gt;&gt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> x &amp; <span class="number">1</span> != <span class="number">0</span>:</span><br><span class="line">            self.register[i] ^= <span class="number">0x9908b0df</span></span><br><span class="line">    self.index = <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h2 id="提取伪随机数">提取伪随机数</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 提取</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extract</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">if</span> self.state &gt;= self.n:</span><br><span class="line">        self.twist()</span><br><span class="line"></span><br><span class="line">    x = self.register[self.state]</span><br><span class="line">    x ^= x &gt;&gt; <span class="number">11</span></span><br><span class="line">    x ^= (x &lt;&lt; <span class="number">7</span>) &amp; self.b</span><br><span class="line">    x ^= (x &lt;&lt; <span class="number">15</span>) &amp; self.c</span><br><span class="line">    x ^= x &gt;&gt; <span class="number">18</span></span><br><span class="line"></span><br><span class="line">    self.state += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> self._int32(x)</span><br></pre></td></tr></table></figure>
<h2 id="完整代码">完整代码</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MT19937</span>:</span></span><br><span class="line">    n = <span class="number">624</span></span><br><span class="line">    m = <span class="number">397</span></span><br><span class="line">    a = <span class="number">0x9908b0df</span></span><br><span class="line">    b = <span class="number">0x9d2c5680</span></span><br><span class="line">    c = <span class="number">0xefc60000</span></span><br><span class="line">    kInitOperand = <span class="number">0x6c078965</span></span><br><span class="line">    kMaxBits = <span class="number">0xffffffff</span></span><br><span class="line">    kUpperBits = <span class="number">0x80000000</span></span><br><span class="line">    kLowerBits = <span class="number">0x7fffffff</span></span><br><span class="line">    register = [<span class="number">0</span>] * n</span><br><span class="line">    state = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将数字变为 32 位整数</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_int32</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        <span class="keyword">return</span> x &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 初始化寄存器状态</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">seed</span>(<span class="params">self, seed</span>):</span></span><br><span class="line">        self.register[<span class="number">0</span>] = seed</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, self.n):</span><br><span class="line">            self.register[i] = self._int32(self.kInitOperand *</span><br><span class="line">                    (self.register[i-<span class="number">1</span>] ^ self.register[i-<span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, seed = <span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> seed:</span><br><span class="line">            self.seed(seed)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 旋转</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twist</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.n):</span><br><span class="line">            x = self._int32((self.register[i] &amp; self.kUpperBits) +</span><br><span class="line">                            (self.register[(i + <span class="number">1</span>) % self.n] &amp; self.kLowerBits))</span><br><span class="line">            self.register[i] = self.register[(i + self.m) % self.n] ^ (x &gt;&gt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> x &amp; <span class="number">1</span> != <span class="number">0</span>:</span><br><span class="line">                self.register[i] ^= self.a</span><br><span class="line">        self.state = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提取</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">extract</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.state &gt;= self.n:</span><br><span class="line">            self.twist()</span><br><span class="line"></span><br><span class="line">        x = self.register[self.state]</span><br><span class="line">        x ^= x &gt;&gt; <span class="number">11</span></span><br><span class="line">        x ^= (x &lt;&lt; <span class="number">7</span>) &amp; self.b</span><br><span class="line">        x ^= (x &lt;&lt; <span class="number">15</span>) &amp; self.c</span><br><span class="line">        x ^= x &gt;&gt; <span class="number">18</span></span><br><span class="line"></span><br><span class="line">        self.state += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self._int32(x)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.extract()</span><br></pre></td></tr></table></figure>
<h1 id="算法破解">算法破解</h1>
<p>梅森旋转算法的设计目的是优秀的伪随机数发生算法，而不是产生密码学上安全的随机数。从梅森旋转算法的结构上说，其提取算法
<code>extract</code>
完全基于二进制的按位异或；而二进制按位异或是可逆的，故而
<code>extract</code>
是可逆的。这就意味着，攻击者可以从梅森旋转算法的输出，逆推出产生该输出的内部寄存器状态
<code>register[state]</code>。若攻击者能够获得连续的至少
<code>n</code>个寄存器状态，那么攻击者就能预测出接下来的随机数序列。</p>
<p>以下我们用 python 对算法逐步破解</p>
<h2 id="右移位后异或逆向">右移位后异或逆向</h2>
<p>首先观察原函数。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">right_shift_xor</span>(<span class="params">value, shift</span>):</span></span><br><span class="line">    result = value</span><br><span class="line">    result ^= (result &gt;&gt; shift)</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>
<p>简单起见，我们观察一个 8 位二进制数，右移 3 位后异或的过程。</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">value:    <span class="number">1101</span> <span class="number">0010</span></span><br><span class="line">shifted:  <span class="number">0001</span> <span class="number">1010</span> # <span class="number">010</span> (&gt;&gt; <span class="number">3</span>)</span><br><span class="line">result:   <span class="number">1100</span> <span class="number">1000</span></span><br></pre></td></tr></table></figure>
<p>首先，观察到 <code>result</code> 的最高 <code>shift</code> 位与
<code>value</code> 的最高 <code>shift</code> 位是一样的。因此，在
<code>result</code> 的基础上，我们可以将其与一个二进制遮罩取与，得到
<code>value</code> 的最高 <code>shift</code>
位。这个遮罩应该是：<code>1111 1111 &lt;&lt; (8 - 3) = 1110 0000</code>。于是我们得到
<code>1100 0000</code>。</p>
<p>其次，注意到对于异或运算有如下事实：<code>a ^ b ^ b = a</code>。依靠二进制遮罩，我们已经获得了
<code>value</code> 的最高 <code>shift</code> 位。因此，我们也就能得到
<code>shifted</code> 的最高 <code>2 * shift</code> 位。它应该是
<code>1100 0000 &gt;&gt; 3 = 0001 1000</code>。将其与
<code>result</code> 取异或，则能得到 <code>value</code> 的最高
<code>2 * shift</code> 位。于是我们得到 <code>1101 0000</code>。</p>
<p>故我们可以逆向出代码：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unshiftRight</span>(<span class="params">self, x, shift</span>):</span></span><br><span class="line">    res = x</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        res = x ^ res &gt;&gt; shift</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h2 id="左移位后异或逆向">左移位后异或逆向</h2>
<p>同理可得代码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unshiftLeft</span>(<span class="params">self, x, shift, mask</span>):</span></span><br><span class="line">    res = x</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        res = x ^ (res &lt;&lt; shift &amp; mask)</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h2 id="提取伪随机数逆向">提取伪随机数逆向</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">b = <span class="number">0x9d2c5680</span></span><br><span class="line">c = <span class="number">0xefc60000</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">untemper</span>(<span class="params">self, v</span>):</span></span><br><span class="line">    v = self.unshiftRight(v, <span class="number">18</span>)</span><br><span class="line">    v = self.unshiftLeft(v, <span class="number">15</span>, self.c)</span><br><span class="line">    v = self.unshiftLeft(v, <span class="number">7</span>, self.b)</span><br><span class="line">    v = self.unshiftRight(v, <span class="number">11</span>)</span><br><span class="line">    <span class="keyword">return</span> v</span><br></pre></td></tr></table></figure>
<h2 id="通过输出参数逆向">通过输出参数逆向</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># forward 表示是否需要回到目前状态</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">go</span>(<span class="params">self, outputs, forward=<span class="literal">True</span></span>):</span></span><br><span class="line">    <span class="comment"># 还原的寄存器状态</span></span><br><span class="line">    result_state = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 至少需要 624 个寄存器状态</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(outputs) &gt;= <span class="number">624</span></span><br><span class="line"></span><br><span class="line">    ivals = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        ivals.append(self.untemper(outputs[i]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(outputs) &gt;= <span class="number">625</span>:</span><br><span class="line">        <span class="comment"># 此时可以使用后面的数据进行验证</span></span><br><span class="line">        challenge = outputs[<span class="number">624</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">626</span>):</span><br><span class="line">            state = (<span class="number">3</span>, <span class="built_in">tuple</span>(ivals+[i]), <span class="literal">None</span>)</span><br><span class="line">            r = random.Random()</span><br><span class="line">            r.setstate(state)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> challenge == r.getrandbits(<span class="number">32</span>):</span><br><span class="line">                result_state = state</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 如果刚好是 624 个寄存器状态</span></span><br><span class="line">        result_state = (<span class="number">3</span>, <span class="built_in">tuple</span>(ivals+[<span class="number">624</span>]), <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 利用 python 自带的 mt19937 random 库</span></span><br><span class="line">    rand = random.Random()</span><br><span class="line">    rand.setstate(result_state)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 如果需要到输出后的状态，则进行比较判断</span></span><br><span class="line">    <span class="keyword">if</span> forward:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>, <span class="built_in">len</span>(outputs)):</span><br><span class="line">            <span class="keyword">assert</span> rand.getrandbits(<span class="number">32</span>) == outputs[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> rand</span><br></pre></td></tr></table></figure>
<h2 id="完整代码-1">完整代码</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MT19937Recover</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unshiftRight</span>(<span class="params">self, x, shift</span>):</span></span><br><span class="line">        res = x</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            res = x ^ res &gt;&gt; shift</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unshiftLeft</span>(<span class="params">self, x, shift, mask</span>):</span></span><br><span class="line">        res = x</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            res = x ^ (res &lt;&lt; shift &amp; mask)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">untemper</span>(<span class="params">self, v</span>):</span></span><br><span class="line">        v = self.unshiftRight(v, <span class="number">18</span>)</span><br><span class="line">        v = self.unshiftLeft(v, <span class="number">15</span>, <span class="number">0xefc60000</span>)</span><br><span class="line">        v = self.unshiftLeft(v, <span class="number">7</span>, <span class="number">0x9d2c5680</span>)</span><br><span class="line">        v = self.unshiftRight(v, <span class="number">11</span>)</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">go</span>(<span class="params">self, outputs, forward=<span class="literal">True</span></span>):</span></span><br><span class="line">        result_state = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(outputs) &gt;= <span class="number">624</span></span><br><span class="line"></span><br><span class="line">        ivals = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">            ivals.append(self.untemper(outputs[i]))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(outputs) &gt;= <span class="number">625</span>:</span><br><span class="line">            challenge = outputs[<span class="number">624</span>]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">626</span>):</span><br><span class="line">                state = (<span class="number">3</span>, <span class="built_in">tuple</span>(ivals+[i]), <span class="literal">None</span>)</span><br><span class="line">                r = random.Random()</span><br><span class="line">                r.setstate(state)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> challenge == r.getrandbits(<span class="number">32</span>):</span><br><span class="line">                    result_state = state</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result_state = (<span class="number">3</span>, <span class="built_in">tuple</span>(ivals+[<span class="number">624</span>]), <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">        rand = random.Random()</span><br><span class="line">        rand.setstate(result_state)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> forward:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>, <span class="built_in">len</span>(outputs)):</span><br><span class="line">                <span class="keyword">assert</span> rand.getrandbits(<span class="number">32</span>) == outputs[i]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> rand</span><br><span class="line"></span><br><span class="line">mtc = MT19937Recover()</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>crypto</tag>
        <tag>PRNG</tag>
      </tags>
  </entry>
  <entry>
    <title>NexT 笔记</title>
    <url>//next-note.html</url>
    <content><![CDATA[<p>本文以 <code>hexo/</code> 指代博客根目录；以 <code>next/</code> 指代
NexT 主题根目录 (<code>hexo/node_modules/hexo-theme-next/</code>) 。</p>
<h1 id="next-技巧">NexT 技巧</h1>
<h2 id="阅读全文---read-more">阅读全文 - Read More</h2>
<p>在<code>.md</code>博文内容文件中使用<code>&lt;!-- more --&gt;</code>，在生成文章时会自动保留截断标志<code>&lt;!-- more --&gt;</code>以上的内容，并生成<strong>阅读全文(Read
More)</strong>按钮：</p>
<figure>
<img src="/next-note/readmore.png" alt="readmore">
<figcaption aria-hidden="true">readmore</figcaption>
</figure>
<blockquote>
<p>注意：如果该方法会被<a href="#博文摘要配置%20-%20Preamble%20Text">博文摘要配置 - Preamble
Text</a>覆盖</p>
</blockquote>
<h2 id="进度条---pace">进度条 - Pace</h2>
<ul>
<li><p><strong>NexT 配置</strong></p>
<ul>
<li><p><code>color</code> → 进度条的颜色 (英文单词)</p></li>
<li><p><code>theme</code> → 主题配置 (<a href="https://codebyzach.github.io/pace/">themes</a>)</p>
<table>
<colgroup>
<col style="width: 21%">
<col style="width: 78%">
</colgroup>
<thead>
<tr class="header">
<th>theme name</th>
<th>theme effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Minimal</td>
<td><img src="/next-note/Minimal.png" alt="Minimal" style="zoom: 67%;"></td>
</tr>
<tr class="even">
<td>Flash</td>
<td><img src="/next-note/Flash.png" alt="Flash" style="zoom: 67%;"></td>
</tr>
<tr class="odd">
<td>Barber Shop</td>
<td><img src="/next-note/Barber Shop.png" alt="Barber Shop" style="zoom:67%;"></td>
</tr>
<tr class="even">
<td>Mac OSX</td>
<td><img src="/next-note/Mac OSX.png" alt="Mac OSX" style="zoom:67%;"></td>
</tr>
<tr class="odd">
<td>Fill Left</td>
<td><img src="/next-note/Fill Left.png" alt="Fill Left" style="zoom:67%;"></td>
</tr>
<tr class="even">
<td>Flat Top</td>
<td><img src="/next-note/Flat Top.png" alt="Flat Top" style="zoom:67%;"></td>
</tr>
<tr class="odd">
<td>Big Counter</td>
<td><img src="/next-note/Big Counter.png" alt="Big Counter" style="zoom:67%;"></td>
</tr>
<tr class="even">
<td>Corner Indicator</td>
<td><img src="/next-note/Corner Indicator.png" alt="Corner Indicator" style="zoom:67%;"></td>
</tr>
<tr class="odd">
<td>Bounce</td>
<td><img src="/next-note/Bounce.png" alt="Bounce" style="zoom:67%;"></td>
</tr>
<tr class="even">
<td>Loading Bar</td>
<td><img src="/next-note/Loading Bar.png" alt="Loading Bar" style="zoom:67%;"></td>
</tr>
<tr class="odd">
<td>Center Circle</td>
<td><img src="/next-note/Center Circle.png" alt="Center Circle" style="zoom:67%;"></td>
</tr>
<tr class="even">
<td>Center Atom</td>
<td><img src="/next-note/Center Atom.png" alt="Center Atom" style="zoom:67%;"></td>
</tr>
<tr class="odd">
<td>Center Radar</td>
<td><img src="/next-note/Center Radar.png" alt="Center Radar" style="zoom:67%;"></td>
</tr>
<tr class="even">
<td>Center Simple</td>
<td><img src="/next-note/Center Simple.png" alt="Center Simple" style="zoom:67%;"></td>
</tr>
</tbody>
</table></li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">pace:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># All available colors:</span></span><br><span class="line">  <span class="comment"># black | blue | green | orange | pink | purple | red | silver | white | yellow</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">blue</span></span><br><span class="line">  <span class="comment"># All available themes:</span></span><br><span class="line">  <span class="comment"># big-counter | bounce | barber-shop | center-atom | center-circle | center-radar | center-simple | corner-indicator | fill-left | flat-top | flash | loading-bar | mac-osx | material | minimal</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">minimal</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="数学公式---math-equations">数学公式 - Math Equations</h2>
<p>以下启用 <code>mathjax + hexo-renderer-pandoc</code></p>
<ul>
<li><p>next 配置文件：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Math Formulas Render Support</span></span><br><span class="line"><span class="attr">math:</span></span><br><span class="line">  <span class="comment"># Default (false) will load mathjax / katex script on demand.</span></span><br><span class="line">  <span class="comment"># That is it only render those page which has `mathjax: true` in front-matter.</span></span><br><span class="line">  <span class="comment"># If you set it to true, it will load mathjax / katex script EVERY PAGE.</span></span><br><span class="line">  <span class="attr">every_page:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">mathjax:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># Available values: none | ams | all</span></span><br><span class="line">    <span class="attr">tags:</span> <span class="string">none</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">katex:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># See: https://github.com/KaTeX/KaTeX/tree/master/contrib/copy-tex</span></span><br><span class="line">    <span class="attr">copy_tex:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>建议按需手动在 front-matter 中设置 mathjax: true</p>
</blockquote></li>
</ul>
<p>然后我们卸载原来的渲染器<code>hexo-renderer-marked</code>，然后安装<code>hexo-renderer-pandoc</code>：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm un hexo-renderer-marked --save</span><br><span class="line">npm install hexo-renderer-pandoc --save</span><br></pre></td></tr></table></figure>
<p>与此同时，我们需要安装 pandoc</p>
<p>进入 https://github.com/jgm/pandoc/releases
选择最新版下载并进行安装</p>
<figure>
<img src="/next-note/pandoc-asset.png" alt="pandoc-asset">
<figcaption aria-hidden="true">pandoc-asset</figcaption>
</figure>
<p>重启后我们便可正常使用 pandoc 公式渲染器</p>
<p>接下来我们在需要使用 mathjax 的页面，配置 front-matter 中
<code>mathjax: true</code> 即可达到想要的效果</p>
<p>更多自定义请参考 https://github.com/wzpan/hexo-renderer-pandoc</p>
<h1 id="next-服务插件配置---adding-plugins">NexT 服务、插件配置 - Adding
Plugins</h1>
<p>可以使用以下了解插件</p>
<ul>
<li>第三方服务 https://theme-next.js.org/docs/third-party-services/</li>
<li>Tag 插件（更合适的排版样式）
https://theme-next.js.org/docs/tag-plugins/</li>
<li><a href="/hexo-plugins-note.html">本站</a></li>
</ul>
<h1 id="next-博文头---front-matter">NexT 博文头 - Front-matter</h1>
<table>
<colgroup>
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 44%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>参数</th>
<th>类型</th>
<th>意义</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>author</code></td>
<td><code>string</code></td>
<td>博文作者</td>
<td>站点配置<code>_config.yml</code>的<code>author</code></td>
</tr>
<tr class="even">
<td><code>post_link</code></td>
<td><code>string</code></td>
<td>发布链接 (相对路径)</td>
<td>None</td>
</tr>
<tr class="odd">
<td><code>description</code></td>
<td><code>string</code></td>
<td>简介</td>
<td>None</td>
</tr>
<tr class="even">
<td><code>direction</code></td>
<td><code>string</code></td>
<td>有效值： <code>rtl</code></td>
<td>None</td>
</tr>
<tr class="odd">
<td><code>header</code></td>
<td><code>boolean</code></td>
<td>是否在索引页展示标题</td>
<td><code>true</code></td>
</tr>
<tr class="even">
<td><code>mathjax</code></td>
<td><code>boolean</code></td>
<td>是否支持 MathJax</td>
<td><code>math.every_page</code> in <code>_config.yml</code></td>
</tr>
<tr class="odd">
<td><code>sidebar</code></td>
<td><code>boolean</code></td>
<td>侧边栏是否显示</td>
<td>Depends on <code>sidebar.display</code> in
<code>_config.yml</code></td>
</tr>
<tr class="even">
<td><code>copyright</code></td>
<td><code>boolean</code></td>
<td>是否在版权页显示<code>theme.creative_commons.license</code>
同时启用<code>theme.creative_commons.post</code></td>
<td><code>true</code></td>
</tr>
<tr class="odd">
<td><code>sticky</code></td>
<td><code>number</code></td>
<td>置顶该帖子 (需要插件 <a href="https://github.com/hexojs/hexo-generator-index">hexo-generator-index</a>)</td>
<td>0</td>
</tr>
<tr class="even">
<td><code>quicklink</code></td>
<td><code>object</code> (1)</td>
<td>快速链接</td>
<td>From <code>_config.yml</code></td>
</tr>
<tr class="odd">
<td><code>reward_settings</code></td>
<td><code>object</code> (1)</td>
<td>捐赠设置</td>
<td>From <code>_config.yml</code></td>
</tr>
<tr class="even">
<td><code>toc</code></td>
<td><code>object</code> (1)</td>
<td>文章目录 TOC</td>
<td>From <code>_config.yml</code></td>
</tr>
</tbody>
</table>
<h1 id="next-主题配置">NexT 主题配置</h1>
<p>NexT
主题配置文件为<code>hexo/node_modules/hexo-theme-next/_config.yml</code></p>
<h2 id="缓存设置---cache-support">缓存设置 - Cache Support</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">cache:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>				<span class="comment"># 允许缓存内容生成</span></span><br></pre></td></tr></table></figure>
<h2 id="最小化生成设置---minify-support">最小化生成设置 - Minify
Support</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">minify:</span> <span class="literal">true</span>				<span class="comment"># 删除 hexo 不必要文件</span></span><br></pre></td></tr></table></figure>
<h2 id="排版方案设置---choosing-scheme">排版方案设置 - Choosing
Scheme</h2>
<ul>
<li><strong><code>Muse</code></strong> → 黑白主调，大量留白</li>
<li><strong><code>Mist</code></strong> → 更紧凑的 Muse
版本，具有整洁的单列视图</li>
<li><strong><code>Pisces</code></strong> →
双栏排版，小家碧玉似的清新</li>
<li><strong><code>Gemini</code></strong> → 类似
Pisces，有明显的柱状块，有阴影，显得更敏感的视野</li>
</ul>
<h2 id="黑夜模式---dark-mode">黑夜模式 - Dark Mode</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">darkmode:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h2 id="网站图标配置---configuring-favicon">网站图标配置 - Configuring
Favicon</h2>
<p>默认情况下，NexT 使用 <code>next/source/images</code>
文件夹中的图片作为网站图标</p>
<p>可以直接更改其中的图片来变更网站图标（名字不能改变）</p>
<p>最好是通过更改配置中的 <strong><code>favicon</code></strong>
参数进行更改网站图标配置</p>
<blockquote>
<p>图片资源路径为相对路径，默认在 <code>hexo/source/</code> 和
<code>next/source/</code> 文件夹中搜索</p>
</blockquote>
<blockquote>
<p>可以使用 <a href="https://realfavicongenerator.net/">Favicon
Generator</a> 自动化生成网站图标</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">favicon:</span></span><br><span class="line">  <span class="attr">small:</span> <span class="string">/images/favicon-16x16-next.png</span></span><br><span class="line">  <span class="attr">medium:</span> <span class="string">/images/favicon-32x32-next.png</span></span><br><span class="line">  <span class="attr">apple_touch_icon:</span> <span class="string">/images/apple-touch-icon-next.png</span></span><br><span class="line">  <span class="attr">safari_pinned_tab:</span> <span class="string">/images/logo.svg</span></span><br><span class="line">  <span class="comment">#android_manifest: /manifest.json</span></span><br></pre></td></tr></table></figure>
<h2 id="自定义-logo-设置---custom-logo-support">自定义 Logo 设置 -
Custom Logo Support</h2>
<blockquote>
<p>Scheme Mist 排版方案不支持自定义 Logo</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">custom_logo:</span> <span class="comment">#/uploads/custom-logo.jpg</span></span><br></pre></td></tr></table></figure>
<h2 id="版权协议配置---creative-commons">版权协议配置 - Creative
Commons</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Creative Commons 4.0 International License.</span></span><br><span class="line"><span class="comment"># See: https://creativecommons.org/about/cclicenses/</span></span><br><span class="line"><span class="attr">creative_commons:</span></span><br><span class="line">  <span class="comment"># Available values: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | cc-zero</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">by-nc-sa</span></span><br><span class="line">  <span class="comment"># Available values: big | small</span></span><br><span class="line">  <span class="attr">size:</span> <span class="string">small</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># You can set a language value if you prefer a translated version of CC license, e.g. deed.zh</span></span><br><span class="line">  <span class="comment"># CC licenses are available in 39 languages, you can find the specific and correct abbreviation you need on https://creativecommons.org</span></span><br><span class="line">  <span class="attr">language:</span> <span class="string">deed.zh</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>配置参考：https://creativecommons.org</p>
</blockquote>
<h2 id="菜单分类页配置---configuring-menu-items">菜单、分类页配置 -
Configuring Menu Items</h2>
<p>菜单设置项的格式 <strong><code>Key: /link/ || icon</code></strong>
包含 3 个值：</p>
<ul>
<li><p><strong><code>Key</code></strong></p>
<p><code>Key</code> →
菜单项的名称（<code>home</code>、<code>archives</code>等）。
如果找到此菜单的翻译语言，则将加载此翻译；如果没有，<code>Key</code>
将使用名称。</p></li>
<li><p><strong><code>link</code></strong></p>
<p><code>link</code> → 指向网站内相对 url 的目标链接</p></li>
<li><p><strong><code>icon</code></strong></p>
<p><code>icon</code> → Font Awesome 图标的名称。图标的名称可以在 <a href="https://fontawesome.com/">Font Awesome</a> 中找到。</p></li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-tags</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-archive</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-user</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu_settings:</span></span><br><span class="line">  <span class="attr">icons:</span> <span class="literal">true</span>				<span class="comment"># 启用菜单项图标</span></span><br><span class="line">  <span class="attr">badges:</span> <span class="literal">true</span>				<span class="comment"># 启用计数</span></span><br></pre></td></tr></table></figure>
<h2 id="侧边栏样式---sidebar-style">侧边栏样式 - Sidebar Style</h2>
<p>侧边栏样式配置包括 <code>position</code>, <code>width</code>,
<code>display</code>, <code>padding</code> 和 <code>offset</code></p>
<ul>
<li><p><strong><code>position</code></strong></p>
<p>更改侧边栏位置：</p>
<ul>
<li><strong><code>left</code></strong> → 放置在屏幕左侧。</li>
<li><strong><code>right</code></strong> → 放置在屏幕右侧。</li>
</ul></li>
<li><p><strong><code>width</code></strong></p>
<p>以像素为单位，指定侧边栏宽度</p></li>
<li><p><strong><code>display</code></strong></p>
<p>侧边栏出现的条件：</p>
<ul>
<li><strong><code>post</code></strong> →
仅在有索引的帖子中显示侧边栏。</li>
<li><strong><code>always</code></strong> → 在所有页面中显示侧边栏。</li>
<li><strong><code>hide</code></strong> →
在所有页面中隐藏（但可以由用户手动打开）。</li>
<li><strong><code>remove</code></strong> → 完全删除侧边栏。</li>
</ul></li>
<li><p><strong><code>padding</code></strong></p>
<p>以像素为单位，指定侧边栏填充量</p></li>
<li><p><strong><code>offset</code></strong></p>
<p>一像素为单位，指定菜单栏偏移量</p></li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">sidebar:</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">left</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">padding:</span> <span class="number">18</span></span><br><span class="line">  <span class="attr">offset:</span> <span class="number">12</span></span><br></pre></td></tr></table></figure>
<h2 id="侧边栏头像设置---configuring-avatar">侧边栏头像设置 -
Configuring Avatar</h2>
<blockquote>
<p>图片资源路径为相对路径，默认在<strong>博客根目录</strong>下的<strong><code>./source/</code></strong>和<strong>NexT主题根目录</strong>下的<strong><code>./source/</code></strong>文件夹中搜索</p>
</blockquote>
<p>头像图片的尺寸不影响显示（固定尺寸显示），但图片的清晰程度影响</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">/images/avatar.gif</span>		<span class="comment"># 头像相对路径</span></span><br><span class="line">  <span class="attr">rounded:</span> <span class="literal">true</span>					<span class="comment"># 是否取圆头像</span></span><br><span class="line">  <span class="attr">rotated:</span> <span class="literal">false</span>				<span class="comment"># 指针 focus 头像时，是否旋转一周</span></span><br></pre></td></tr></table></figure>
<h2 id="侧边栏网站状态---sidebar-site-state">侧边栏网站状态 - Sidebar
Site State</h2>
<p>与 <a href="#菜单、分类页配置%20-%20Configuring%20Menu%20Items">菜单、分类页配置
- Configuring Menu Items</a> 配置中的 <code>menu_settings.badges</code>
冲突</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">site_state:</span> <span class="literal">true</span>				<span class="comment"># 启用计数</span></span><br></pre></td></tr></table></figure>
<h2 id="侧边栏社交链接---sidebar-social-links">侧边栏社交链接 - Sidebar
Social Links</h2>
<p>侧边栏社交链接的格式 <strong><code>Name: link || icon</code></strong>
包含 3 个值：</p>
<ul>
<li><p><strong><code>Name</code></strong></p>
<p><code>Name</code> →
会被显示的社交网站名称（<code>Github</code>、<code>Google</code>等）。</p></li>
<li><p><strong><code>link</code></strong></p>
<p><code>link</code> → 社交主页的完整地址。</p></li>
<li><p><strong><code>icon</code></strong></p>
<p><code>icon</code> → Font Awesome 图标的名称。图标的名称可以在<a href="https://fontawesome.com/">Font Awesome</a>中找到。</p></li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="comment">#GitHub: https://github.com/yourname || fab fa-github</span></span><br><span class="line">  <span class="comment">#Google: https://plus.google.com/yourname || fab fa-google</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">social_icons:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>					<span class="comment"># 启用社交图标</span></span><br><span class="line">  <span class="attr">icons_only:</span> <span class="literal">false</span>				<span class="comment"># 启用不带有名称的社交图标</span></span><br><span class="line">  <span class="attr">transition:</span> <span class="literal">false</span>				<span class="comment"># 启用具有过渡效果的社交图标</span></span><br></pre></td></tr></table></figure>
<h2 id="侧边栏-blogrolls-配置---sidebar-blogrolls">侧边栏 Blogrolls 配置
- Sidebar Blogrolls</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">links_settings:</span></span><br><span class="line">  <span class="attr">icon:</span> <span class="string">fa</span> <span class="string">fa-globe</span>				<span class="comment"># Font Awesome 图标的名称</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">Links</span>					<span class="comment"># 默认值</span></span><br><span class="line">  <span class="attr">layout:</span> <span class="string">block</span>					<span class="comment"># 布局方式 (block | inline)</span></span><br></pre></td></tr></table></figure>
<p>如果<strong><code>links</code></strong>没有参数，不显示
<strong>Blogrolls</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">links:</span></span><br><span class="line">  <span class="attr">Google:</span> <span class="string">https://www.google.com</span></span><br></pre></td></tr></table></figure>
<h2 id="侧边栏文章目录---sidebar-toc-table-of-contents">侧边栏文章目录 -
Sidebar TOC (Table of Contents)</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>					<span class="comment"># 自动生成 TOC</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">true</span>					<span class="comment"># 自动生成 TOC 序号</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">false</span>					<span class="comment"># 目录名宽度大于侧边栏宽度时，自动换行</span></span><br><span class="line">  <span class="attr">expand_all:</span> <span class="literal">false</span>				<span class="comment"># 显示所有级别的目录，而不是当前级别的</span></span><br><span class="line">  <span class="attr">max_depth:</span> <span class="number">6</span>					<span class="comment"># 目录最大深度</span></span><br></pre></td></tr></table></figure>
<h2 id="页脚配置---site-footer-setting">页脚配置 - Site Footer
Setting</h2>
<h3 id="网站开始时间---site-start-time">网站开始时间 - Site Start
Time</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">since:</span> <span class="number">2022</span>					<span class="comment"># 开始年份   @ 2022 - 当前年份</span></span><br></pre></td></tr></table></figure>
<h3 id="页脚图标---site-footer-icon">页脚图标 - Site Footer Icon</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">icon:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">fa</span> <span class="string">fa-user</span>			<span class="comment"># Font Awesome 图标的名称。</span></span><br><span class="line">    <span class="attr">animated:</span> <span class="literal">true</span>				<span class="comment"># 图标动画化</span></span><br><span class="line">    <span class="attr">color:</span> <span class="string">&#x27;ff0000&#x27;</span>				<span class="comment"># 图标颜色</span></span><br></pre></td></tr></table></figure>
<h3 id="网站版权名称---site-copyright-name">网站版权名称 - Site
Copyright Name</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">copyright:</span> [<span class="string">name</span>]				<span class="comment"># 空白默认使用站点配置下的 author</span></span><br></pre></td></tr></table></figure>
<h3 id="网站平台信息---site-platform-information">网站平台信息 - Site
Platform Information</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">powered:</span> <span class="literal">false</span>				<span class="comment"># 是否显示网站框架</span></span><br></pre></td></tr></table></figure>
<h3 id="网站备案信息---site-beian-information">网站备案信息 - Site Beian
Information</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">beian:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span>				<span class="comment"># 是否显示以下信息</span></span><br><span class="line">    <span class="attr">icp:</span> <span class="string">京ICP备</span> <span class="number">1234567890</span><span class="string">号-1</span></span><br><span class="line">    <span class="attr">gongan_id:</span> <span class="number">1234567890</span></span><br><span class="line">    <span class="attr">gongan_num:</span> <span class="string">京公网安备</span> <span class="number">1234567890</span><span class="string">号</span></span><br><span class="line">    <span class="attr">gongan_icon_url:</span> <span class="string">/uploads/beian.png</span></span><br></pre></td></tr></table></figure>
<h2 id="博文摘要配置---preamble-text">博文摘要配置 - Preamble Text</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">excerpt_description:</span> <span class="literal">true</span>		<span class="comment"># 使用 description 的内容作为 Read More 的摘要。</span></span><br><span class="line"><span class="attr">read_more_btn:</span> <span class="literal">true</span>				<span class="comment"># 显示 Read More 按钮</span></span><br><span class="line"><span class="attr">auto_excerpt:</span></span><br><span class="line">	<span class="attr">enable:</span> <span class="literal">true</span>				<span class="comment"># 若不开启且 description 为空则使用全文做摘要</span></span><br><span class="line">	<span class="attr">length:</span> <span class="number">150</span>					<span class="comment"># 摘要长度</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：该配置会与 <code>&lt;!-- more --&gt;</code> 产生冲突</p>
</blockquote>
<blockquote>
<p>front-matter: description</p>
</blockquote>
<h2 id="发布信息配置---post-meta-display">发布信息配置 - Post Meta
Display</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post_meta:</span></span><br><span class="line">  <span class="attr">item_text:</span> <span class="literal">true</span>				<span class="comment"># 显示描述文本</span></span><br><span class="line">  <span class="attr">created_at:</span> <span class="literal">true</span>				<span class="comment"># 显示创建时间</span></span><br><span class="line">  <span class="attr">updated_at:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span>				<span class="comment"># 显示更新时间</span></span><br><span class="line">    <span class="attr">another_day:</span> <span class="literal">true</span>			<span class="comment"># 显示更新日</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="literal">true</span>				<span class="comment"># 显示分类</span></span><br></pre></td></tr></table></figure>
<h2 id="文末标签图标---tag-icon">文末标签图标 - Tag Icon</h2>
<p>默认情况下，博文末尾存在以#开头的标签超链接。</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">tag_icon:</span> <span class="literal">true</span>					<span class="comment"># 开启标签图标</span></span><br></pre></td></tr></table></figure>
<h2 id="捐赠打赏配置---donate-settings">捐赠、打赏配置 - Donate
Settings</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">reward_settings:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span>					<span class="comment"># 开启捐赠链接 (默认在所有博文下显示)</span></span><br><span class="line">  <span class="attr">animation:</span> <span class="literal">false</span>				<span class="comment"># 是否开启动画效果</span></span><br><span class="line">  <span class="attr">comment:</span> <span class="string">&#x27;&#x27;</span>					<span class="comment"># 捐赠注释</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 收款码</span></span><br><span class="line"><span class="attr">reward:</span></span><br><span class="line">  <span class="comment">#wechatpay: /images/wechatpay.png	</span></span><br><span class="line">  <span class="comment">#alipay: /images/alipay.png</span></span><br></pre></td></tr></table></figure>
<h2 id="关注---follow-me">关注 - Follow Me</h2>
<blockquote>
<p>参数参考<a href="#侧边栏社交链接%20-%20Sidebar%20Social%20Links">侧边栏社交链接 -
Sidebar Social Links</a></p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">follow_me:</span></span><br><span class="line">  <span class="comment">#Twitter: https://twitter.com/username || fab fa-twitter</span></span><br><span class="line">  <span class="comment">#Telegram: https://t.me/channel_name || fab fa-telegram</span></span><br><span class="line">  <span class="comment">#WeChat: /images/wechat_channel.jpg || fab fa-weixin</span></span><br><span class="line">  <span class="comment">#RSS: /atom.xml || fa fa-rss</span></span><br></pre></td></tr></table></figure>
<h2 id="博文编辑配置---post-edit">博文编辑配置 - Post Edit</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post_edit:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span>					<span class="comment"># 是否允许在存储库直接浏览和编辑源代码</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">https://github.com/user-name/repo-name/tree/branch-name/subdirectory-name/</span></span><br></pre></td></tr></table></figure>
<h2 id="博文导航配置---post-navigation">博文导航配置 - Post
Navigation</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post_navigation:</span> <span class="string">left</span>			<span class="comment"># 上一章、下一章 (left | right | false)</span></span><br></pre></td></tr></table></figure>
<h2 id="cdn配置---preconnect">CDN配置 - Preconnect</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">preconnect:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h2 id="文本对齐方式---text-align">文本对齐方式 - Text Align</h2>
<table>
<colgroup>
<col style="width: 18%">
<col style="width: 81%">
</colgroup>
<thead>
<tr class="header">
<th>值</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>start</code></td>
<td>The same as <code>left</code> if direction is left-to-right and
<code>right</code> if direction is right-to-left.</td>
</tr>
<tr class="even">
<td><code>end</code></td>
<td>The same as <code>right</code> if direction is left-to-right and
<code>left</code> if direction is right-to-left.</td>
</tr>
<tr class="odd">
<td><code>left</code></td>
<td>The inline contents are aligned to the left edge of the line
box.</td>
</tr>
<tr class="even">
<td><code>right</code></td>
<td>The inline contents are aligned to the right edge of the line
box.</td>
</tr>
<tr class="odd">
<td><code>center</code></td>
<td>The inline contents are centered within the line box.</td>
</tr>
<tr class="even">
<td><code>justify</code></td>
<td>The inline contents are justified. Text should be spaced to line up
its left and right edges to the left and right edges of the line box,
except for the last line.</td>
</tr>
<tr class="odd">
<td><code>justify-all</code></td>
<td>Same as <code>justify</code>, but also forces the last line to be
justified.</td>
</tr>
<tr class="even">
<td><code>match-parent</code></td>
<td>Similar to <code>inherit</code>, but the values <code>start</code>
and <code>end</code> are calculated according to the parent's direction
and are replaced by the appropriate <code>left</code> or
<code>right</code> value.</td>
</tr>
</tbody>
</table>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">text_align:</span></span><br><span class="line">  <span class="attr">desktop:</span> <span class="string">justify</span>				<span class="comment"># 桌面端</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="string">justify</span>				<span class="comment"># 移动端</span></span><br></pre></td></tr></table></figure>
<h2 id="移动端适配---mobile-devices-adaptation">移动端适配 - Mobile
Devices Adaptation</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mobile_layout_economy:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h2 id="主题颜色---theme-color">主题颜色 - Theme Color</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">theme_color:</span></span><br><span class="line">  <span class="attr">light:</span> <span class="string">&quot;#222&quot;</span></span><br><span class="line">  <span class="attr">dark:</span> <span class="string">&quot;#222&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="正文滚动条---body-scrollbar">正文滚动条 - Body Scrollbar</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">body_scrollbar:</span></span><br><span class="line">  <span class="attr">overlay:</span> <span class="literal">false</span>				<span class="comment"># 是否使用正文滚动条 (会覆盖浏览器默认样式)</span></span><br><span class="line">  <span class="attr">stable:</span> <span class="literal">false</span>					<span class="comment"># 是否固定滚动条</span></span><br></pre></td></tr></table></figure>
<h2 id="代码样式---codeblock-style">代码样式 - Codeblock Style</h2>
<p>NexT使用<a href="https://highlightjs.org/">Highlight.js</a>和<a href="https://prismjs.com/">Prism</a>进行语法高亮</p>
<p>可以预先使用<a href="https://theme-next.js.org/highlight/">NexT
Highlight Theme Preview</a>查看配置效果</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">codeblock:</span></span><br><span class="line">  <span class="attr">theme:</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">default</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">tomorrow-night</span></span><br><span class="line">  <span class="attr">prism:</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">prism</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">prism-dark</span></span><br><span class="line">  <span class="attr">copy_button:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span>				<span class="comment"># 启用代码一键复制按钮</span></span><br><span class="line">    <span class="attr">style:</span>						<span class="comment"># 代码框样式 (default | flat | mac)</span></span><br></pre></td></tr></table></figure>
<h2 id="快速回顶---back-to-top">快速回顶 - Back To Top</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">back2top:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>					<span class="comment"># 启用快速回顶按钮</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">false</span>				<span class="comment"># 按钮嵌入侧边栏</span></span><br><span class="line">  <span class="attr">scrollpercent:</span> <span class="literal">false</span>			<span class="comment"># 按钮嵌入滚动条</span></span><br></pre></td></tr></table></figure>
<h2 id="阅读进度---reading-progress">阅读进度 - Reading Progress</h2>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">reading_progress:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>					<span class="comment"># 是否启用阅读进度提示</span></span><br><span class="line">  <span class="attr">start_at:</span> <span class="string">left</span>				<span class="comment"># 从左开始还是从右开始加载 (left | right)</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">top</span>					<span class="comment"># 位置在哪 (top | bottom)</span></span><br><span class="line">  <span class="attr">reversed:</span> <span class="literal">false</span>				<span class="comment"># (从满到无 | 从无到满)</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;#37c6c0&quot;</span>				<span class="comment"># 进度条颜色</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">2px</span>					<span class="comment"># 进度条粗细</span></span><br></pre></td></tr></table></figure>
<h2 id="书签---bookmark">书签 - Bookmark</h2>
<p>书签标记后，下一次进入网站自动跳转到用户上一次浏览的地方</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">bookmark:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span>					<span class="comment"># 开启书签</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;#222&quot;</span>					<span class="comment"># 书签的颜色</span></span><br><span class="line">  <span class="attr">save:</span> <span class="string">auto</span>					<span class="comment"># 是否自动保存书签 (auto | manual)</span></span><br></pre></td></tr></table></figure>
<h2 id="字体配置---fonts-customization">字体配置 - Fonts
Customization</h2>
<p><strong>NexT</strong> 提供了 5 种特定的字体设置：</p>
<ul>
<li><strong>Global Font</strong>: 整个网站的基本字体</li>
<li><strong>Title Font</strong>: 网站标题的字体</li>
<li><strong>Headlines Font</strong>: 内容标题的字体</li>
<li><strong>Article Font</strong>: 内容的字体</li>
<li><strong>Code Font</strong>: 代码字体</li>
</ul>
<blockquote>
<p>如果字体不可用，会回退到 NexT 主题默认的字体</p>
</blockquote>
<p>详情请参考 <a href="https://theme-next.js.org/docs/theme-settings/miscellaneous.html#Fonts-Customization">Fonts
Customization</a></p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>hexo</tag>
        <tag>NexT</tag>
      </tags>
  </entry>
  <entry>
    <title>piet 编程语言笔记</title>
    <url>//piet-note.html</url>
    <content><![CDATA[<h1 id="piet-语言简述">Piet 语言简述</h1>
<p>Piet 是一种非常深奥的编程语言，使用颜色编写代码。由David
Morgan-Mar，其方案是位图，看起来像抽象艺术设计。编译指导图像周围移动，从一个连续颜色的区域下的一个“指针”。通过一个地区的指针退出时的程序进行。</p>
<h1 id="piet-语言编程">Piet 语言编程</h1>
<p>我们可以使用 https://gabriellesc.github.io/piet/ 编写 Piet</p>
<h1 id="piet-语言运行">Piet 语言运行</h1>
<p>Piet 拥有解释器和编译器，其中</p>
<ul>
<li><p>Windows 平台解释器</p>
<p>使用 Mike Tolly 所编写的 npiet，下载链接如下：</p>
<p>https://www.bertnase.de/npiet/npiet-1.3a-win32.zip</p>
<p>有关 npiet 的简介跟用法可以查看：</p>
<p>https://www.bertnase.de/npiet</p>
<p>或是使用命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npiet.exe -h</span><br></pre></td></tr></table></figure></li>
<li><p>Linux 平台解释器</p>
<p>https://github.com/JensBouman/Piet_interpreter</p>
<p>该解释器带有使用 <code>tkinter</code> 库编写的 GUI</p>
<p>用 git 克隆或通过 github 下载源码后，直接运行 <code>main.py</code>
即可</p>
<p>但该解释器编写于 python3，且依赖
<code>pillow</code>、<code>numpy</code> 和 <code>pygubu</code>
库，可以使用以下指令进行安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip3 install pillow</span><br><span class="line">pip3 install numpy</span><br><span class="line">pip3 install pygubu</span><br></pre></td></tr></table></figure>
<p>可以使用以下命令了解用法：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 ./main.py -h</span><br></pre></td></tr></table></figure></li>
<li><p>全平台翻译器</p>
<p>https://github.com/boothby/repiet</p>
<p>该翻译器可以将 piet 语言的 PNG、GIF 图片翻译为 C、C++、Python、piet
和 repiet 语言 (如果不指定会默认翻译为 Python)</p>
<p>该翻译器使用 python3，可以直接使用以下指令获取</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip3 install repiet</span><br></pre></td></tr></table></figure>
<p>更多用法可查看 github 主页和使用以下命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">repiet.exe -h</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>piet</tag>
      </tags>
  </entry>
  <entry>
    <title>汉字拼音加密笔记</title>
    <url>//pinyin-encode-note.html</url>
    <content><![CDATA[<h1 id="原理">原理</h1>
<p>汉字拼音有多种表示法，为了让算法可逆，我们使用声调风格为拼音音调以数字形式加在拼音末尾处的格式。</p>
<blockquote>
<p>如 <code>聪</code> 表示为 <code>cong1</code></p>
</blockquote>
<p>我们使用 Python3 中的 <code>pypinyin</code> 包，借用其中的
<code>pypinyin.lazy_pinyin()</code> 函数快捷获取汉字拼音。</p>
<blockquote>
<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from pypinyin import lazy_pinyin</span><br><span class="line">&gt;&gt;&gt; lazy_pinyin(<span class="string">&quot;独奏&quot;</span>, style=8)</span><br><span class="line">[<span class="string">&#x27;du2&#x27;</span>, <span class="string">&#x27;zou4&#x27;</span>]</span><br></pre></td></tr></table></figure>
</blockquote>
<p>然后我们将每个拼音的 ascii 码加起来，得到总和模 128
便可得到每个汉字所对应的 ascii 码明文。</p>
<blockquote>
<p>如 <code>独</code> 的拼音为 <code>'du2'</code>，所对应的 ascii
码明文为 11</p>
</blockquote>
<p>这样我们便得到了每个明文可以对应的汉字，其中按理来说，每个 ascii
明文所对应的汉字应该是多个的。</p>
<p>有关 <code>pypinyin</code> 库的用法可查阅它们的 github
主页和官方文档：</p>
<p>https://github.com/mozillazg/python-pinyin</p>
<p>https://pypinyin.readthedocs.io/zh_CN/master/</p>
<h1 id="代码">代码</h1>
<p>这里只给出解密代码：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pypinyin</span><br><span class="line"></span><br><span class="line">l = <span class="string">&#x27;夺旗赛好难啊&#x27;</span></span><br><span class="line">d = [pypinyin.lazy_pinyin(i, pypinyin.Style.TONE3) <span class="keyword">for</span> i <span class="keyword">in</span> l]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> d[<span class="number">0</span>]:</span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        a += <span class="built_in">ord</span>(j)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(a % <span class="number">128</span>), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>ps 图像缩放功能笔记</title>
    <url>//ps-distort-note.html</url>
    <content><![CDATA[<h1 id="最邻近插值算法-nearest-neighbor-interpolation">最邻近插值算法
(nearest neighbor interpolation)</h1>
<p>最邻近插值算法是将目标图像各点的像素值设为源图像中与其最近的点。算法优点在与简单、速度快。</p>
<p>如果是图像放大，算法会将空白数据处采用最邻近的原像素填充。</p>
<p>如果是图像缩小，算法会选取最小像素块中的中心像素，而舍弃周围像素。</p>
<h1 id="ps-中的邻近采样">PS 中的邻近采样</h1>
<p>打开图片，点击 <code>图像-图像大小</code>，勾选 <code>重新采样</code>
后，采样算法选择
<code>邻近</code>，然后自由输入想要缩放到的大小即可。</p>
<p>一般默认期望为等比例缩放，若不为等比例缩放，邻近采样可能达不到想要的效果。</p>
<h2 id="操作示例">操作示例</h2>
<p>操作以下面这张图进行示例：</p>
<figure>
<img src="/ps-distort-note/before.png" alt="before">
<figcaption aria-hidden="true">before</figcaption>
</figure>
<p>打开图片后，选择 <code>图像-图像大小</code></p>
<figure>
<img src="/ps-distort-note/setting.png" alt="setting">
<figcaption aria-hidden="true">setting</figcaption>
</figure>
<p>我们因为是想要图片中的有颜色的像素点组成的图像，我们便使用
<code>邻近</code>
采样，将除了有颜色的像素点周围的像素舍弃，计算得到每5个像素中心便存在一个有颜色的像素点，即大小从
215x215 变更为 43x43</p>
<figure>
<img src="/ps-distort-note/setting2.png" alt="setting2">
<figcaption aria-hidden="true">setting2</figcaption>
</figure>
<p>最后生成我们需求的图片：</p>
<figure>
<img src="/ps-distort-note/after.png" alt="after">
<figcaption aria-hidden="true">after</figcaption>
</figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>misc</tag>
        <tag>photoshop</tag>
        <tag>distort</tag>
      </tags>
  </entry>
  <entry>
    <title>powershell：尝试新的跨平台 PowerShell https://aka.ms/pscore6</title>
    <url>//errors/pscore6-error.html</url>
    <content><![CDATA[<h1 id="错误分析">错误分析</h1>
<p>powershell 版本过老，提示更新</p>
<figure>
<img src="/errors/pscore6-error/pserror.png" alt="pserror">
<figcaption aria-hidden="true">pserror</figcaption>
</figure>
<h1 id="修复错误">修复错误</h1>
<p>进入 https://github.com/PowerShell/PowerShell/releases/
寻找合适的版本 (推荐最新版) 进行下载并安装</p>
<figure>
<img src="/errors/pscore6-error/psreleases.png" alt="psreleases">
<figcaption aria-hidden="true">psreleases</figcaption>
</figure>
<blockquote>
<p>可以按照以下步骤将 Powershell7 添加到鼠标右键选项中：</p>
<p>保存以下代码在 <code>pwsh.reg</code> 文件中：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\pwsh7]</span><br><span class="line">@=&quot;在此处打开 Powershell7 窗口&quot;</span><br><span class="line">&quot;Extended&quot;=&quot;&quot;</span><br><span class="line">&quot;Icon&quot;=&quot;C:\Program Files\PowerShell\7\pwsh.exe&quot;</span><br><span class="line">&quot;ShowBasedOnVelocityId&quot;=dword:00639bc8</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\pwsh7\command]</span><br><span class="line">@=&quot;C:\Program Files\PowerShell\7\pwsh.exe -noexit -command Set-Location -literalPath &#x27;%V&#x27;&quot;</span><br></pre></td></tr></table></figure>
<p>然后双击文件 <code>pwsh.reg</code> 即可</p>
</blockquote>
]]></content>
      <tags>
        <tag>error</tag>
        <tag>powershell</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>rc4 笔记</title>
    <url>//rc4-note.html</url>
    <content><![CDATA[<h1 id="rc4-原理">RC4 原理</h1>
<h2 id="简述">简述</h2>
<p>在密码学中，RC4（来自Rivest Cipher
4的缩写）是一种流加密算法，密钥长度可变。它加解密使用相同的密钥，因此也属于对称加密算法，属于
Feistel 密码结构。</p>
<p>但不同于DES的是，RC4不是对明文进行分组处理，而是字节流的方式依次加密明文中的每一个字节，解密的时候也是依次对密文中的每一个字节进行解密。</p>
<h2 id="流密码">流密码</h2>
<p><strong>定义：</strong>流密码是对称密码算法，从明文输入流逐位或逐字节产生密文输出。</p>
<p><strong>实例：</strong>使用最广泛的流密码是RC4。</p>
<p><strong>流密码结构：</strong></p>
<figure>
<img src="/rc4-note/929265-20160620213554647-682128679.jpg" alt="流密码结构图">
<figcaption aria-hidden="true">流密码结构图</figcaption>
</figure>
<p>流密码类似于”一次一密”，不同的是”一次一密”使用的是真正的随机数流，而流密码使用的是伪随机数流。</p>
<p><strong>设计流密码的主要因素：</strong></p>
<ol type="1">
<li>加密序列的周期要长，若出现重复的周期过短，容易被破解</li>
<li>密钥流应该尽可能地接近真正随机数流的特征</li>
<li>密钥长度要长，以避免琼穷举攻击</li>
</ol>
<h2 id="算法逻辑结构">算法逻辑结构</h2>
<figure>
<img src="/rc4-note/929265-20160620213652444-560250478.jpg" alt="密钥流的生成">
<figcaption aria-hidden="true">密钥流的生成</figcaption>
</figure>
<h2 id="算法关键变量">算法关键变量</h2>
<ol type="1">
<li>密钥流：RC4算法的关键是根据明文和密钥生成相应的密钥流，密钥流的长度和明文的长度是对应的，也就是说明文的长度是500字节，那么密钥流也是500字节。当然，加密生成的密文也是500字节，因为密文第i字节=明文第
i 字节 ^ 密钥流第 i 字节；</li>
<li>状态向量S：长度为256，S[0],S[1].....S[255]。每个单元都是一个字节，算法运行的任何时候，S都包括0-255的8比特数的排列组合，只不过值的位置发生了变换；</li>
<li>临时向量T：长度也为256，每个单元也是一个字节。如果密钥的长度是256字节，就直接把密钥的值赋给T，否则，轮转地将密钥的每个字节赋给T；</li>
<li>密钥K：长度为1-256字节，注意密钥的长度与明文长度、密钥流的长度没有必然关系，通常密钥的长度趣味16字节（128比特）。</li>
</ol>
<h2 id="算法描述">算法描述</h2>
<ol type="1">
<li><p>初始化状态向量S</p>
<p>给S的元素依次初始化0~255</p></li>
<li><p>初始化临时向量T</p>
<p>若密钥K长度小于256字节，则进行轮转填充状态向量T</p></li>
<li><p>对状态向量S进行置换操作</p>
<p>按照以下规则打乱状态向量S</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">j = 0;</span><br><span class="line">for (i = 0; i &lt; 256; i++)</span><br><span class="line">&#123;</span><br><span class="line">    j = (j + S[i] + T[i]) mod 256;</span><br><span class="line">    swap(S[i], S[j]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>处理后，状态向量S几乎带有一定的随机性</p></li>
<li><p>密钥流的生成</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">i, j = 0;</span><br><span class="line">for (r = 0; r &lt; dataLength; r++)</span><br><span class="line">&#123;</span><br><span class="line">	i = (i + 1) mod 256;</span><br><span class="line">	j = (j + S[i]) mod 256;</span><br><span class="line">	swap(S[i], S[j]);</span><br><span class="line">	t = (S[i] + S[j]) mod 256;</span><br><span class="line">	z[r] = S[t]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中 z[r] 为每一位的密钥流</p></li>
<li><p>加解密</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for (i = 0; i &lt; dataLength; i++)</span><br><span class="line">&#123;</span><br><span class="line">	data[i] ^= z[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="c-实现">C++ 实现</h1>
<p>其中 S 必须为 <code>char S[256]</code></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_init</span><span class="params">(<span class="keyword">char</span>* S, <span class="keyword">char</span>* K, <span class="keyword">size_t</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> T[<span class="number">256</span>];</span><br><span class="line">	<span class="keyword">size_t</span> i, j;</span><br><span class="line">	<span class="keyword">char</span> t;</span><br><span class="line">	<span class="comment">// 初始化状态向量S与临时向量T</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		S[i] = i;</span><br><span class="line">		T[i] = K[i % len];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 对状态向量S进行置换操作</span></span><br><span class="line">	j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		j = (j + T[i] + S[i]) % <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// swap(S[i], S[j]);</span></span><br><span class="line">		t = S[i];</span><br><span class="line">		S[i] = S[j];</span><br><span class="line">		S[j] = t;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4</span><span class="params">(<span class="keyword">char</span>* S, <span class="keyword">char</span>* data, <span class="keyword">size_t</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">size_t</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> t;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> r = <span class="number">0</span>; r &lt; len; r++)</span><br><span class="line">	&#123;</span><br><span class="line">		i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">		j = (j + S[i]) % <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// swap(S[i], S[j]);</span></span><br><span class="line">		t = S[i];</span><br><span class="line">		S[i] = S[j];</span><br><span class="line">		S[j] = t;</span><br><span class="line"></span><br><span class="line">		t = (S[i] + S[j]) % <span class="number">256</span>;</span><br><span class="line">		data[r] ^= t;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="python-实现">Python 实现</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"></span><br><span class="line">data = <span class="string">&quot;mg6CITV6GEaFDTYnObFmENOAVjKcQmGncF90WhqvCFyhhsyqq1s=&quot;</span></span><br><span class="line">key = <span class="string">&quot;carol&quot;</span></span><br><span class="line"></span><br><span class="line">rc4 = ARC4.new(key.encode())</span><br><span class="line">res = rc4.decrypt(base64.b64decode(data))</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>crypto</tag>
        <tag>rc4</tag>
      </tags>
  </entry>
  <entry>
    <title>RSA 笔记</title>
    <url>//rsa-note.html</url>
    <content><![CDATA[<h1 id="rsa-算法描述">RSA 算法描述</h1>
<ol type="1">
<li><p>任意选取两个不同的大素数<span class="math inline">\(p\)</span>和<span class="math inline">\(q\)</span>计算乘积<span class="math inline">\(n=pq\)</span>，使用欧拉函数得到<span class="math inline">\(\varphi (n)=(p-1)(q-1)\)</span></p></li>
<li><p>任意选取一个大整数<span class="math inline">\(e\)</span>，满足<span class="math inline">\(gcd(e,
\varphi (n))=1\)</span>，整数<span class="math inline">\(e\)</span>用作加密密钥</p></li>
<li><p>确定的解密密钥<span class="math inline">\(d\)</span>，满足<span class="math inline">\((de)\ mod\ \varphi (n)=1\)</span>，即<span class="math inline">\(de=k\varphi (n)+1\)</span>，<span class="math inline">\(k\geq1\)</span>是一个任意的整数 (求逆元)</p></li>
<li><p>公开整数<span class="math inline">\(n\)</span>和<span class="math inline">\(e\)</span>，秘密保存<span class="math inline">\(d\)</span></p></li>
<li><p>将明文<span class="math inline">\(m\)</span>加密成密文<span class="math inline">\(c\)</span>，加密算法为： <span class="math display">\[
c=E(m)=m^e\ mod\ n
\]</span></p></li>
<li><p>将密文<span class="math inline">\(c\)</span>解密为明文<span class="math inline">\(m\)</span>，解密算法为： <span class="math display">\[
m=D(c)=c^d\ mod\ n
\]</span></p></li>
</ol>
<h1 id="rsa-必要算法">RSA 必要算法</h1>
<h2 id="拓展欧几里得算法">拓展欧几里得算法</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extendedGCD</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="comment"># a*xi + b*yi = ri</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x, y, q = extendedGCD(b, a % b)</span><br><span class="line">        <span class="comment"># q = gcd(a, b) = gcd(b, a%b)</span></span><br><span class="line">        x, y = y, (x - (a // b) * y)</span><br><span class="line">        <span class="keyword">return</span> x, y, q</span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以使用 <code>gmpy2.gcdext(a, b)</code> 替代，返回三元元组 <span class="math inline">\((g,s,t)\)</span></p>
<p>其中<span class="math inline">\(g=\gcd(a, b)=sa+tb\)</span></p>
</blockquote>
<h2 id="求逆元">求逆元</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invert</span>(<span class="params">e, phi</span>):</span></span><br><span class="line">    (x, y, r) = extendedGCD(e, phi)</span><br><span class="line">    <span class="comment"># y maybe &lt; 0, so convert it</span></span><br><span class="line">    <span class="keyword">if</span> y &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> phi + y</span><br><span class="line">    <span class="keyword">return</span> y</span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以使用 <code>gmpy2.invert(e, phi)</code> 替代</p>
</blockquote>
<h2 id="快速幂">快速幂</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fastExpMod</span>(<span class="params">b,e,c</span>):</span></span><br><span class="line">    result = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> e != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> (e &amp; <span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">            result = (result * b) % c</span><br><span class="line">        e &gt;&gt;= <span class="number">1</span></span><br><span class="line">        b = (b * b) % c</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以直接使用 python 自带的 <code>pow(b, e, c)</code></p>
</blockquote>
<h2 id="数论模运算">数论模运算</h2>
<h3 id="除法">除法</h3>
<p><span class="math display">\[
c=m\times a\ mod\ n\\
\]</span></p>
<p>对于上式，已知<span class="math inline">\(c,a,n\)</span>求<span class="math inline">\(m\)</span>，不能直接求<span class="math inline">\(c\div a\)</span>，需要将其转换为 <span class="math display">\[
m=c\times invert(a,n)\ mod\ n
\]</span> 即<span class="math inline">\(c\)</span>乘以<span class="math inline">\(a\)</span>对<span class="math inline">\(n\)</span>的逆元</p>
<h3 id="负数次幂">负数次幂</h3>
<p>若要求 <span class="math display">\[
k=c^s\ mod\ n
\]</span> 其中<span class="math inline">\(s&lt;0\)</span>，则需要将其转换为 <span class="math display">\[
k=invert(c, n)^{-s}
\]</span> 即<span class="math inline">\(c\)</span>对<span class="math inline">\(n\)</span>的模反元素的<span class="math inline">\(-s\)</span>次幂</p>
<h2 id="欧拉函数">欧拉函数</h2>
<ul>
<li><p>如果<span class="math inline">\(p\)</span>是素数且<span class="math inline">\(k\geq 1\)</span>，则 <span class="math display">\[
\phi (p^k)=p^k-p^{k-1}
\]</span> 特别地，当<span class="math inline">\(k=1\)</span>时，表达式即为 <span class="math display">\[
\phi (p)=p-1
\]</span></p></li>
<li><p>如果<span class="math inline">\(gcd(m, n)=1\)</span>，即<span class="math inline">\(m,n\)</span>互质，则 <span class="math display">\[
\phi (mn)=\phi (m)\phi (n)
\]</span></p></li>
</ul>
<h2 id="中国剩余定理">中国剩余定理</h2>
<p>设<span class="math inline">\(m\)</span>与<span class="math inline">\(n\)</span>是整数，<span class="math inline">\(gcd(m,n)=1\)</span>，<span class="math inline">\(b\)</span>与<span class="math inline">\(c\)</span>是任意整数，则同余式组 <span class="math display">\[
x\equiv b\ (mod\ m)\ 与\ x\equiv c\ (mod\ n)
\]</span> 恰有一个解 <span class="math inline">\(0\leq x\leq
mn\)</span></p>
<p>详细内容可以在<a href="/CRT-note.html">这里</a>了解</p>
<h1 id="rsapython-实现">RSA&amp;python 实现</h1>
<h2 id="加密">加密</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p=<span class="number">447685307</span></span><br><span class="line">q=<span class="number">2037</span></span><br><span class="line">e=<span class="number">17</span></span><br><span class="line">m = <span class="number">904332399012</span></span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br></pre></td></tr></table></figure>
<h2 id="解密">解密</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">447685307</span></span><br><span class="line">q=<span class="number">2037</span></span><br><span class="line">e=<span class="number">17</span></span><br><span class="line">c=<span class="number">704796792</span></span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br></pre></td></tr></table></figure>
<h2 id="读取参数">读取参数</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./tmp/pubkey.pem&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.importKey(f)</span><br><span class="line">    N = key.n</span><br><span class="line">    e = key.e  </span><br></pre></td></tr></table></figure>
<h1 id="rsa-攻击">RSA 攻击</h1>
<h2 id="分解模数n">分解模数N</h2>
<ol type="1">
<li><p>(推荐) 使用在线网站 http://www.factordb.com/index.php
查询素数分解</p></li>
<li><p>使用 yafu 工具本地分解质因数：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; ./yafu64.exe</span><br><span class="line">factor(911934970359)</span><br></pre></td></tr></table></figure>
<p>回显为：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fac: factoring 911934970359</span><br><span class="line">fac: using pretesting plan: normal</span><br><span class="line">fac: no tune info: using qs/gnfs crossover of 95 digits</span><br><span class="line">div: primes less than 10000</span><br><span class="line">fmt: 1000000 iterations</span><br><span class="line">Total factoring time = 0.0080 seconds</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">***factors found***</span><br><span class="line"></span><br><span class="line">P1 = 3</span><br><span class="line">P1 = 7</span><br><span class="line">P2 = 97</span><br><span class="line">P9 = 447685307</span><br><span class="line"></span><br><span class="line">ans = 1</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="共模数攻击">共模数攻击</h2>
<h3 id="特征">特征</h3>
<p>若干次加密，e不同，N相同，m相同。</p>
<h3 id="原理">原理</h3>
<p>由于使用公钥对 <span class="math inline">\((N,e_1)\)</span>与<span class="math inline">\((N,e_2)\)</span> 加密明文<span class="math inline">\(m\)</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c1 = <span class="built_in">pow</span>(m, e1, N)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m, e2, N)</span><br></pre></td></tr></table></figure>
<p>故使用私钥对 <span class="math inline">\((N,d_1)\)</span>与<span class="math inline">\((N,d_2)\)</span> 可以得到相同明文<span class="math inline">\(m\)</span></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">m = pow(c1, d1, N)</span><br><span class="line">m = pow(c2, d2, N)</span><br></pre></td></tr></table></figure>
<p>这时我们只需已知<span class="math inline">\(c_1,c_2,e_1,e_2,N\)</span>则可以绕过<span class="math inline">\(d_1,d_2\)</span>直接恢复明文<span class="math inline">\(m\)</span></p>
<p>信息安全数学基础证明如下：</p>
<p>假设公钥共模且互素，则有 <span class="math display">\[
\gcd(e_1,e_2)=1
\]</span> 即 <span class="math display">\[
e_1x+e_2y=1
\]</span> 其中<span class="math inline">\(x,y\)</span>皆为整数，一正一负。</p>
<p>利用扩展欧几里得算法可以求得解<span class="math inline">\((x,y)\)</span>，在这里不妨设<span class="math inline">\(x\)</span>为正，<span class="math inline">\(y\)</span>为负，利用模运算性质得 <span class="math display">\[
c_1^xc_2^y(mod\ n)=m^{e_1x}m^{e_2y}=m^{e_1x+e_2y}=m\ (mod\ n)
\]</span></p>
<h3 id="实现">实现</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">158052722013789461456896900244510199169216575693048895162538548356466884311543740968048825149608833390255268602486435690724338965409521812963337715301197225841194835534751041470231293288252951274190599189716955573428884560130364021535005115652592074445852835422027406556727605302404510264249211145063332337043</span></span><br><span class="line">e = [<span class="number">665213</span>, <span class="number">368273</span>]</span><br><span class="line">c = [<span class="number">16698617641888248664694980135332125531792692516788088682722832061393117609508765284473236240256421599515450690670639565968165473479697383505401285976148490839526672808730165847471005704945978274496508928460578173068717106075169723401049489389383596761956301440156581021583368058047939083755488885694261340425</span>, <span class="number">59192887933967939708054321952273893559113509451228797382728687616356609407020086787061368452871936378934964292805289941535766263083244529814852043063188312786173717046316177403357053871483983775362121186037776932260378728059531236711960979620603784044468207000654149190295060179235411429700710154759043236436</span>]</span><br><span class="line">s = gmpy2.gcdext(e[<span class="number">0</span>], e[<span class="number">1</span>])</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"><span class="comment"># 求模反元素</span></span><br><span class="line"><span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">    s1 = -s1</span><br><span class="line">    c[<span class="number">0</span>] = gmpy2.invert(c[<span class="number">0</span>], n)</span><br><span class="line"><span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">    s2 = -s2</span><br><span class="line">    c[<span class="number">1</span>] = gmpy2.invert(c[<span class="number">1</span>], n)</span><br><span class="line">m = <span class="built_in">pow</span>(c[<span class="number">0</span>], s1, n) * <span class="built_in">pow</span>(c[<span class="number">1</span>], s2, n) % n</span><br></pre></td></tr></table></figure>
<p>还有一种简便解法</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">0xa6241c28743fbbe4f2f67cee7121497f622fd81947af30f327fb028445b39c2d517ba7fdcb5f6ac9e6217205f8ec9576bdec7a0faef221c29291c784eed393cd95eb0d358d2a1a35dbff05d6fa0cc597f672dcfbeecbb14bd1462cb6ba4f465f30f22e595c36e6282c3e426831d30f0479ee18b870ab658a54571774d25d6875</span></span><br><span class="line">e1 = <span class="number">0x3045</span></span><br><span class="line">e2 = <span class="number">0xff4d</span></span><br><span class="line">c1 = <span class="number">0x5d1e39bc751108ec0a1397d79e63c013d238915d13380ae649e84d7d85ebcffbbc35ebb18d2218ccbc5409290dfa8a4847e5923c3420e83b1a9d7aa67190dc0d34711cce261665c64c28ed2834394d4b181926febf7eb685f9ce81f36c7fb72798da3a14a123287171d26e084948aab0fba81c53f10b5696fc291006254ee690</span></span><br><span class="line">c2 = <span class="number">0x3d90f2bec4fe02d8ce4cece3ddb6baed99337f7e6856eef255445741b5cfe378390f058679d70236e51be4746db4c207f274c40b092e24f8c155a0957867e84dca48e27980af488d2615a280c6eadec2f1d30b95653b1ee3135e2edff100dd2c529994f846722f811348b082d0bec7cfab579a4bd0ab789928b1bebed68d628f</span></span><br><span class="line">g, r, s = gcdext(e1, e2)</span><br><span class="line">m = <span class="built_in">pow</span>(c1, r, n) * <span class="built_in">pow</span>(c2, s, n) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<h2 id="公约数攻击">公约数攻击</h2>
<h3 id="特征-1">特征</h3>
<p>多个n，均不相同，并且都是2048bit，4096bit级别，无法正面硬杠，并且明文都没什么联系，e也一般取65537。</p>
<h3 id="原理-1">原理</h3>
<p>使用公约数求出共同的素数因子</p>
<h3 id="实现-1">实现</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n1 = <span class="number">9051013965404084482870087864821455535159008696042953021965631089095795348830954383127323853272528967729311045179605407693592665683311660581204886571146327720288455874927281128121117323579691204792399913106627543274457036172455814805715668293705603675386878220947722186914112990452722174363713630297685159669328951520891938403452797650685849523658191947411429068829734053745180460758604283051344339641429819373112365211739216160420494167071996438506850526168389386850499796102003625404245645796271690310748804327</span></span><br><span class="line">n2 = <span class="number">13225948396179603816062046418717214792668512413625091569997524364243995991961018894150059207824093837420451375240550310050209398964506318518991620142575926623780411532257230701985821629425722030608722035570690474171259238153947095310303522831971664666067542649034461621725656234869005501293423975184701929729170077280251436216167293058560030089006140224375425679571181787206982712477261432579537981278055755344573767076951793312062480275004564657590263719816033564139497109942073701755011873153205366238585665743</span></span><br><span class="line">p = gmpy2.gcd(n1, n2)</span><br><span class="line">q1 = n1 / p</span><br><span class="line">q2 = n2 / p</span><br></pre></td></tr></table></figure>
<h2 id="低加密指数攻击">低加密指数攻击</h2>
<h3 id="特征-2">特征</h3>
<p><span class="math inline">\(e\)</span>和<span class="math inline">\(m\)</span>都特小，例如<span class="math inline">\(e=3\)</span></p>
<h3 id="原理-2">原理</h3>
<p>在 RSA 中 e 也称为加密指数。</p>
<p>由于 e 是可以随意选取的，选取小一点的 e
可以缩短加密时间，但是选取不当的话，就会造成安全问题。</p>
<p>若<span class="math inline">\(m^3&lt;n\)</span>，即<span class="math inline">\(c=m^3\)</span></p>
<p>若<span class="math inline">\(m^3&gt;n\)</span>但并非<span class="math inline">\(m^3\gg n\)</span>，即<span class="math inline">\(c=(m^3+i*n)\ mod\ n\)</span>，其中<span class="math inline">\(i\)</span>是我们需要爆破的系数</p>
<h3 id="实现-2">实现</h3>
<ul>
<li><p>若<span class="math inline">\(m^3&lt;n\)</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n= <span class="number">22885480907469109159947272333565375109310485067211461543881386718201442106967914852474989176175269612229966461160065872310916096148216253429849921988412342732706875998100337754561586600637594798877898552625378551427864501926224989873772743227733285336042475675299391051376624685754547818835551263597996620383338263448888107691240136257201191331617560711786674975909597833383395574686942099700631002290836152972352041024137872983284691831292216787307841877839674258086005814225532597955826353796634417780156185485054141684249037538570742860026295194559710972266059844824388916869414355952432189722465103299013237588737</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c= <span class="number">15685364647213619014219110070569189770745535885901269792039052046431067708991036961644224230125219358149236447900927116989931929305133870392430610563331490276096858863490412102016758082433435355613099047001069687409209484751075897343335693872741</span></span><br><span class="line">m, flag = gmpy2.iroot(c, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;m=<span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;could not decode m&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>若<span class="math inline">\(m^3&gt;n\)</span>但并非<span class="math inline">\(m^3\gg n\)</span> (这里需要跑比较久)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">114976915747243387792157708464120735018971336213935438953074748276198282761939060395482051056351068439137722626185590043024556656813730840050547350912425438364703854627760482842307943026011880815011654341047422453012558617703411700393668892701036222135444420377515575624398723436532681305293727164639582093389</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">5828813410620741112500628876643872258919868379601617907887884191584237969605489971465692568848339200057188383649365078832766143513766368216471491824042974016773526107276856706832404477882581400769791378958901067683158857990261489285951805740071223765359992165262854641069674603160977034446644199945940251030</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">i = gmpy2.iroot(c, <span class="number">3</span>)[<span class="number">0</span>] // n</span><br><span class="line"><span class="built_in">print</span>(i)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    m, flag = gmpy2.iroot(c + i * n, <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;m=<span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    i += <span class="number">1</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="e1-攻击"><span class="math inline">\(e=1\)</span> 攻击</h2>
<h3 id="实现-3">实现</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">0x180be86dc898a3c3a710e52b31de460f8f350610bf63e6b2203c08fddad44601d96eb454a34dab7684589bc32b19eb27cffff8c07179e349ddb62898ae896f8c681796052ae1598bd41f35491175c9b60ae2260d0d4ebac05b4b6f2677a7609c2fe6194fe7b63841cec632e3a2f55d0cb09df08eacea34394ad473577dea5131552b0b30efac31c59087bfe603d2b13bed7d14967bfd489157aa01b14b4e1bd08d9b92ec0c319aeb8fedd535c56770aac95247d116d59cae2f99c3b51f43093fd39c10f93830c1ece75ee37e5fcdc5b174052eccadcadeda2f1b3a4a87184041d5c1a6a0b2eeaa3c3a1227bc27e130e67ac397b375ffe7c873e9b1c649812edcd</span></span><br><span class="line">e = <span class="number">0x1</span></span><br><span class="line">c = <span class="number">0x4963654354467b66616c6c735f61706172745f736f5f656173696c795f616e645f7265617373656d626c65645f736f5f63727564656c797d</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="comment"># i 可以取很多</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">10</span>:</span><br><span class="line">    m = c + i * n</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">    i += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h2 id="低加密指数广播攻击">低加密指数广播攻击</h2>
<h3 id="特征-3">特征</h3>
<p>三组加密的参数和明密文，其中题目很明确地能告诉你这三组的明文都是一样的，并且e都取了一个较小的数字。</p>
<h3 id="原理-3">原理</h3>
<p>如果选取的加密指数较低，并且使用了相同的加密指数给一个接受者的群发送相同的信息，那么可以进行广播攻击得到明文。</p>
<p>例如当<span class="math inline">\(e=3\)</span>时，有以下等式成立：
<span class="math display">\[
c_1=pow(m,e,n_1)\\
c_2=pow(m,e,n_2)\\
c_3=pow(m,e,n_3)\\
\cdots
\]</span> 对上列等式运用中国剩余定理，得到 <span class="math display">\[
c_x=pow(m,3,n_1*n_2*n_3)
\]</span></p>
<h3 id="实现-4">实现</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">clist, nlist</span>):</span></span><br><span class="line">    N = reduce(<span class="keyword">lambda</span> x, y: x * y, nlist)</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> c, n <span class="keyword">in</span> <span class="built_in">zip</span>(clist, nlist):</span><br><span class="line">        m = N // n</span><br><span class="line">        d, r, s = gmpy2.gcdext(n, m)</span><br><span class="line">        <span class="keyword">if</span> d != <span class="number">1</span>: <span class="keyword">raise</span> Exception(<span class="string">&quot;Input not pairwise co-prime&quot;</span>)</span><br><span class="line">        result += c * s * m</span><br><span class="line">    <span class="keyword">return</span> result % N, N</span><br><span class="line">e = <span class="number">9</span></span><br><span class="line">n = [<span class="number">142782424368849674771976671955176187834932417027468006479038058385550042422280158726561712259205616626939123504489410624745195777853423961104590708231562726165590769610040722589287393102301338152085670464005026301781192671834390892019478189768725018303217559795377795540494239283891894830166363576205812991157</span>, <span class="number">153610425077816156109768509904751446801233412970601397035720458311275245730833227428213917577405780162151444202393431444812010569489900435979730559895340377469612234558042643742219128033827948585534761030527275423811282367831985007507137144308704413007806012914286105842311420933479771294576841956749281552971</span>, <span class="number">152540067782701001222493009941492423063369171831039847414320547494725020441901272486665728360741395415762864872737675660423920609681185809510355937534756399208661762715484879562585724584849261266873624875852300611683382543315580370484972470694466195837255994159609193239840228218925381488410059939975556977947</span>, <span class="number">125842716702134814646356078531900645012495638692517778270527426844383063904041812273637776798591687732598509470005151551320457132061693618473039437320011446697406190781306264437609046721508738109650829547010385875425097336266103994639126319889016342284747700714199556143378526590058467791687837422897022829661</span>, <span class="number">116144389285266462769913139639175922392318396923181100785008570884082681963637784423143843845816350379438789947802939701820129805341796427821894273985551331666719808355412080909245720551238149511778060242720419584504473490216670437024863860559347959698828131475160058721701582089480924088773887932997353631767</span>, <span class="number">127833907448946785858374094953899556339175475846831397383049660262333005992005484987913355932559627279178940862787593749842796469355336182379062826441222705075178971785791223706944120681105575965622931327112817747065200324610697178273898956820957640413744954233327851461318200323486469677469950386824833536523</span>, <span class="number">130561613227079478921314550968562766645507834694262831586725464124109153306162445639759476845681271537955934718244296904503168256991962908095007040044300188572466395275317838178325500238288302672390013747102961340256309124310478931896245221622317302428447389760864327859640573452084295225059466376349115703119</span>, <span class="number">115953389401040751013569404909249958538962411171147823610874077094621794755967854844224923689925397631692572916641171075740839099217316101334941033937183815345038898177087515909675028366437302462022970987947264115373697445950951595479758872029099661065186221250394358255523574834723958546450323357472451930993</span>, <span class="number">143437107845384843564651522639125300763388830136500260725097766445883003928355325003575359566631064630487365774344508496878731109174874449170057678821440711511966073934025028100604234445470976333825866939923998344367645612128590820812489407412175198698290167077116185959180877334222693344630253253476594907313</span>]</span><br><span class="line">c = [<span class="number">85033868418784308573673709960700777350314426427677627319697346811123742342359072170220428874952996988431950989321281905284522596263957356289624365171732095210045916218066135140320107686084053271623461104022705353814233772164502775939590711842361956121603943483040254727995655776263673058788416722141673409688</span>, <span class="number">66065963470666895005407449599703926269325406456711861190876894466341571726360462706664546294453572319565476664348345756905411939632955966517708138047546806602828064213238537646393524578984547577761559965654539771172357089802682793169968961304179886652390277814477825753096636750388350662980872556701402397564</span>, <span class="number">116011740820520887443111656288411611070614127688662643257265381793048354928820176624229624692124188995846076431510548507016903260774215950803926107831505634778278712070141663189086436127990584944132764896694777031370995058271038329228336417590284517922855284619653301817355115583540545182119702335431334401666</span>, <span class="number">97640420284096094887471273365295984332267897927392169402918423863919914002451127544715668846623138003564829254309568918651163254043205129883843425179687841236818720463784828905460885026290909768599562386370732119591181513319548915478512030197629196018254041500662654260834562708620760373487652389789200792120</span>, <span class="number">8112507653841374573057048967617108909055624101437903775740427861003476480616929517639719198652146909660899632120639789106782550275648578142883715280547602249589837441805676364041484345030575130408744621981440093280624046635769338568542048839419939250444929802135605724150484414516536378791500915047844188300</span>, <span class="number">36792148360808115566234645242678223867680969786675055638670907933041180936164293809961667801099516457636164692292891528415720085345494773373966277807505798679784807614784581861287048096977968620964436947452527540958289441390882589051225367658014709290392321808926567572528170531844664734909469690750971883323</span>, <span class="number">53043093283305492238903255767698153246673671181809989362223466090875767705978690531154079519999671834688647277179370374802495005937892824566602423646978168777735383632928274082669949750078161820002768640908750005814934158829006019656592134357897586040866207754535586785064545866404380204728594863102313407789</span>, <span class="number">88499407133762624445946519155722583633934260410706930537441122463087556094734626189377091740335667052378955691250910459790202385799502439716173363179773811920751410726795431402796346647688144853156900427797933862087074385441977254140336390678022955770879265490567987868532251217565094093318626424653599450992</span>, <span class="number">138337520305048557335599940473834485492131424901034295018189264168040969172072024612859307499682986987325414798210700710891033749119834960687318156171051379643844580970963540418974136891389303624057726575516576726845229494107327508855516437230240365759885913142671816868762838801720492804671259709458388192984</span>]</span><br><span class="line">x, n = CRT(c, n)</span><br><span class="line">m, flag = gmpy2.iroot(x, e)</span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;m=<span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;could not decode m&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="低解密指数攻击-wiener-attack">低解密指数攻击 (Wiener
Attack)</h2>
<h3 id="特征-4">特征</h3>
<p><span class="math inline">\(e\)</span>特别大</p>
<h3 id="原理-4">原理</h3>
<p>与低加密指数相同，低解密指数可以加快解密的过程，但是也带来了安全问题。种基于连分数(一个数论当中的问题)的特殊攻击类型就可以危害
RSA 的安全。此时需要满足：<span class="math inline">\(q&lt;p&lt;2q\)</span>。如果满足上述条件，通过
Wiener Attack (维纳攻击) 可以在多项式时间中分解N。</p>
<h3 id="实现-5">实现</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">transform</span>(<span class="params">x, y</span>):</span>  <span class="comment"># 使用辗转相处将分数 x/y 转为连分数的形式</span></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        res.append(x//y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">continued_fraction</span>(<span class="params">sub_res</span>):</span></span><br><span class="line">    numerator, denominator = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> sub_res[::-<span class="number">1</span>]:  <span class="comment"># 从sublist的后面往前循环</span></span><br><span class="line">        denominator, numerator = numerator, i*numerator+denominator</span><br><span class="line">    <span class="keyword">return</span> denominator, numerator  <span class="comment"># 得到渐进分数的分母和分子，并返回</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解每个渐进分数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub_fraction</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    res = transform(x, y)</span><br><span class="line">    <span class="comment"># 将连分数的结果逐一截取以求渐进分数</span></span><br><span class="line">    res = <span class="built_in">list</span>(<span class="built_in">map</span>(continued_fraction, (res[<span class="number">0</span>:i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(res)))))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_pq</span>(<span class="params">a, b, c</span>):</span>  <span class="comment"># 由p+q和pq的值通过维达定理来求解p和q</span></span><br><span class="line">    par = gmpy2.isqrt(b*b-<span class="number">4</span>*a*c)  <span class="comment"># 由上述可得，开根号一定是整数，因为有解</span></span><br><span class="line">    x1, x2 = (-b+par)//(<span class="number">2</span>*a), (-b-par)//(<span class="number">2</span>*a)</span><br><span class="line">    <span class="keyword">return</span> x1, x2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wienerAttack</span>(<span class="params">e, n</span>):</span></span><br><span class="line">    <span class="keyword">for</span> (d, k) <span class="keyword">in</span> sub_fraction(e, n):  <span class="comment"># 用一个for循环来注意试探e/n的连续函数的渐进分数，直到找到一个满足条件的渐进分数</span></span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>:  <span class="comment"># 可能会出现连分数的第一个为0的情况，排除</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e*d-<span class="number">1</span>) % k != <span class="number">0</span>:  <span class="comment"># ed=1 (mod φ(n)) 因此如果找到了d的话，(ed-1)会整除φ(n),也就是存在k使得(e*d-1)//k=φ(n)</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        phi = (e*d-<span class="number">1</span>)//k  <span class="comment"># 这个结果就是 φ(n)</span></span><br><span class="line">        px, qy = get_pq(<span class="number">1</span>, n-phi+<span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> px*qy == n:</span><br><span class="line">            p, q = <span class="built_in">abs</span>(<span class="built_in">int</span>(px)), <span class="built_in">abs</span>(<span class="built_in">int</span>(qy))  <span class="comment"># 可能会得到两个负数，负负得正未尝不会出现</span></span><br><span class="line">            <span class="comment"># 求ed=1 (mod  φ(n))的结果，也就是e关于 φ(n)的乘法逆元d</span></span><br><span class="line">            d = gmpy2.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;该方法不适用&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">507419170088344932990702256911694788408493968749527614421614568612944144764889717229444020813658893362983714454159980719026366361318789415279417172858536381938870379267670180128174798344744371725609827872339512302232610590888649555446972990419313445687852636305518801236132032618350847705234643521557851434711389664130274468354405273873218264222293858509477860634889001898462547712800153111774564939279190835857445378261920532206352364005840238252284065587291779196975457288580812526597185332036342330147250312262816994625317482869849388424397437470502449815132000588425028055964432298176942124697105509057090546600330760364385753313923003549670107599757996810939165300581847068233156887269181096893089415302163770884312255957584660964506028002922164767453287973102961910781312351686488047510932997937700597992705557881172640175117476017503918294534205898046483981707558521558992058512940087192655700351675718815723840568640509355338482631416345193176708501897458649841539192993142790402734898948352382350766125000186026261167277014748183012844440603384989647664190074853086693408529737767147592432979469020671772152652865219092597717869942730499507426269170189547020660681363276871874469322437194397171763927907099922324375991793759</span></span><br><span class="line">e = <span class="number">77310199867448677782081572109343472783781135641712597643597122591443011229091533516758925238949755491395489408922437493670252550920826641442189683907973926843505436730014899918587477913032286153545247063493885982941194996251799882984145155733050069564485120660716110828110738784644223519725613280140006783618393995138076030616463398284819550627612102010214315235269945251741407899692274978642663650687157736417831290404871181902463904311095448368498432147292938825418930527188720696497596867575843476810225152659244529481480993843168383016583068747733118703000287423374094051895724494193455175131120243097065270804457787026492578916584536863548445813916819417857064037664101684455000184987531252344582899589746272173970083733130106407810619258077266603898529285634495710846838011858287024329514491058790557305041389614650730267774482954666726949886313386881066593946789460028399523245777171320319444673551268379126203862576627540177888290265714418064334752499940587750374552330008143708562065940245637685833371348603338834447212248648869514585047871442060412622164276894766238383894693759347590977926306581080390685360615407766600573527565016914830132066428454738135380178959590692145577418811677639050929791996313180297924833690095</span></span><br><span class="line">c = <span class="number">165251729917394529793163344300848992394021337429474789711805041655116845722480301677817165053253655027459227404782607373107477419083333844871948673626672704233977397989843349633720167495862807995411682262559392496273163155214888276398332204954185252030616473235814999366132031184631541209554169938146205402400412307638567132128690379079483633171535375278689326189057930259534983374296873110199636558962144635514392282351103900375366360933088605794654279480277782805401749872568584335215630740265944133347038070337891035560658434763924576508969938866566235926587685108811154229747423410476421860059769485356567301897413767088823807510568561254627099309752215808220067495561412081320541540679503218232020279947159175547517811501280846596226165148013762293861131544331444165070186672186027410082671602892508739473724143698396105392623164025712124329254933353509384748403154342322725203183050328143736631333990445537119855865348221215277608372952942702104088940952142851523651639574409075484106857403651453121036577767672430612728022444370874223001778580387635197325043524719396707713385963432915855227152371800527536048555551237729690663544828830627192867570345853910196397851763591543484023134551876591248557980182981967782409054277224</span></span><br><span class="line">d = wienerAttack(e, n)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>也可以使用 https://github.com/pablocelayes/rsa-wiener-attack
的脚本</p>
</blockquote>
<h2 id="dpdq-泄露"><span class="math inline">\(dp\&amp;dq\)</span>
泄露</h2>
<h3 id="特征-5">特征</h3>
<p>题目仅给出<span class="math inline">\(p,q,dp,dq,c\)</span>，不给公钥<span class="math inline">\(e\)</span></p>
<h3 id="实现-6">实现</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec</span>(<span class="params">dp, dq, p, q, c</span>):</span></span><br><span class="line">    InvQ = gmpy2.invert(q,p)</span><br><span class="line">    mp = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">    mq = <span class="built_in">pow</span>(c,dq,q)</span><br><span class="line">    m = (((mp - mq) * InvQ) % p) * q + mq</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">p=<span class="number">0xf85d730bbf09033a75379e58a8465f8048b8516f8105ce2879ce774241305b6eb4ea506b61eb7e376d4fcd425c76e80cb748ebfaf3a852b5cf3119f028cc5971</span></span><br><span class="line">q=<span class="number">0xc1f34b4f826f91c5d68c5751c9af830bc770467a68699991be6e847c29c13170110ccd5e855710950abab2694b6ac730141152758acbeca0c5a51889cbe84d57</span></span><br><span class="line">dp=<span class="number">0xf7b885a246a59fa1b3fe88a2971cb1ee8b19c4a7f9c1a791b9845471320220803854a967a1a03820e297c0fc1aabc2e1c40228d50228766ebebc93c97577f511</span></span><br><span class="line">dq=<span class="number">0x865fe807b8595067ff93d053cc269be6a75134a34e800b741cba39744501a31cffd31cdea6078267a0bd652aeaa39a49c73d9121fafdfa7e1131a764a12fdb95</span></span><br><span class="line">c=<span class="number">0xae05e0c34e2ba4ca3536987cc2cfc3f1f7f53190164d0ac50b44832f0e7224c6fdeebd2c91e3991e7d179c26b1b997295dc9724925ba431f527fba212703a0d14a34ce133661ae0b6001ee326303d6ccdc27dbd94e0987fae25a84f197c1535bdac9094bfb3846b7ca696b2e5082bea7bff804da275772ca05dd51b185a4fc30</span></span><br><span class="line"></span><br><span class="line">m = dec(dp,dq,p,q,c)</span><br></pre></td></tr></table></figure>
<h2 id="dp-泄露"><span class="math inline">\(dp\)</span> 泄露</h2>
<h3 id="实现-7">实现</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> (dp * e - <span class="number">1</span>) % i == <span class="number">0</span> <span class="keyword">and</span> n % (((dp * e - <span class="number">1</span>) // i) + <span class="number">1</span>) == <span class="number">0</span>:</span><br><span class="line">        p = ((dp * e - <span class="number">1</span>) // i) + <span class="number">1</span></span><br><span class="line">        q = n // (((dp * e - <span class="number">1</span>) // i) + <span class="number">1</span>)</span><br><span class="line">        phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">        d = gmpy2.invert(e, phi)</span><br><span class="line">        m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c, d, n))</span><br></pre></td></tr></table></figure>
<h2 id="e与varphin-不互素"><span class="math inline">\(e\)</span>与<span class="math inline">\(\varphi(n)\)</span> 不互素</h2>
<h3 id="原理-5">原理</h3>
<p>已知<span class="math inline">\(c_1,c_2,p,q_1,q_2,n_1=pq_1,n_2=pq_2,e\)</span>，则有
<span class="math display">\[
k=\gcd(e,\varphi(n))\\
c_1=m^{k\frac{e_1}{k}}mod\ n_1\\
c_2=m^{k\frac{e_2}{k}}mod\ n_2\\
\]</span> 则 <span class="math display">\[
m^k=c_1^{d_1}mod\ n_1\\
m^k=c_2^{d_2}mod\ n_2
\]</span> 即 <span class="math display">\[
\begin{cases}
m^k=c_1^{d_1}mod\ p\\
m^k=c_2^{d_2}mod\ p\\
m^k=c_1^{d_1}mod\ q_1\\
m^k=c_2^{d_2}mod\ q_2
\end{cases}
\]</span> 合并后，利用中国剩余定理求特解： <span class="math display">\[
last=CRT((c_1^{d_1},c_2^{d_2}),(q_1,q_2))
\]</span> 其中假设<span class="math inline">\(k=ab,b与\varphi(q_1q_2)互素\)</span>，则有 <span class="math display">\[
d=invert(b,\varphi(q_1q_2))\\
m^{ab}=kq_1q_2+last
\]</span></p>
<h2 id="简单填充攻击">简单填充攻击</h2>
<h3 id="题目描述">题目描述</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> x + <span class="string">b&quot;\x00&quot;</span> * (<span class="number">128</span> - <span class="built_in">len</span>(x))</span><br><span class="line"></span><br><span class="line">flag = flag[<span class="number">7</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">16</span></span><br><span class="line"></span><br><span class="line">flag = pad(flag)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>, file=f)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>, file=f)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>, file=f)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>n =
20143874513891625472763023083725333814544365923300648765753585512236262936134576226420495156390118451084859695988018681103828733472481714477702312584392200607513775527941225389450524064860609500522646820403150136601325693755011504371254765148925814568051337093873243247759130508598378247848927825303243080348476280520682747234144016534355268883431
e = 65537 c =
9099248209700870107517981697995437593126643973286742880366239649474438147247165218637687381898125380392681666447352387825995403531162271411514111581358141144178855022212666392579294107956774766000410956462804204065293225382573948622209661112442721208408763210528401826636309622296148093801229149917160087959002855064445785159864465696643561701308</p>
</blockquote>
<h3 id="实现-8">实现</h3>
<p>当实际明文<span class="math inline">\(m&lt;p\)</span>时可以恢复</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd, invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line"><span class="comment"># 仅在p域下</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec</span>(<span class="params">n, e, phi, c</span>):</span></span><br><span class="line">    d = invert(e, phi)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    p = <span class="number">297342668339361548416629796745639177971</span></span><br><span class="line">    q = <span class="number">67746329937757624632404631102047546126139910162127525807142364896504844830533422758326696949629668349819199912570222748973935637740283799230746144014458722401719184655996325043824137789180083286215748548298177270209171461643103260188864468982281090005047122016817287399362453731379535534001682626445843123261</span></span><br><span class="line"></span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    c = <span class="number">9099248209700870107517981697995437593126643973286742880366239649474438147247165218637687381898125380392681666447352387825995403531162271411514111581358141144178855022212666392579294107956774766000410956462804204065293225382573948622209661112442721208408763210528401826636309622296148093801229149917160087959002855064445785159864465696643561701308</span></span><br><span class="line"></span><br><span class="line">    m = dec(n, e, p-<span class="number">1</span>, c)</span><br><span class="line">    t = <span class="number">256</span>**<span class="number">112</span></span><br><span class="line">    t = invert(t, p)</span><br><span class="line">    m = m*t % p</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure>
<h3 id="实现-9">实现</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">r,d</span>):</span></span><br><span class="line">    M = <span class="number">1</span></span><br><span class="line">    l = <span class="built_in">len</span>(r)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,l):</span><br><span class="line">        M = d[i] * M</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,l):</span><br><span class="line">        md = M//d[i]</span><br><span class="line">        x = (x + gmpy2.invert(md, d[i])  * md *r[i] )%M</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(M+x% M)%M</span><br><span class="line"></span><br><span class="line">p = <span class="number">109935857933867829728985398563235455481120300859311421762540858762721955038310117609456763338082237907005937380873151279351831600225270995344096532750271070807051984097524900957809427861441436796934012393707770012556604479065826879107677002380580866325868240270494148512743861326447181476633546419262340100453</span></span><br><span class="line"></span><br><span class="line">e1 = <span class="number">15218928658178</span></span><br><span class="line">q1=<span class="number">127587319253436643569312142058559706815497211661083866592534217079310497260365307426095661281103710042392775453866174657404985539066741684196020137840472950102380232067786400322600902938984916355631714439668326671310160916766472897536055371474076089779472372913037040153356437528808922911484049460342088834871</span></span><br><span class="line">c1 =  <span class="number">262739975753930281690942784321252339035906196846340713237510382364557685379543498765074448825799342194332681181129770046075018122033421983227887719610112028230603166527303021036386350781414447347150383783816869784006598225583375458609586450854602862569022571672049158809874763812834044257419199631217527367046624888837755311215081173386523806086783266198390289097231168172692326653657393522561741947951887577156666663584249108899327053951891486355179939770150550995812478327735917006194574412518819299303783243886962455399783601229227718787081785391010424030509937403600351414176138124705168002288620664809270046124</span></span><br><span class="line">n1 = p*q1</span><br><span class="line"></span><br><span class="line">e2 = <span class="number">381791429275130</span></span><br><span class="line">q2 =  <span class="number">114401188227479584680884046151299704656920536168767132916589182357583461053336386996123783294932566567773695426689447410311969456458574731187512974868297092638677515283584994416382872450167046416573472658841627690987228528798356894803559278308702635288537653192098514966089168123710854679638671424978221959513</span></span><br><span class="line">c2 =  <span class="number">7395591129228876649030819616685821899204832684995757724924450812977470787822266387122334722132760470911599176362617225218345404468270014548817267727669872896838106451520392806497466576907063295603746660003188440170919490157250829308173310715318925771643105064882620746171266499859049038016902162599261409050907140823352990750298239508355767238575709803167676810456559665476121149766947851911064706646506705397091626648713684511780456955453552020460909638016134124590438425738826828694773960514221910109473941451471431637903182205738738109429736425025621308300895473186381826756650667842656050416299166317372707709596</span></span><br><span class="line">n2 = p*q2</span><br><span class="line"></span><br><span class="line">phi1=(p-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">phi2=(p-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">xx1=gmpy2.gcd(e1,phi1) <span class="comment"># xx1=14</span></span><br><span class="line">xx2=gmpy2.gcd(e2,phi2) <span class="comment"># xx2=14</span></span><br><span class="line"></span><br><span class="line">d1=gmpy2.invert(e1//xx1,phi1)</span><br><span class="line">d2=gmpy2.invert(e2//xx2,phi2)</span><br><span class="line"></span><br><span class="line">nn=[]</span><br><span class="line">aa=[]</span><br><span class="line"></span><br><span class="line">nn.append(q1)</span><br><span class="line">nn.append(q2)</span><br><span class="line">a1=gmpy2.powmod(c1,d1,p*q1)%q1</span><br><span class="line">a2=gmpy2.powmod(c2,d2,p*q2)%q2</span><br><span class="line">aa.append(a1)</span><br><span class="line">aa.append(a2)</span><br><span class="line"></span><br><span class="line">last = CRT(aa,nn)</span><br><span class="line">new_e=<span class="number">7</span></span><br><span class="line">new_phi=(q1-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">new_d=gmpy2.invert(new_e,new_phi)</span><br><span class="line">m_2=gmpy2.powmod(last,new_d,q1*q2)</span><br><span class="line">m=gmpy2.iroot(m_2,<span class="number">2</span>)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<h2 id="rabin-攻击">Rabin 攻击</h2>
<h3 id="特征-6">特征</h3>
<p><span class="math inline">\(e=2\)</span></p>
<h3 id="原理-6">原理</h3>
<ul>
<li><p>计算出<span class="math inline">\(m_p\)</span>和<span class="math inline">\(m_q\)</span>： <span class="math display">\[
m_p=\sqrt{c}\ mod\ p
m_q=\sqrt{c}\ mod\ q
\]</span></p></li>
<li><p>利用扩展欧几里得算法计算出<span class="math inline">\(y_p\)</span>和<span class="math inline">\(y_q\)</span> <span class="math display">\[
y_p·p+y_q·q=1
\]</span></p></li>
<li><p>最后解得四个明文： <span class="math display">\[
a=(y_p·p·m_q+y_q·q·m_p)\ mod\ n\\
b=n-a\\
c=(y_p·p·m_q-y_q·q·m_p)\ mod\ n\\
d=n-c
\]</span></p></li>
<li><p>其中，如果<span class="math inline">\(p,q\)</span>是形为<span class="math inline">\(4k+3\)</span>的不同素数，即<span class="math inline">\(p\equiv q\equiv 3\ (mod\ 4)\)</span>，则 <span class="math display">\[
m_p=c^{\frac{1}{4}(p+1)}mod\ p
m_q=c^{\frac{1}{4}(q+1)}mod\ q
\]</span></p></li>
</ul>
<h3 id="实现-10">实现</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n=<span class="number">523798549</span></span><br><span class="line">p=<span class="number">10663</span></span><br><span class="line">q=<span class="number">49123</span></span><br><span class="line">e=<span class="number">2</span></span><br><span class="line">c=<span class="number">162853095</span></span><br><span class="line">a,inv_q ,inv_p= gmpy2.gcdext(q,p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">a = (inv_p * p * mq + inv_q * q * mp) % n</span><br><span class="line">b = n - <span class="built_in">int</span>(a)</span><br><span class="line">c = (inv_p * p * mq - inv_q * q * mp) % n</span><br><span class="line">d = n - <span class="built_in">int</span>(c)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span>(a, b, c, d):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure>
<h2 id="coppersmith-定理攻击">Coppersmith 定理攻击</h2>
<h3 id="原理-7">原理</h3>
<p>Coppersmith 定理指出在一个<span class="math inline">\(e\)</span>阶的<span class="math inline">\(mod\
n\)</span>多项式<span class="math inline">\(f(x)\)</span>中，如果有一个根小于<span class="math inline">\(n^\frac{1}{e}\)</span> ，就可以运用一个O(log
n)的算法求出这些根。</p>
<p>这个定理可以应用于 RSA 算法。如果<span class="math inline">\(e =
3\)</span>并且在明文当中只有三分之二的比特是已知的，这种算法可以求出明文中所有的比特。</p>
<h2 id="prime-power-rsa-using-two-decryption-exponents">Prime Power RSA
using Two Decryption Exponents</h2>
<h3 id="特征-7">特征</h3>
<ul>
<li><span class="math inline">\(N=p^rq\)</span></li>
<li><span class="math inline">\(d_1\)</span> 和 <span class="math inline">\(d_2\)</span> 大部分高位相同，即 <span class="math inline">\(|d_1-d_2|\)</span> 很小</li>
</ul>
<h3 id="原理-8">原理</h3>
<p>我们用到了以下定理：</p>
<ul>
<li><p><strong>定理一</strong></p>
<blockquote>
<p>设 <span class="math inline">\(N\)</span> 整除 <span class="math inline">\(p^u\)</span>，使得 <span class="math inline">\(p\geq N^\beta\ (0&lt;\beta\leq 1)\)</span></p>
<p>设 <span class="math inline">\(f(x,y)\in\Z[x,y]\)</span>
为齐次线性多项式</p>
<p>然后，如果 <span class="math inline">\(\gamma1+\gamma2&lt;uv\beta^2\)</span>，那么我们可以在多项式时间内找到方程
<span class="math inline">\(f(x,y)=0\mod{p^u},其中\gcd(x,y)=1,|x|&lt;N^{\gamma1},|y|&lt;N^{\gamma2}\)</span>
所有的解 <span class="math inline">\((x,y)\)</span></p>
</blockquote></li>
<li><p><strong>定理二</strong></p>
<blockquote>
<p>设模数 <span class="math inline">\(N=p^rq\)</span>，私钥 <span class="math inline">\((d_1,d_2)\)</span>，如果 <span class="math inline">\(|d_1-d_2|&lt;N^{\frac{r(r-1)}{(r+1)^2}}\)</span>，那么我们可以在多项式时间内对
<span class="math inline">\(N\)</span> 进行分解</p>
</blockquote></li>
</ul>
<p>证明如下：</p>
<p>假设 <span class="math inline">\(e_1d_1-k_1\phi(N)=1\)</span> 、<span class="math inline">\(e_2d_2-k_2\phi(N)=1\)</span> 且 <span class="math inline">\(e_1&gt;e_2\)</span></p>
<p>因此 <span class="math inline">\(e_1d_1\equiv
1\pmod{\phi(N)}\)</span>，<span class="math inline">\(e_2d_2\equiv
1\pmod{\phi(N)}\)</span></p>
<p>前一个式子乘以 <span class="math inline">\(e_2\)</span>，后一个式子乘以 <span class="math inline">\(e_1\)</span>，相减得到 <span class="math display">\[
e_1e_2(d_1-d_2)\equiv e_2-e_1\pmod{\phi(N)}
\]</span> 因为 <span class="math inline">\(\phi(N)=p^{r-1}(p-1)(q-1)\)</span>，故 <span class="math inline">\(e_1e_2(d_1-d_2)\equiv
e_2-e_1\pmod{p^{r-1}}\)</span></p>
<p>现在，只需考虑以下这个线性方程 <span class="math display">\[
e_1e_2x-(e_2-e_1)\equiv 0\pmod{p^{r-1}}
\]</span> 其中 <span class="math inline">\(d_1-d_2\)</span>
是该方程的根。</p>
<p>进一步假设 <span class="math inline">\(|d_1-d_2|&lt;N^\delta\)</span>，运用<strong>定理一</strong>，其中
<span class="math inline">\(u=r,v=r-1\ 且\
\beta=\frac{1}{r+1}\)</span>，可以推导出如果 <span class="math inline">\(\delta&lt;uv\beta^2=\frac{r(r-1)}{(r+1)^2}\)</span>，那么
<span class="math inline">\(x=d_1-d_2\)</span>
可在多项式时间内求解。</p>
<p>也就是说如果 <span class="math inline">\(|d_1-d_2|&lt;N^{\frac{r(r-1)}{(r+1)^2}}\)</span>，可以在多项式时间内求解方程。</p>
<p>通过计算 <span class="math display">\[
\gcd(e_1e_2x-(e_2-e_1),N)=\gcd(p^{r-1}(p-1)(q-1)y,p^rq)=g
\]</span> 可以确定 <span class="math inline">\(p\)</span>，因此将 <span class="math inline">\(N\)</span> 按如下情况分解：</p>
<ul>
<li>当 <span class="math inline">\(g=p^{r-1}\)</span> 时，<span class="math inline">\(p=g^{\frac{1}{r-1}}\)</span></li>
<li>当 <span class="math inline">\(g=p^r\)</span> 时，<span class="math inline">\(p=g^{\frac{1}{r}}\)</span></li>
<li>当 <span class="math inline">\(g=p^{r-1}q\)</span> 时，<span class="math inline">\(p=\frac{N}{g}\)</span></li>
</ul>
<h3 id="实例">实例</h3>
<p>尝试求解 <span class="math inline">\(N=p^2q\)</span>，其中 <span class="math display">\[
N = 6093253851486120878859471958399737725885946526553626219\\
e1 = 2749600381847487389715964767235618802529675855606377411\\
e2 = 3575081244952414009316396501512372226545892558898276551
\]</span> 构建方程 <span class="math inline">\(f(x)=e_1e_2x-(e_2-e_1)\equiv
0\pmod{p^{r-1}}\)</span> （我们可以将这个方程看作 <span class="math inline">\(g(x)=x-a\equiv 0\pmod{p^{r-1}}\)</span>，其中
<span class="math inline">\(a\equiv
(e_2-e_1)(e_1e_2)^{-1}\pmod{N}\)</span>）</p>
<p>使用 <span class="math inline">\(m=8\)</span> 和 <span class="math inline">\(t=6\)</span>，我们构建一个维度为 <span class="math inline">\(\omega=9\)</span> 的格。</p>
<p>应用 LLL 算法并接触第一个简化多项式，我们得到了解 <span class="math inline">\(x_0= 1826732340\)</span></p>
<p>因此 <span class="math inline">\(\gcd(f(x_0),N)=p=1789386140116417697\)</span>，且最终
<span class="math inline">\(q=\frac{N}{p^2}=1903010275819064491\)</span></p>
<p>整个求解程序的运行时间使用现成的计算机是少于 4 秒的。</p>
<p>最后我们可以恢复私钥 <span class="math inline">\((d_1,d_2)\)</span>。</p>
<p>但是要注意到，如果 <span class="math inline">\(d_1\approx d_2\approx
N^{0.99}\)</span>，且 Sarkar’s method 与存在范围 <span class="math inline">\(d&lt;N^{0.395}\)</span>，可能无法恢复私钥。</p>
<h3 id="代码">代码</h3>
<p><code>task.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> msg</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;d3ctf&#123;&#x27;</span>+md5(msg).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line"><span class="keyword">assert</span> p &gt; q</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">m = bytes_to_long(msg)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">N = <span class="built_in">pow</span>(p, <span class="number">7</span>) * q</span><br><span class="line">phi = <span class="built_in">pow</span>(p, <span class="number">6</span>) * (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d1 = getPrime(<span class="number">2000</span>)</span><br><span class="line">d2 = nextprime(d1 + getPrime(<span class="number">1000</span>))</span><br><span class="line">e1 = invert(d1, phi)</span><br><span class="line">e2 = invert(d2, phi)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;N = <span class="subst">&#123;N&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e1 = <span class="subst">&#123;e1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e2 = <span class="subst">&#123;e2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 2420624631315473673388732074340410215657378096737020976722603529598864338532404224879219059105950005655100728361198499550862405660043591919681568611707967</span></span><br><span class="line"><span class="string">N = 1476751427633071977599571983301151063258376731102955975364111147037204614220376883752032253407881568290520059515340434632858734689439268479399482315506043425541162646523388437842149125178447800616137044219916586942207838674001004007237861470176454543718752182312318068466051713087927370670177514666860822341380494154077020472814706123209865769048722380888175401791873273850281384147394075054950169002165357490796510950852631287689747360436384163758289159710264469722036320819123313773301072777844457895388797742631541101152819089150281489897683508400098693808473542212963868834485233858128220055727804326451310080791</span></span><br><span class="line"><span class="string">e1 = 425735006018518321920113858371691046233291394270779139216531379266829453665704656868245884309574741300746121946724344532456337490492263690989727904837374279175606623404025598533405400677329916633307585813849635071097268989906426771864410852556381279117588496262787146588414873723983855041415476840445850171457530977221981125006107741100779529209163446405585696682186452013669643507275620439492021019544922913941472624874102604249376990616323884331293660116156782891935217575308895791623826306100692059131945495084654854521834016181452508329430102813663713333608459898915361745215871305547069325129687311358338082029</span></span><br><span class="line"><span class="string">e2 = 1004512650658647383814190582513307789549094672255033373245432814519573537648997991452158231923692387604945039180687417026069655569594454408690445879849410118502279459189421806132654131287284719070037134752526923855821229397612868419416851456578505341237256609343187666849045678291935806441844686439591365338539029504178066823886051731466788474438373839803448380498800384597878814991008672054436093542513518012957106825842251155935855375353004898840663429274565622024673235081082222394015174831078190299524112112571718817712276118850981261489528540025810396786605197437842655180663611669918785635193552649262904644919</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><code>exp.sage</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">r = <span class="number">7</span></span><br><span class="line"></span><br><span class="line">N = <span class="number">1476751427633071977599571983301151063258376731102955975364111147037204614220376883752032253407881568290520059515340434632858734689439268479399482315506043425541162646523388437842149125178447800616137044219916586942207838674001004007237861470176454543718752182312318068466051713087927370670177514666860822341380494154077020472814706123209865769048722380888175401791873273850281384147394075054950169002165357490796510950852631287689747360436384163758289159710264469722036320819123313773301072777844457895388797742631541101152819089150281489897683508400098693808473542212963868834485233858128220055727804326451310080791</span></span><br><span class="line"></span><br><span class="line">e1 = <span class="number">425735006018518321920113858371691046233291394270779139216531379266829453665704656868245884309574741300746121946724344532456337490492263690989727904837374279175606623404025598533405400677329916633307585813849635071097268989906426771864410852556381279117588496262787146588414873723983855041415476840445850171457530977221981125006107741100779529209163446405585696682186452013669643507275620439492021019544922913941472624874102604249376990616323884331293660116156782891935217575308895791623826306100692059131945495084654854521834016181452508329430102813663713333608459898915361745215871305547069325129687311358338082029</span></span><br><span class="line">e2 = <span class="number">1004512650658647383814190582513307789549094672255033373245432814519573537648997991452158231923692387604945039180687417026069655569594454408690445879849410118502279459189421806132654131287284719070037134752526923855821229397612868419416851456578505341237256609343187666849045678291935806441844686439591365338539029504178066823886051731466788474438373839803448380498800384597878814991008672054436093542513518012957106825842251155935855375353004898840663429274565622024673235081082222394015174831078190299524112112571718817712276118850981261489528540025810396786605197437842655180663611669918785635193552649262904644919</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">2420624631315473673388732074340410215657378096737020976722603529598864338532404224879219059105950005655100728361198499550862405660043591919681568611707967</span></span><br><span class="line"></span><br><span class="line">x = polygen(Zmod(N))</span><br><span class="line">f = e1 * e2 * x - (e2 - e1)</span><br><span class="line">f = f.monic()</span><br><span class="line"></span><br><span class="line">roots = f.small_roots(beta=((r - <span class="number">1</span>) / (r + <span class="number">1</span>) - <span class="number">0.01</span>), epsilon=<span class="number">0.05</span>)</span><br><span class="line"></span><br><span class="line">res = gmpy2.iroot(gmpy2.gcd(<span class="built_in">int</span>(f(roots[<span class="number">0</span>])), N), r - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">assert</span> res[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, res[<span class="number">0</span>])</span><br><span class="line">p = res[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">q = N // (p**<span class="number">7</span>)</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(<span class="number">0x10001</span>, phi)</span><br><span class="line">msg = long_to_bytes(power_mod(c, d, n))</span><br><span class="line"><span class="built_in">print</span>(msg)</span><br><span class="line">flag = <span class="string">&#x27;d3ctf&#123;&#x27;</span> + md5(msg).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>crypto</tag>
        <tag>rsa</tag>
      </tags>
  </entry>
  <entry>
    <title>sagemath 方程求解笔记</title>
    <url>//sagemath-equation-note.html</url>
    <content><![CDATA[<p><a href="https://sagecell.sagemath.org/">sagemath
在线运行网站</a></p>
<p><a href="https://www.lainme.com/doku.php/topic/sage/chapter_02/section_08">线性代数中文文档</a></p>
<h1 id="矩阵操作">矩阵操作</h1>
<ul>
<li><p>环</p>
<ul>
<li><code>ZZ</code> → 整数环</li>
<li><code>QQ</code> → 有理数环</li>
<li><code>Zmod(p)</code> → p为素数，定义在<span class="math inline">\(Z_p\)</span>上的环</li>
</ul></li>
<li><p>矩阵声明</p>
<ul>
<li><p>完整定义</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 矩阵所在环, 矩阵行, 矩阵列, 矩阵元素初始化</span></span><br><span class="line">mt = matrix(ZZ, <span class="number">3</span>, <span class="number">2</span>, <span class="built_in">range</span>(<span class="number">6</span>))		<span class="comment"># 即定义在整数环上的 3行4列 矩阵</span></span><br></pre></td></tr></table></figure></li>
<li><p>空矩阵</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 默认矩阵元素为 0</span></span><br><span class="line">mt = matrix(ZZ, <span class="number">3</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>缺省定义</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 对应生成在有理数环上的 3列 矩阵</span></span><br><span class="line">mt = matrix(QQ, <span class="number">3</span>, <span class="built_in">range</span>(<span class="number">6</span>))</span><br><span class="line"><span class="comment"># 对应生成在有理数环上的列矩阵</span></span><br><span class="line">mt = matrix(QQ, <span class="built_in">range</span>(<span class="number">6</span>))</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><p>添加行</p>
<ul>
<li><p>在末尾添加一行</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mt = mt.stack(vector([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></figure></li>
<li><p>在指定行插入一行</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 行号, 元素</span></span><br><span class="line">mt = mt.insert_row(<span class="number">1</span>, vector([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]))</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><p>修改元素值</p>
<ul>
<li><p>修改单值 (类似修改二维数组)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 将第 3 行第 4 列的值修改为 1</span></span><br><span class="line">mt[<span class="number">2</span>, <span class="number">3</span>] = <span class="number">1</span></span><br></pre></td></tr></table></figure></li>
<li><p>修改一行的值</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 将第 3 行的值依次修改为列表中的值</span></span><br><span class="line">mt[<span class="number">2</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><p>求秩</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mt.rank()</span><br></pre></td></tr></table></figure></li>
<li><p>求行数、列数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mt.nrows()	<span class="comment"># 将返回矩阵行数</span></span><br><span class="line">mt.ncols()	<span class="comment"># 将返回矩阵列数</span></span><br></pre></td></tr></table></figure></li>
<li><p>求行列式的值</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mt.determinant()</span><br></pre></td></tr></table></figure></li>
<li><p>求逆</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 判断是否可逆</span></span><br><span class="line">mt.is_invertible()</span><br><span class="line"><span class="comment"># 求逆</span></span><br><span class="line">mt.inverse()</span><br><span class="line">mt ** -<span class="number">1</span></span><br><span class="line">mt ^ -<span class="number">1</span></span><br></pre></td></tr></table></figure></li>
<li><p>改变矩阵所处环</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 将矩阵的环改为 ZZ</span></span><br><span class="line">mt.change_ring(ZZ)</span><br></pre></td></tr></table></figure></li>
<li><p>求解线性方程和线性相关组</p>
<ul>
<li><p>求解 <span class="math inline">\(Ax=B\)</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = A.solve_right(B)</span><br><span class="line">x = A.inverse() * B</span><br><span class="line">x = A \ B</span><br></pre></td></tr></table></figure></li>
<li><p>求解 <span class="math inline">\(xA=B\)</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = A.solve_left(B)</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><p>寻找线性相关的行向量</p>
<ul>
<li><p>满足 <span class="math inline">\(xA=0\)</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = A.left_kernel()</span><br></pre></td></tr></table></figure></li>
<li><p>满足 <span class="math inline">\(Ax=0\)</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = A.right_kernel()</span><br></pre></td></tr></table></figure></li>
<li><p>找 <span class="math inline">\(x\)</span> 中指定行向量</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 解 x 中的第 1 行</span></span><br><span class="line">x.gen(<span class="number">0</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>求最短正交基 (LLL格基约简算法)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mt.LLL()</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h1 id="高斯消元法">高斯消元法</h1>
<p>高斯消元法求解多元一次方程，即求解 <span class="math display">\[
Ax=B
\]</span> 利用 sagemath 的矩阵运算轻松求解：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 系数矩阵</span></span><br><span class="line">A = matrix(<span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">A[<span class="number">0</span>, <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">A[<span class="number">1</span>, <span class="number">0</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 常数向量</span></span><br><span class="line">B = vector([<span class="number">3</span>, <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到未知数向量</span></span><br><span class="line">x = A \ B</span><br></pre></td></tr></table></figure>
<h1 id="一次同余式">一次同余式</h1>
<p>求解一次同余式即求解 <span class="math display">\[
Ax\equiv B\ (mod\ m)
\]</span> 在 sagemath 中引入环后，同理高斯消元法：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m = <span class="number">2</span></span><br><span class="line"><span class="comment"># 系数矩阵</span></span><br><span class="line">A = matrix(Zmod(m), <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">A[<span class="number">0</span>, <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">A[<span class="number">1</span>, <span class="number">0</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 常数向量</span></span><br><span class="line">B = vector([<span class="number">3</span>, <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到未知数向量</span></span><br><span class="line">x = A \ B</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>sagemath</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>ssh的使用笔记</title>
    <url>//ssh-note.html</url>
    <content><![CDATA[<h1 id="ssh参数详解">ssh参数详解</h1>
<h2 id="ssh">ssh</h2>
<table>
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>-b bind_address</th>
<th>在本地主机上绑定用于ssh连接的地址，当系统有多个ip时才生效。</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>-E log_file</strong></td>
<td><strong>将debug日志写入到log_file中，而不是默认的标准错误输出stderr。</strong></td>
</tr>
<tr class="even">
<td><strong>-F configfile</strong></td>
<td><strong>指定用户配置文件，默认为~/.ssh/config。</strong></td>
</tr>
<tr class="odd">
<td><strong>-f</strong></td>
<td><strong>请求ssh在工作在后台模式。该选项隐含了"-n"选项，所以标准输入将变为/dev/null。</strong></td>
</tr>
<tr class="even">
<td><strong>-i identity_file</strong></td>
<td><strong>指定公钥认证时要读取的私钥文件。默认为id_rsa。</strong></td>
</tr>
<tr class="odd">
<td><strong>-l login_name</strong></td>
<td><strong>指定登录在远程机器上的用户名。也可以在全局配置文件中设置。</strong></td>
</tr>
<tr class="even">
<td><strong>-N</strong></td>
<td><strong>显式指明ssh不执行远程命令。一般用于端口转发，见后文端口转发的示例分析。</strong></td>
</tr>
<tr class="odd">
<td><strong>-n</strong></td>
<td><strong>将/dev/null作为标准输入stdin，可以防止从标准输入中读取内容。ssh在后台运行时默认该项。</strong></td>
</tr>
<tr class="even">
<td><strong>-p port</strong></td>
<td><strong>指定目的端口，默认为22。</strong></td>
</tr>
<tr class="odd">
<td><strong>-q</strong></td>
<td><strong>静默模式。大多数警告信息将不输出。</strong></td>
</tr>
<tr class="even">
<td><strong>-T</strong></td>
<td><strong>禁止为ssh分配伪终端。</strong></td>
</tr>
<tr class="odd">
<td><strong>-t</strong></td>
<td><strong>强制分配伪终端，重复使用该选项"-tt"将进一步强制。</strong></td>
</tr>
<tr class="even">
<td><strong>-v</strong></td>
<td><strong>详细模式，将输出debug消息，可用于调试。"-vvv"可更详细。</strong></td>
</tr>
<tr class="odd">
<td><strong>-V</strong></td>
<td><strong>显示版本号并退出。</strong></td>
</tr>
<tr class="even">
<td><strong>-o</strong></td>
<td><strong>指定额外选项，选项非常多。</strong></td>
</tr>
<tr class="odd">
<td><strong>user@host</strong></td>
<td><strong>指定登录远端主机的用户名。</strong></td>
</tr>
<tr class="even">
<td><strong>host</strong></td>
<td><strong>如果本机用户名和需要登录的远端用户名一致，可省略用户名。</strong></td>
</tr>
</tbody>
</table>
<h3 id="基本示例">基本示例</h3>
<p>以172.16.10.6主机上的longshuai用户登录172.16.10.6</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh longshuai@172.16.10.6</span><br></pre></td></tr></table></figure>
<p>使用ssh还可以实现主机跳转，即跳板功能。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh 172.16.10.6</span><br></pre></td></tr></table></figure>
<h2 id="ssh-keygen">ssh-keygen</h2>
<table>
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th><strong>-b length</strong></th>
<th><strong>指定密钥长度</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>-e file</strong></td>
<td><strong>读取openssh的私钥或者公钥文件</strong></td>
</tr>
<tr class="even">
<td><strong>-C comment</strong></td>
<td><strong>添加注释</strong></td>
</tr>
<tr class="odd">
<td><strong>-f filename</strong></td>
<td><strong>指定用来保存密钥的文件名</strong></td>
</tr>
<tr class="even">
<td><strong>-i file</strong></td>
<td><strong>读取未加密的ssh-v2兼容的私钥/公钥文件，然后在标准输出设备上显示openssh兼容的私钥/公钥</strong></td>
</tr>
<tr class="odd">
<td><strong>-I file</strong></td>
<td><strong>显示公钥文件的指纹数据</strong></td>
</tr>
<tr class="even">
<td><strong>-N key</strong></td>
<td><strong>提供一个新密语</strong></td>
</tr>
<tr class="odd">
<td><strong>-P key</strong></td>
<td><strong>提供（旧）密语</strong></td>
</tr>
<tr class="even">
<td><strong>-q</strong></td>
<td><strong>静默模式</strong></td>
</tr>
<tr class="odd">
<td><strong>-t type</strong></td>
<td><strong>指定要创建的密钥类型</strong></td>
</tr>
</tbody>
</table>
<p>默认在<strong>~/.ssh</strong>目录下生成<strong>id_rsa</strong>和<strong>id_rsa.pub</strong>文件</p>
<table>
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th><strong>id_rsa</strong></th>
<th><strong>私钥文件</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>id_rsa.pub</strong></td>
<td><strong>公钥文件</strong></td>
</tr>
<tr class="even">
<td><strong>known_hosts</strong></td>
<td><strong>类似hosts文件，用于保存访问过的计算机的公钥，OpenSSH会自动进行核对</strong></td>
</tr>
</tbody>
</table>
<p>多个<strong>SSH key</strong>的管理的情况需要指定秘钥文件名。</p>
<h3 id="基本示例-1">基本示例</h3>
<p>默认在 <code>~/.ssh</code> 目录中生成<strong>SSH
RSA</strong>公钥和私钥文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>
<p>默认在 <code>~/.ssh</code>目录中生成4096位<strong>SSH
RSA</strong>公钥和私钥文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh-keygen -m PEM -t rsa -b 4096</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>ssh</tag>
      </tags>
  </entry>
  <entry>
    <title>vol3-gbk-error</title>
    <url>//errors/vol3-gbk-error.html</url>
    <content><![CDATA[<h1 id="错误分析">错误分析</h1>
<p>未知错误，可能是扫描过程中出现非法编码造成的异常</p>
<figure>
<img src="/errors/vol3-gbk-error/UnicodeEncodeError.png" alt="UnicodeEncodeError">
<figcaption aria-hidden="true">UnicodeEncodeError</figcaption>
</figure>
<h1 id="解决错误">解决错误</h1>
<p>打开异常最先出现的位置
<code>./volatility3/cli/text_renderer.py</code> 定位
<code>line 173</code></p>
<figure>
<img src="/errors/vol3-gbk-error/visitor.png" alt="visitor">
<figcaption aria-hidden="true">visitor</figcaption>
</figure>
<p>修改代码为</p>
<figure>
<img src="/errors/vol3-gbk-error/after.png" alt="after">
<figcaption aria-hidden="true">after</figcaption>
</figure>
<p>此法为暴力破解，可以解决程序因抛出异常后中断执行问题
(处理方式为不处理异常继续运行程序)</p>
]]></content>
      <tags>
        <tag>error</tag>
        <tag>volatility3</tag>
      </tags>
  </entry>
  <entry>
    <title>uuencode 笔记</title>
    <url>//uuencode-note.html</url>
    <content><![CDATA[<h1 id="uuencode-原理">UUEncode 原理</h1>
<p>Uuencode是二进制信息和文字信息之间的转换编码，也就是机器和人眼识读的转换。Uuencode编码方案常见于电子邮件信息的传输，目前已被多用途互联网邮件扩展（MIME）大量取代。</p>
<p>Uuencode将输入文字以每三个字节为单位进行编码，如此重复进行。如果最后剩下的文字少于三个字节，不够的部份用零补齐。这三个字节共有24个Bit，以6-bit为单位分为4个群组，每个群组以十进制来表示所出现的数值只会落在0到63之间。将每个数加上32，所产生的结果刚好落在ASCII字符集中可打印字符（32-空白...95-底线）的范围之中。</p>
<p>Uuencode编码每60个将输出为独立的一行（相当于45个输入字节），每行的开头会加上长度字符，除了最后一行之外，长度字符都应该是“M”这个ASCII字符（77=32+45），最后一行的长度字符为32+剩下的字节数目这个ASCII字符。</p>
<p>Uuencode编码与base64编码类似，但base64将0~63之间的数字通过查表换字符，而Uuencode编码是直接将这个数字加上32转换为可打印字符。</p>
<h1 id="c-实现">C++ 实现</h1>
<h2 id="加密---encode">加密 - Encode</h2>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">string <span class="title">encode</span><span class="params">(<span class="keyword">const</span> string&amp; plain)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;有机会再实现&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="解密---decode">解密 - Decode</h2>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">string <span class="title">decode</span><span class="params">(<span class="keyword">const</span> string&amp; code)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;有机会再实现&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="python-实现">Python 实现</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> uu</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 uuencode 将 in_file 文件编码为 out_file 文件。</span></span><br><span class="line"><span class="comment"># 经过 uuencoded 编码的文件将具有指定 name 和 mode 作为解码该文件默认结果的标头。</span></span><br><span class="line"><span class="comment"># 默认值会相应地从 in_file 或 &#x27;-&#x27; 以及 0o666 中提取。</span></span><br><span class="line"><span class="comment"># 如果 backtick 为真值，零会用 &#x27;`&#x27; 而不是空格来表示。</span></span><br><span class="line">uu.encode(in_file, out_file, mode=<span class="literal">None</span>, *, backtick=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用此函数会解码 uuencod 编码的 in_file 文件并将结果放入 out_file 文件。</span></span><br><span class="line"><span class="comment"># 如果 out_file 是一个路径名称，mode 会在必须创建文件时用于设置权限位。</span></span><br><span class="line"><span class="comment"># out_file 和 mode 的默认值会从 uuencode 标头中提取。</span></span><br><span class="line"><span class="comment"># 但是，如果标头中指定的文件已存在，则会引发 uu.Error。</span></span><br><span class="line">uu.decode(in_file, out_file=<span class="literal">None</span>, mode=<span class="literal">None</span>, quiet=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<h1 id="在线网站">在线网站</h1>
<ul>
<li>https://www.qqxiuzi.cn/bianma/uuencode.php</li>
</ul>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>crypto</tag>
        <tag>uuencode</tag>
      </tags>
  </entry>
  <entry>
    <title>volatility3 使用笔记</title>
    <url>//vol3-note.html</url>
    <content><![CDATA[<h1 id="volatility3-安装">volatility3 安装</h1>
<p><strong>volatility3 需要 Python 3.6.0 或更高版本。</strong></p>
<p>进入https://github.com/volatilityfoundation/volatility3/releases选择<code>volatility3-2.0.0-py3-none-any.whl</code>进行下载</p>
<figure>
<img src="/vol3-note/image-20220204224548796.png" alt="image-20220204224548796">
<figcaption aria-hidden="true">image-20220204224548796</figcaption>
</figure>
<p>通过以下指令进行自动化安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip3 wheel volatility3-2.0.0-py3-none-any.whl</span><br></pre></td></tr></table></figure>
<p>若安装失败可直接下载源码后直接使用，但需要手动调用脚本
<code>vol.py</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 vol.py --<span class="built_in">help</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以通过以下指令达到与 <code>.whl</code> 安装同样的效果</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 setup.py build</span><br><span class="line">python3 setup.py install</span><br></pre></td></tr></table></figure>
</blockquote>
<p>如果需要使用 volatility3 最基本功能，请将以下内容保存为
<code>r.txt</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># These packages are required for core functionality.</span></span><br><span class="line">pefile&gt;=2017.8.1 <span class="comment">#foo</span></span><br></pre></td></tr></table></figure>
<p>如果需要使用 volatility3 完整功能，请将以下内容保存为
<code>r.txt</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># The following packages are required for core functionality.</span></span><br><span class="line">pefile&gt;=2017.8.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># The following packages are optional.</span></span><br><span class="line"><span class="comment"># If certain packages are not necessary, place a comment (#) at the start of the line.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This is required for the yara plugins</span></span><br><span class="line">yara-python&gt;=3.8.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># This is required for several plugins that perform malware analysis and disassemble code.</span></span><br><span class="line"><span class="comment"># It can also improve accuracy of Windows 8 and later memory samples.</span></span><br><span class="line">capstone&gt;=3.0.5</span><br><span class="line"></span><br><span class="line"><span class="comment"># This is required by plugins that decrypt passwords, password hashes, etc.</span></span><br><span class="line">pycryptodome</span><br><span class="line"></span><br><span class="line"><span class="comment"># This can improve error messages regarding improperly configured ISF files.</span></span><br><span class="line">jsonschema&gt;=2.3.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># This is required for memory acquisition via leechcore/pcileech.</span></span><br><span class="line">leechcorepyc&gt;=2.4.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># This is required for analyzing Linux samples compressed using AVMLs native</span></span><br><span class="line"><span class="comment"># compression format.  It is not required for AVML&#x27;s standard LiME compression.</span></span><br><span class="line">python-snappy==0.6.0</span><br></pre></td></tr></table></figure>
<p>然后运行以下指令安装 volatility3 所需依赖</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip3 install -r r.txt</span><br></pre></td></tr></table></figure>
<h1 id="volatility3-使用">volatility3 使用</h1>
<h2 id="使用">使用</h2>
<p>通过 <code>-h</code> 指令获取帮助</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -h</span><br></pre></td></tr></table></figure>
<figure>
<img src="/vol3-note/vol3help.png" alt="vol3help">
<figcaption aria-hidden="true">vol3help</figcaption>
</figure>
<p>同样地，可以对插件使用 <code>-h</code> 指令获取插件帮助</p>
<figure>
<img src="/vol3-note/layerwritehelp.png" alt="layerwritehelp">
<figcaption aria-hidden="true">layerwritehelp</figcaption>
</figure>
<h2 id="插件">插件</h2>
<p>使用对应 linux / mac / windows 插件之前，请先下载对应的符号表
(最好下载所有的符号包)：</p>
<ul>
<li><p>https://downloads.volatilityfoundation.org/volatility3/symbols/windows.zip</p></li>
<li><p>https://downloads.volatilityfoundation.org/volatility3/symbols/mac.zip</p></li>
<li><p>https://downloads.volatilityfoundation.org/volatility3/symbols/linux.zip</p></li>
</ul>
<p>并将其解压在 <code>./volatility/symbols/</code> 目录下</p>
<figure>
<img src="/vol3-note/symbols.png" alt="symbols">
<figcaption aria-hidden="true">symbols</figcaption>
</figure>
<blockquote>
<p>以下，部分插件可能出现不存在或者更名的情况，我并未使用到的功能并不会及时更新</p>
</blockquote>
<table>
<colgroup>
<col style="width: 36%">
<col style="width: 63%">
</colgroup>
<thead>
<tr class="header">
<th>插件名</th>
<th>用法</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>layerwriter</code></td>
<td>列出内存镜像 platform 信息，分割 layers</td>
</tr>
<tr class="even">
<td><code>linux.bash</code></td>
<td>从内存中恢复 bash 命令历史记录</td>
</tr>
<tr class="odd">
<td><code>linux.check_afinfo</code></td>
<td>验证网络协议的操作功能指针</td>
</tr>
<tr class="even">
<td><code>linux.check_syscall</code></td>
<td>检查系统调用表中的挂钩</td>
</tr>
<tr class="odd">
<td><code>linux.elfs</code></td>
<td>列出所有进程的所有内存映射ELF文件</td>
</tr>
<tr class="even">
<td><code>linux.lsmod</code></td>
<td>列出加载的内核模块</td>
</tr>
<tr class="odd">
<td><code>linux.lsof</code></td>
<td>列出所有进程的所有内存映射</td>
</tr>
<tr class="even">
<td><code>linux.malfind</code></td>
<td>列出可能包含注入代码的进程内存范围</td>
</tr>
<tr class="odd">
<td><code>linux.proc</code></td>
<td>列出所有进程的所有内存映射</td>
</tr>
<tr class="even">
<td><code>linux.pslist</code></td>
<td>列出 linux 内存映像中存在的进程</td>
</tr>
<tr class="odd">
<td><code>linux.pstree</code></td>
<td>列出进程树</td>
</tr>
<tr class="even">
<td><code>mac.bash</code></td>
<td>从内存中恢复 bash 命令历史记录</td>
</tr>
<tr class="odd">
<td><code>mac.check_syscall</code></td>
<td>检查系统调用表中的挂钩</td>
</tr>
<tr class="even">
<td><code>mac.check_sysctl</code></td>
<td>检查 sysctl 处理程序的挂钩</td>
</tr>
<tr class="odd">
<td><code>mac.check_trap_table</code></td>
<td>检查 trap 表中的挂钩</td>
</tr>
<tr class="even">
<td><code>mac.ifconfig</code></td>
<td>列出网卡信息</td>
</tr>
<tr class="odd">
<td><code>mac.lsmod</code></td>
<td>列出加载的内核模块</td>
</tr>
<tr class="even">
<td><code>mac.lsof</code></td>
<td>列出所有进程的所有内存映射</td>
</tr>
<tr class="odd">
<td><code>mac.malfind</code></td>
<td>列出可能包含注入代码的进程内存范围</td>
</tr>
<tr class="even">
<td><code>mac.netstat</code></td>
<td>列出所有进程的所有网络连接</td>
</tr>
<tr class="odd">
<td><code>mac.psaux</code></td>
<td>恢复程序命令行参数</td>
</tr>
<tr class="even">
<td><code>mac.pslist</code></td>
<td>列出 mac 内存映像中存在的进程</td>
</tr>
<tr class="odd">
<td><code>mac.pstree</code></td>
<td>列出进程树</td>
</tr>
<tr class="even">
<td><code>mac.tasks</code></td>
<td>列出 mac 内存映像中存在的进程</td>
</tr>
<tr class="odd">
<td><code>windows.info</code></td>
<td>显示正在分析的内存样本的 OS 和内核详细信息</td>
</tr>
<tr class="even">
<td><code>windows.callbacks</code></td>
<td>列出内核回调和通知例程</td>
</tr>
<tr class="odd">
<td><code>windows.cmdline</code></td>
<td>列出进程命令行参数</td>
</tr>
<tr class="even">
<td><code>windows.dlldump</code></td>
<td>将进程内存范围 DLL 转储</td>
</tr>
<tr class="odd">
<td><code>windows.dlllist</code></td>
<td>列出 Windows 内存映像中已加载的 dll 模块</td>
</tr>
<tr class="even">
<td><code>windows.driverirp</code></td>
<td>在 Windows 内存映像中列出驱动程序的 IRP</td>
</tr>
<tr class="odd">
<td><code>windows.driverscan</code></td>
<td>扫描 Windows 内存映像中存在的驱动程序</td>
</tr>
<tr class="even">
<td><code>windows.filescan</code></td>
<td>扫描 Windows 内存映像中存在的文件对象</td>
</tr>
<tr class="odd">
<td><code>windows.handles</code></td>
<td>列出进程打开的句柄</td>
</tr>
<tr class="even">
<td><code>windows.malfind</code></td>
<td>列出可能包含注入代码的进程内存范围</td>
</tr>
<tr class="odd">
<td><code>windows.moddump</code></td>
<td>转储内核模块</td>
</tr>
<tr class="even">
<td><code>windows.modscan</code></td>
<td>扫描 Windows 内存映像中存在的模块</td>
</tr>
<tr class="odd">
<td><code>windows.mutantscan</code></td>
<td>扫描 Windows 内存映像中存在的互斥锁</td>
</tr>
<tr class="even">
<td><code>windows.pslist</code></td>
<td>列出 Windows 内存映像中存在的进程，转储处理可执行映像</td>
</tr>
<tr class="odd">
<td><code>windows.psscan</code></td>
<td>扫描 Windows 内存映像中存在的进程</td>
</tr>
<tr class="even">
<td><code>windows.pstree</code></td>
<td>列出进程树</td>
</tr>
<tr class="odd">
<td><code>windows.registry.certificates</code></td>
<td>列出注册表中存储的证书</td>
</tr>
<tr class="even">
<td><code>windows.registry.hivelist</code></td>
<td>列出内存映像中存在的注册表配置单元</td>
</tr>
<tr class="odd">
<td><code>windows.registry.hivescan</code></td>
<td>扫描 Windows 内存映像中存在的注册表配置单元</td>
</tr>
<tr class="even">
<td><code>windows.registry.printkey</code></td>
<td>在配置单元或特定键值下列出注册表项</td>
</tr>
<tr class="odd">
<td><code>windows.registry.userassist</code></td>
<td>打印用户助手注册表项和信息</td>
</tr>
<tr class="even">
<td><code>windows.ssdt</code></td>
<td>列出系统调用表</td>
</tr>
<tr class="odd">
<td><code>windows.strings</code></td>
<td>读取字符串命令的输出，并指示每个字符串属于哪个进程</td>
</tr>
<tr class="even">
<td><code>windows.svcscan</code></td>
<td>扫描 Windows 服务</td>
</tr>
<tr class="odd">
<td><code>windows.symlinkscan</code></td>
<td>扫描 Windows 内存映像中存在的链接</td>
</tr>
</tbody>
</table>
<h2 id="操作">操作</h2>
<h3 id="查看映像信息">查看映像信息</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.info</span><br></pre></td></tr></table></figure>
<h3 id="查看映像进程">查看映像进程</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.pslist</span><br><span class="line">vol.exe -f xxx.raw windows.psscan</span><br><span class="line">vol.exe -f xxx.raw windows.pstree</span><br></pre></td></tr></table></figure>
<p><strong>查看指定 pid 的进程</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.pslist --pid 1234</span><br></pre></td></tr></table></figure>
<h3 id="进程转储">进程转储</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -o ./outputdir/ -f xxx.raw windows.pslist --pid 1234 --dump</span><br></pre></td></tr></table></figure>
<h3 id="内存转储">内存转储</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -o ./outputdir/ -f xxx.raw windows.memmap --pid 1234 --dump</span><br></pre></td></tr></table></figure>
<h3 id="查看句柄">查看句柄</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.handles</span><br><span class="line">vol.exe -f xxx.raw windows.handles --pid 1234</span><br></pre></td></tr></table></figure>
<h3 id="查看-dll">查看 DLL</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.dlllist</span><br><span class="line">vol.exe -f xxx.raw windows.dlllist --pid 1234</span><br></pre></td></tr></table></figure>
<h3 id="dll-转储">DLL 转储</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -o ./outputdir/ -f xxx.raw windows.dlllist --pid 1234 --dump</span><br></pre></td></tr></table></figure>
<h3 id="查看命令行">查看命令行</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.cmdline</span><br><span class="line">vol.exe -f xxx.raw windows.cmdline --pid 1234</span><br></pre></td></tr></table></figure>
<h3 id="查看网络端口">查看网络端口</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.netscan</span><br></pre></td></tr></table></figure>
<p><strong>查看完整的结果，但可能包含垃圾信息和虚假信息
(谨慎使用)</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.netscan --include-corrupt</span><br></pre></td></tr></table></figure>
<h3 id="查看注册表信息">查看注册表信息</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.registry.hivescan</span><br><span class="line">vol.exe -f xxx.raw windows.registry.hivelist</span><br></pre></td></tr></table></figure>
<p><strong>查看指定过滤器 (文件夹) 下的注册表信息</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.registry.hivelist --filter FILTER</span><br></pre></td></tr></table></figure>
<h3 id="注册表信息转储">注册表信息转储</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -o ./outputdir/ -f xxx.raw windows.hivelist --filter FILTER --dump</span><br></pre></td></tr></table></figure>
<h3 id="查看注册表键值对">查看注册表键值对</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.registry.printkey</span><br></pre></td></tr></table></figure>
<p><strong>查看指定过滤器 (文件夹) 下的注册表信息，但需要
<code>hivelist</code> 提供的 <code>offset</code></strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.registry.printkey --offset OFFSET</span><br></pre></td></tr></table></figure>
<p><strong>查看指定键下的注册表值</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.registry.printkey --key KEY</span><br></pre></td></tr></table></figure>
<p><strong>打印所有键的信息</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.registry.printkey --recurse</span><br></pre></td></tr></table></figure>
<h3 id="查看文件信息">查看文件信息</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.filescan</span><br></pre></td></tr></table></figure>
<blockquote>
<p>建议通过 powershell 的 Select-String 或者 bash 的 grep
进行搜索，如：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.filescan | grep <span class="string">&quot;flag&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vol.exe <span class="operator">-f</span> xxx.raw windows.filescan | <span class="built_in">Select-String</span> <span class="string">&quot;flag&quot;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="文件转储">文件转储</h3>
<p><strong>需要 <code>pslist</code> 提供的 <code>pid</code></strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -o ./outputdir/ -f xxx.raw windows.dumpfiles --pid 1234</span><br></pre></td></tr></table></figure>
<p><strong>(推荐) 需要 <code>filescan</code> 提供的 <code>offset</code>
(一般来说为 <code>physaddr</code>) </strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -o ./outputdir/ -f xxx.raw windows.dumpfiles --virtaddr 0xee1122</span><br><span class="line">vol.exe -o ./outputdir/ -f xxx.raw windows.dumpfiles --physaddr 0xee1122</span><br></pre></td></tr></table></figure>
<h3 id="查找恶意注入代码">查找恶意注入代码</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -f xxx.raw windows.malfind</span><br><span class="line">vol.exe -f xxx.raw windows.malfind --pid 1234</span><br></pre></td></tr></table></figure>
<p><strong>恶意注入代码转储</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vol.exe -o ./outputdir/ -f xxx.raw windows.malfind --pid 1234 --dump</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>volatility3</tag>
      </tags>
  </entry>
  <entry>
    <title>z3 使用笔记</title>
    <url>//z3-note.html</url>
    <content><![CDATA[<h1 id="z3-简介">z3 简介</h1>
<p>z3 是 Microsoft Research
开发的一个定理证明器，支持位向量、布尔值、数组、浮点数、字符串和其他数据类型，可以用来自动化证明定理、线性规划求解和方程求解。</p>
<p>但方程求解效率过低，不建议使用 z3 求解方程 (少量未知数可以使用)。</p>
<h1 id="z3-安装">z3 安装</h1>
<p>可以使用 pip 进行安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install z3-solver</span><br></pre></td></tr></table></figure>
<p>若出现 pip 安装超时或安装失败的情况，请在
https://github.com/Z3Prover/z3/releases 中下载 <code>release</code>
版本包。</p>
<p>这里以 Windows 为例，下载 <code>z3-x64-win.zip</code>
后解压在合适的目录中。</p>
<p>然后将解压目录下的 <code>./bin</code> 目录添加进入环境变量
<code>Path</code> ；解压目录下的 <code>./bin/python</code>
添加进入环境变量 <code>PYTHONPATH</code> 即可。</p>
<h1 id="z3-使用">z3 使用</h1>
<h2 id="求解过程">求解过程</h2>
<ol type="1">
<li>定义若干某种类型的未知数</li>
<li>创建求解器 <code>Solver()</code></li>
<li>添加约束条件 <code>add()</code></li>
<li>进行检查问题是否有解 <code>check()</code></li>
<li>创建解决问题后的模型对象 <code>model()</code></li>
<li>得到解</li>
</ol>
<h2 id="定义若干某种类型的未知数">定义若干某种类型的未知数</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x = Int(<span class="string">&#x27;x&#x27;</span>)				<span class="comment"># 创建数据类型为整数的未知数</span></span><br><span class="line">y = Real(<span class="string">&#x27;y&#x27;</span>)				<span class="comment"># 创建数据类型为实数的未知数</span></span><br><span class="line">z = BitVec(<span class="string">&#x27;z&#x27;</span>, <span class="number">64</span>)			<span class="comment"># 创建数据类型为 64 位向量的未知数 (通常用于求解位运算问题)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建数据类型为整数的三个未知数</span></span><br><span class="line"><span class="comment"># 同理存在 Reals, BitVecs 等</span></span><br><span class="line">x, y, z = Ints(<span class="string">&#x27;x y z&#x27;</span>)</span><br><span class="line"><span class="comment"># 以上 &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27; 均为 z3 内部的未知数名，可更改，但不能重复</span></span><br></pre></td></tr></table></figure>
<h2 id="二元一次方程求解">二元一次方程求解</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义若干某种类型的未知数</span></span><br><span class="line">x, y = Ints(<span class="string">&#x27;x y&#x27;</span>)</span><br><span class="line"><span class="comment"># 创建求解器</span></span><br><span class="line">s = Solver()</span><br><span class="line"><span class="comment"># 添加约束条件</span></span><br><span class="line">s.add(x+<span class="number">3</span>*y == <span class="number">4</span>)</span><br><span class="line">s.add(<span class="number">3</span>*x+y == <span class="number">4</span>)</span><br><span class="line"><span class="comment"># 以上两行代码可以归并成一行代码 s.add(x+3*y == 4, 3*x+y == 4)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断是否问题有解，有解则返回 sat ；无解则返回 unsat</span></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="comment"># 创建解决问题后的模型对象</span></span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="comment"># 获得 x 未知数对应的模型值</span></span><br><span class="line">    varX = m[x]</span><br><span class="line">    <span class="comment"># 输出</span></span><br><span class="line">    <span class="built_in">print</span>(varX)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;unsat!&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="位运算求解">位运算求解</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义若干某种类型的未知数</span></span><br><span class="line">x = BitVec(<span class="string">&#x27;x&#x27;</span>, <span class="number">64</span>)</span><br><span class="line"><span class="comment"># 创建求解器</span></span><br><span class="line">s = Solver()</span><br><span class="line"><span class="comment"># 添加约束条件</span></span><br><span class="line">s.add(x ^ <span class="number">0xff</span> == <span class="number">0x12</span>)</span><br><span class="line"><span class="comment"># 判断是否问题有解，有解则返回 sat ；无解则返回 unsat</span></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="comment"># 创建解决问题后的模型对象</span></span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="comment"># 获得 x 未知数对应的模型值</span></span><br><span class="line">    varX = m[x]</span><br><span class="line">    <span class="comment"># 输出</span></span><br><span class="line">    <span class="built_in">print</span>(varX)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;unsat!&quot;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>python</tag>
        <tag>z3</tag>
      </tags>
  </entry>
  <entry>
    <title>有关 C/C++ 的异常处理方式笔记</title>
    <url>//cexception-note.html</url>
    <content><![CDATA[<h1 id="c-的异常处理">C 的异常处理</h1>
<p>在 C 语言中最常使用 <code>setjmp.h</code> 库处理我们的异常。</p>
<p>最简单的异常处理，我们会使用其中的两个函数：<code>setjmp</code> 和
<code>longjmp</code></p>
<h2 id="jmp_buf-数组"><code>jmp_buf</code> 数组</h2>
<p><code>jmp_buf</code> 在 MSVC 中被定义为 <code>DWORD</code> 数组。</p>
<p><code>jmp_buf</code> 被用来保存跳转现场，即用来保存当前调用的
ESP、EIP、EBP、EBX、EDI、ESI 等寄存器和标志位的信息。</p>
<h2 id="setjmp-函数"><code>setjmp</code> 函数</h2>
<p><code>setjmp</code> 需要接收一个 <code>jmp_buf</code>
数组指针，将这个时候调用 <code>setjmp</code> 时的寄存器状态保存在
<code>jmp_buf</code> 里，然后返回 <code>0</code>
代表跳转点设置成功。</p>
<p>当 <code>long_jmp</code> 被调用后，会让 <code>setjmp</code>
函数返回一个值代表此次运行为跳转运行。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">jmp_buf jb;</span><br><span class="line">setjmp(jb);</span><br></pre></td></tr></table></figure>
<h2 id="long_jmp-函数"><code>long_jmp</code> 函数</h2>
<p><code>long_jmp</code> 需要接收一个 <code>jmp_buf</code>
数组指针和一个自定义 <code>int</code> 类型信息 (会作为跳转后
<code>set_jmp</code> 的返回值)。</p>
<p>它会根据传入的 <code>jmp_buf</code>
数组还原寄存器信息，即跳转到上一次调用 <code>set_jmp(jmp_buf)</code>
的时刻，然后将传入的 <code>int</code> 类型值作为 <code>set_jmp</code>
的返回值返回。</p>
<blockquote>
<p>注意非必要不要传 <code>0</code>，否则无法分辨 <code>set_jmp</code>
是跳转回来的还是正常运行的。</p>
</blockquote>
<p>代码示例：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">longjmp(jb, <span class="number">-1</span>)</span><br></pre></td></tr></table></figure>
<h2 id="完整示例">完整示例</h2>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">jmp_buf jb;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		longjmp(jb, <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (x == <span class="number">10</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		longjmp(jb, <span class="number">2</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">10</span> / x;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line">	<span class="keyword">int</span> msg;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Pls. input a number to calc: &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;num);</span><br><span class="line"></span><br><span class="line">	msg = setjmp(jb);</span><br><span class="line">	<span class="keyword">if</span> (msg == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;the value is %d.\n&quot;</span>, calc(num));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (msg == <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;number can not be 0...\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (msg == <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;calc() do not like 10...\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;I do not know what happened...\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="c-的异常处理-1">C++ 的异常处理</h1>
<p>在 C++ 中最常使用 C++ 标准所提供的 <code>try - catch - throw</code>
异常处理模块来处理我们的异常。</p>
<h2 id="try---catch-块"><code>try - catch</code> 块</h2>
<p><code>try</code> 块中的代码被称为保护代码，后面通常跟着一个或多个
<code>catch</code> 块。</p>
<p><code>catch</code> 块跟在 <code>try</code>
块后面，用于捕获异常。可以指定想要捕捉的异常类型，这是由 catch
关键字后的括号内的异常声明决定的。</p>
<p>代码示例：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// 保护代码</span></span><br><span class="line">&#125;<span class="built_in"><span class="keyword">catch</span></span>( ExceptionName e1 )</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// catch 块</span></span><br><span class="line">&#125;<span class="built_in"><span class="keyword">catch</span></span>( ExceptionName e2 )</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// catch 块</span></span><br><span class="line">&#125;<span class="built_in"><span class="keyword">catch</span></span>( ExceptionName eN )</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// catch 块</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="throw-语句"><code>throw</code> 语句</h2>
<p>当问题出现时，程序会抛出一个异常。这是通过使用 <code>throw</code>
关键字来完成的。</p>
<p>其中 <code>throw</code> 后跟着的信息与 <code>catch</code>
的接收有关。(即 <code>throw</code> 什么就 <code>catch</code> 什么)</p>
<p>代码示例：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">division</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">if</span>( b == <span class="number">0</span> )</span><br><span class="line">   &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="string">&quot;Division by zero condition!&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> (a/b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="完整示例-1">完整示例</h2>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">division</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (b == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">throw</span> <span class="string">&quot;Division by zero condition!&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> (a / b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x = <span class="number">50</span>;</span><br><span class="line">	<span class="keyword">int</span> y = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">double</span> z = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		z = <span class="built_in">division</span>(x, y);</span><br><span class="line">		cout &lt;&lt; z &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in"><span class="keyword">catch</span></span> (<span class="keyword">const</span> <span class="keyword">char</span>* msg) &#123;</span><br><span class="line">		cerr &lt;&lt; msg &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="标准异常">标准异常</h2>
<p>C++ 提供了一系列标准的异常，定义在 <code>&lt;exception&gt;</code>
中，我们可以在程序中使用这些标准的异常。它们是以父子类层次结构组织起来的，如下所示：</p>
<figure>
<img src="/cexception-note/exceptions_in_cpp.png" alt="C++ 异常的层次结构">
<figcaption aria-hidden="true">C++ 异常的层次结构</figcaption>
</figure>
<p>下表是对上面层次结构中出现的每个异常的说明：</p>
<table>
<colgroup>
<col style="width: 28%">
<col style="width: 71%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">异常</th>
<th style="text-align: left;">描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong><code>std::exception</code></strong></td>
<td style="text-align: left;">该异常是所有标准 C++ 异常的父类。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>std::bad_alloc</code></td>
<td style="text-align: left;">该异常可以通过 <code>new</code>
抛出。</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>std::bad_cast</code></td>
<td style="text-align: left;">该异常可以通过 <code>dynamic_cast</code>
抛出。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>std::bad_exception</code></td>
<td style="text-align: left;">这在处理 C++
程序中无法预期的异常时非常有用。</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>std::bad_typeid</code></td>
<td style="text-align: left;">该异常可以通过 <code>typeid</code>
抛出。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>std::logic_error</code></strong></td>
<td style="text-align: left;">理论上可以通过读取代码来检测到的异常。</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>std::domain_error</code></td>
<td style="text-align: left;">当使用了一个无效的数学域时，会抛出该异常。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>std::invalid_argument</code></td>
<td style="text-align: left;">当使用了无效的参数时，会抛出该异常。</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>std::length_error</code></td>
<td style="text-align: left;">当创建了太长的 std::string
时，会抛出该异常。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>std::out_of_range</code></td>
<td style="text-align: left;">该异常可以通过方法抛出，例如
<code>std::vector</code> 和
<code>std::bitset&lt;&gt;::operator[]()</code>。</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>std::runtime_error</code></strong></td>
<td style="text-align: left;">理论上不可以通过读取代码来检测到的异常。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>std::overflow_error</code></td>
<td style="text-align: left;">当发生数学上溢时，会抛出该异常。</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>std::range_error</code></td>
<td style="text-align: left;">当尝试存储超出范围的值时，会抛出该异常。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>std::underflow_error</code></td>
<td style="text-align: left;">当发生数学下溢时，会抛出该异常。</td>
</tr>
</tbody>
</table>
<p>同时我们也可以自定义异常，代码示例：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;exception&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这里可以不继承 exception 来创建自己的异常标准。</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MyException</span> :</span> <span class="keyword">public</span> exception</span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">what</span><span class="params">()</span> <span class="keyword">const</span> <span class="title">throw</span> <span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;C++ Exception&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">try</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">throw</span> <span class="built_in">MyException</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in"><span class="keyword">catch</span></span> (MyException&amp; e)</span><br><span class="line">	&#123;</span><br><span class="line">		std::cout &lt;&lt; <span class="string">&quot;MyException caught&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">		std::cout &lt;&lt; e.<span class="built_in">what</span>() &lt;&lt; std::endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in"><span class="keyword">catch</span></span> (std::exception&amp; e)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//其他的错误</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="windows-seh-结构化异常处理机制">Windows SEH
结构化异常处理机制</h1>
<p>Windows SEH
结构化异常处理机制核心是由系统维护的一个单向链表，链表中保存每个异常处理函数的指针。</p>
<p>调用机制类似 C++ 的异常处理：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__try</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 保护代码</span></span><br><span class="line">&#125;</span><br><span class="line">__except ()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 异常处理后的内容块</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中 <code>__except</code> 需要一个宏定义常量，通常是
<code>EXCEPTION_CONTINUE_EXECUTION</code>、<code>EXCEPTION_EXECUTE_HANDLER</code>
和 <code>EXCEPTION_CONTINUE_SEARCH</code>。</p>
<table>
<colgroup>
<col style="width: 33%">
<col style="width: 66%">
</colgroup>
<thead>
<tr class="header">
<th>宏定义常量</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>EXCEPTION_CONTINUE_EXECUTION</code></td>
<td>异常处理完毕，程序继续正常运行异常出现处的下一条指令</td>
</tr>
<tr class="even">
<td><code>EXCEPTION_EXECUTE_HANDLER</code></td>
<td>异常处理完毕，但是直接执行 <code>__except</code> 块的内容</td>
</tr>
<tr class="odd">
<td><code>EXCEPTION_CONTINUE_SEARCH</code></td>
<td>异常无法处理，告诉 Windows 寻找下一个异常处理函数来处理异常</td>
</tr>
</tbody>
</table>
<p>这里我们通常通过函数实现：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">ExceptionFilter</span><span class="params">(<span class="keyword">int</span> nRet)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (nRet == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> EXCEPTION_EXECUTE_HANDLER;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> EXCEPTION_CONTINUE_SEARCH;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x = <span class="number">50</span>;</span><br><span class="line">	<span class="keyword">int</span> y = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">double</span> z = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Pls. input a number: &quot;</span>;</span><br><span class="line">	cin &gt;&gt; y;</span><br><span class="line"></span><br><span class="line">	__try &#123;</span><br><span class="line">		z = x / y;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;the value is &quot;</span> &lt;&lt; z &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	__except (<span class="built_in">ExceptionFilter</span>(y)) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;could not div 0&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中我们可以通过 <code>GetExceptionCode()</code>
来获取系统所抛出的异常。</p>
<p>在 ida 中我们可以观察到，<code>__excpet</code> 被分析为：</p>
<figure>
<img src="/cexception-note/ida_view.png" alt="ida_view">
<figcaption aria-hidden="true">ida_view</figcaption>
</figure>
<h1 id="windows-veh-向量化异常处理机制">Windows VEH
向量化异常处理机制</h1>
<p>Windows VEH 向量化异常处理机制</p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>c</tag>
        <tag>re</tag>
      </tags>
  </entry>
  <entry>
    <title>PNG有关iDOT块的笔记</title>
    <url>//png-idot-note.html</url>
    <content><![CDATA[<h1 id="idot-块简述">iDOT 块简述</h1>
<p>这是 Apple 为了 PNG 解码速度而做的一个优化 。苹果为了让 PNG
格式的图片可以并行解码并且兼容原本的 PNG
标准，把图片内容分为<strong>前半</strong>与<strong>后半</strong>两部分，并把像素流分为多个
IDAT 块，然后在 PNG 文件里添加了一个 iDOT
辅助块，其中记录了<strong>前半</strong>与<strong>后半</strong>的分隔位置（<strong>后半</strong>数据相对
iDOT 块的偏移值）和解压后的像素高度，这样用 Apple 的 PNG 编码器编码的
PNG 图片用 Apple 自家的 PNG 解码器解码就可以分为 2
个并行的过程，以此充分利用多核性能，同时这样的 PNG
图片也能被普通解码器解码。</p>
<h1 id="在不同设备上显示不同">在不同设备上显示不同</h1>
<p>如果说我们让顺序解压的数据与并行解压后把数据拼一起的内容不一样，那么就可能出现在不同设备上显示不同的结果。</p>
<p>实现的原理非常的巧妙，就是通过利用 <code>zlib</code>
的非压缩块特性：非压缩块标识可以在压缩数据中指定一块区域在解压时忽略掉它。如果把非压缩块标识放到<strong>上半</strong>的末尾,而把被标记的数据放到<strong>下半</strong>的起始，当单独解压<strong>下半</strong>时数据不会被忽略，而<strong>上半</strong>和<strong>下半</strong>连在一起解压时，这些数据就会被忽略，这样就可以让数据在并行压缩被用到而顺序压缩时被忽略。</p>
<p>这个技巧相当的巧妙以至于 Apple 也没有想到，在 Apple
系统（MacOS、iOS）只要利用了系统的 PNG 解码器的软件都会受到影响（MacOS
上 Chrome 浏览器自带 PNG 解码器所以不受影响）。</p>
<p>我们可以使用 <a href="https://github.com/DavidBuchanan314/ambiguous-png-packer">https://github.com/DavidBuchanan314/ambiguous-png-packer</a>
来生成显示不同的图片。</p>
<blockquote>
<p>在现实生成网站：<a href="https://moonvy.com/apps/PNGemini/">https://moonvy.com/apps/PNGemini/</a></p>
</blockquote>
<p>当然，如果想要查看不同设备的图片，那么最好的方法当然是拥有一部<strong>苹果手机</strong>。</p>
<p><strong>特征</strong>：会出现一些杂乱无章的像素线条，这不是技术问题，而是因为原理上是拼接和不解压数据，所以只要是这种构造的图片，都会出现一些像素线条。</p>
<p>如下图：</p>
<figure>
<img src="/png-idot-note/男神.png" alt="男神">
<figcaption aria-hidden="true">男神</figcaption>
</figure>
]]></content>
      <tags>
        <tag>png</tag>
        <tag>note</tag>
      </tags>
  </entry>
  <entry>
    <title>png 图片格式笔记</title>
    <url>//png-note.html</url>
    <content><![CDATA[<h1 id="前文">前文</h1>
<p>PNG
是一种采用无损压缩算法的位图格式，其设计目的是试图替代GIF和TIFF文件格式，同时增加一些GIF文件格式所不具备的特性。PNG
使用从LZ77派生的无损数据压缩算法，原则上会使用 <code>zlib.deflate</code>
将每个数据块的内容进行压缩。</p>
<p>按照标准可以把所有数据存储在一个大的 IDAT 块中，也可以分割存储在多个
IDAT
块中，这原本是为了编码解码时可控内存占用量而设计的，但没有考虑到并行解码，也就是说在对每一个
IDAT 块解压前并不会知道到其中包含了多少像素 。</p>
<p>而与此同时，PNG 也支持动图，即 APNG 格式。</p>
<p>APNG（Animated Portable Network Graphics）是一个基于PNG（Portable
Network Graphics）的位图动画格式，扩展方法类似主要用于网页的GIF
89a，仍对传统PNG保留向下兼容。第1帧是标准的单幅PNG图像，因此只支持原版PNG的软件能正常显示第1帧。剩余的动画帧和帧速数据储存在符合原版PNG标准的扩展数据块里。</p>
<p>但目前来说 Chrome 59、Edge 12、Firefox 3、Opera 46 和 Safari 8
可以查看 APNG，但 Google 并不是很推崇 APNG 格式（他们比较推崇 webp
格式）。</p>
<p>我们可以使用 https://products.aspose.app/imaging/zh-hans/image-view
分离 APNG 的每一帧位图。</p>
<h1 id="signature---文件签名">Signature - 文件签名</h1>
<p>PNG Signature 大小为 8 bytes</p>
<p>十六进制描述为 <code>89 50 4E 47 0D 0A 1A 0A</code></p>
<p>文件特征为 <code>‰PNG</code></p>
<h1 id="chunk---数据块">Chunk - 数据块</h1>
<table>
<colgroup>
<col style="width: 30%">
<col style="width: 10%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th><strong>名称</strong></th>
<th><strong>字节数</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Length (长度)</td>
<td>4</td>
<td>指定数据块中数据域的长度，其长度不超过 (<span class="math inline">\(2^{31}－1\)</span>) 字节</td>
</tr>
<tr class="even">
<td>Chunk Type Code (数据块类型码)</td>
<td>4</td>
<td>数据块类型码由 ASCII 字母 (A-Z 和 a-z) 组成</td>
</tr>
<tr class="odd">
<td>Chunk Data (数据块数据)</td>
<td>Length</td>
<td>存储按照 Chunk Type Code 指定的数据</td>
</tr>
<tr class="even">
<td>CRC (循环冗余检测)</td>
<td>4</td>
<td>存储用来检测是否有错误的循环冗余码</td>
</tr>
</tbody>
</table>
<p>PNG 被分为一个个 Chunk，每个 Chunk
有相同的格式，但存放着不同的数据。</p>
<h2 id="png-数据块">PNG 数据块</h2>
<table>
<colgroup>
<col style="width: 14%">
<col style="width: 22%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th><strong>数据块符号</strong></th>
<th><strong>数据块名称</strong></th>
<th><strong>多数据块</strong></th>
<th><strong>可选否</strong></th>
<th><strong>位置限制</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>IHDR</code></td>
<td>文件头数据块</td>
<td>否</td>
<td>否</td>
<td>第一块</td>
</tr>
<tr class="even">
<td><code>cHRM</code></td>
<td>基色和白色点数据块</td>
<td>否</td>
<td>是</td>
<td>在<code>PLTE</code>和<code>IDAT</code>之前</td>
</tr>
<tr class="odd">
<td><code>gAMA</code></td>
<td>图像γ数据块</td>
<td>否</td>
<td>是</td>
<td>在<code>PLTE</code>和<code>IDAT</code>之前</td>
</tr>
<tr class="even">
<td><code>iCCP</code></td>
<td>辅助数据块</td>
<td>是</td>
<td>是</td>
<td>在<code>PLTE</code>之后<code>IDAT</code>之前
(存在则无<code>sRGB</code>)</td>
</tr>
<tr class="odd">
<td><code>sBIT</code></td>
<td>样本有效位数据块</td>
<td>否</td>
<td>是</td>
<td>在<code>PLTE</code>和<code>IDAT</code>之前</td>
</tr>
<tr class="even">
<td><code>sRGB</code></td>
<td>标准RPG颜色</td>
<td>否</td>
<td>是</td>
<td>在<code>PLTE</code>之后<code>IDAT</code>之前
(与<code>iCCP</code>冲突)</td>
</tr>
<tr class="odd">
<td><code>PLTE</code></td>
<td>调色板数据块</td>
<td>否</td>
<td>是</td>
<td>在<code>IDAT</code>之前</td>
</tr>
<tr class="even">
<td><code>bKGD</code></td>
<td>背景颜色数据块</td>
<td>否</td>
<td>是</td>
<td>在<code>PLTE</code>之后<code>IDAT</code>之前</td>
</tr>
<tr class="odd">
<td><code>hIST</code></td>
<td>图像直方图数据块</td>
<td>否</td>
<td>是</td>
<td>在<code>PLTE</code>之后<code>IDAT</code>之前</td>
</tr>
<tr class="even">
<td><code>tRNS</code></td>
<td>图像透明数据块</td>
<td>否</td>
<td>是</td>
<td>在<code>PLTE</code>之后<code>IDAT</code>之前</td>
</tr>
<tr class="odd">
<td><code>oFFs</code></td>
<td>(专用公共数据块)</td>
<td>否</td>
<td>是</td>
<td>在<code>IDAT</code>之前</td>
</tr>
<tr class="even">
<td><code>pHYs</code></td>
<td>物理像素尺寸数据块</td>
<td>否</td>
<td>是</td>
<td>在<code>IDAT</code>之前</td>
</tr>
<tr class="odd">
<td><code>sCAL</code></td>
<td>(专用公共数据块)</td>
<td>否</td>
<td>是</td>
<td>在<code>IDAT</code>之前</td>
</tr>
<tr class="even">
<td><code>IDAT</code></td>
<td>图像数据块</td>
<td>是</td>
<td>否</td>
<td>与其他<code>IDAT</code>连续</td>
</tr>
<tr class="odd">
<td><code>tIME</code></td>
<td>图像最后修改时间数据块</td>
<td>否</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr class="even">
<td><code>tEXt</code></td>
<td>文本信息数据块</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr class="odd">
<td><code>zTXt</code></td>
<td>压缩文本数据块</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr class="even">
<td><code>fRAc</code></td>
<td>(专用公共数据块)</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr class="odd">
<td><code>gIFg</code></td>
<td>(专用公共数据块)</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr class="even">
<td><code>gIFt</code></td>
<td>(专用公共数据块)</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr class="odd">
<td><code>gIFx</code></td>
<td>(专用公共数据块)</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr class="even">
<td><code>IEND</code></td>
<td>图像结束数据</td>
<td>否</td>
<td>否</td>
<td>最后一个数据块</td>
</tr>
</tbody>
</table>
<blockquote>
<p>详情可查询 https://www.w3.org/TR/PNG/</p>
</blockquote>
<h2 id="apng-数据块">APNG 数据块</h2>
<table>
<colgroup>
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 19%">
<col style="width: 16%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th><strong>数据块符号</strong></th>
<th><strong>数据块名称</strong></th>
<th><strong>多数据块</strong></th>
<th><strong>可选否</strong></th>
<th><strong>位置限制</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>acTL</code></td>
<td>动画控制块</td>
<td>否</td>
<td>否</td>
<td><code>IHDR</code>之后</td>
</tr>
<tr class="even">
<td><code>fcTL</code></td>
<td>帧控制块</td>
<td>否</td>
<td>否</td>
<td><code>IHDR</code>之后</td>
</tr>
<tr class="odd">
<td><code>fdAT</code></td>
<td>帧数据块</td>
<td>否</td>
<td>否</td>
<td><code>IHDR</code>之后</td>
</tr>
</tbody>
</table>
<blockquote>
<p>详情可查询 https://wiki.mozilla.org/APNG_Specification</p>
</blockquote>
<h2 id="ios-特有的数据块">IOS 特有的数据块</h2>
<table style="width:100%;">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th><strong>数据块符号</strong></th>
<th><strong>数据块名称</strong></th>
<th><strong>多数据块</strong></th>
<th><strong>可选否</strong></th>
<th><strong>位置限制</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>iDOT</code></td>
<td>并行解析数据块</td>
<td>否</td>
<td>是</td>
<td><code>IHDR</code>之后<code>IDAT</code>之前</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Apple 并未公开</p>
</blockquote>
<h2 id="ihdr">IHDR</h2>
<table>
<colgroup>
<col style="width: 24%">
<col style="width: 12%">
<col style="width: 63%">
</colgroup>
<thead>
<tr class="header">
<th><strong>域的名称</strong></th>
<th><strong>字节数</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Width</code></td>
<td>4</td>
<td>图像宽度，以像素为单位</td>
</tr>
<tr class="even">
<td><code>Height</code></td>
<td>4</td>
<td>图像高度，以像素为单位</td>
</tr>
<tr class="odd">
<td><code>Bit depth</code></td>
<td>1</td>
<td>图像深度，详情查看下表</td>
</tr>
<tr class="even">
<td><code>Color type</code></td>
<td>1</td>
<td>颜色类型，详情查看下表</td>
</tr>
<tr class="odd">
<td><code>Compression method</code></td>
<td>1</td>
<td>压缩方法 (LZ77派生算法，原则上默认为 <code>zlib.deflate</code>)</td>
</tr>
<tr class="even">
<td><code>Filter method</code></td>
<td>1</td>
<td>滤波器方法</td>
</tr>
<tr class="odd">
<td><code>Interlace method</code></td>
<td>1</td>
<td>隔行扫描方法：0则表示非隔行扫描 ；1则表示 Adam7</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th>Color type 值</th>
<th>含义</th>
<th>Bit depth 值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>灰度图像</td>
<td>1，2，4，8 或 16</td>
</tr>
<tr class="even">
<td>2</td>
<td>真彩色图像</td>
<td>8 或 16</td>
</tr>
<tr class="odd">
<td>3</td>
<td>索引彩色图像</td>
<td>1，2，4 或 8</td>
</tr>
<tr class="even">
<td>4</td>
<td>带<span class="math inline">\(\alpha\)</span>通道数据的灰度图像</td>
<td>8 或 16</td>
</tr>
<tr class="odd">
<td>6</td>
<td>带<span class="math inline">\(\alpha\)</span>通道数据的真彩色图像</td>
<td>8 或 16</td>
</tr>
</tbody>
</table>
<h2 id="iend">IEND</h2>
<p>一般来说，IEND 数据块的长度总是 0，十六进制描述总是：</p>
<p><code>00 00 00 00 49 45 4E 44 AE 42 60 82</code></p>
<h2 id="idot">iDOT</h2>
<p>这是 Apple 为了 PNG 解码速度而做的一个优化 。苹果为了让 PNG
格式的图片可以并行解码并且兼容原本的 PNG
标准，把图片内容分为<strong>前半</strong>与<strong>后半</strong>两部分，并把像素流分为多个
IDAT 块，然后在 PNG 文件里添加了一个 iDOT
辅助块，其中记录了<strong>前半</strong>与<strong>后半</strong>的分隔位置（<strong>后半</strong>数据相对
iDOT 块的偏移值）和解压后的像素高度，这样用 Apple 的 PNG 编码器编码的
PNG 图片用 Apple 自家的 PNG 解码器解码就可以分为 2
个并行的过程，以此充分利用多核性能，同时这样的 PNG
图片也能被普通解码器解码。</p>
<p>但其存在一个 bug，详情可以查看文章：<a href="/png-idot-note.html">PNG有关iDOT块的笔记</a></p>
]]></content>
      <tags>
        <tag>png</tag>
        <tag>note</tag>
      </tags>
  </entry>
  <entry>
    <title>字节序笔记</title>
    <url>//endian-note.html</url>
    <content><![CDATA[<h1 id="字节序简述">字节序简述</h1>
<p>字节序，即<strong>字节的存储顺序</strong>，而计算机硬件有两种存储数据的方式：大端字节序
(big-endian) 和 小端字节序 (little endian)。</p>
<p>一般来说，计算机硬件的存储方式都是<strong>小端字节序</strong>；</p>
<p>而网络数据包为了可读性更高，会选择<strong>大端字节序</strong>。</p>
<p>从地址低端向地址高端，小端字节序是将多字节数据按<strong>从低位到高位</strong>的顺序存储；而大端字节序是将多字节数据按<strong>从高位到低位</strong>的顺序存储。</p>
<p>例如 <code>0x01234567</code> 的两种字节序存储方式如下图：</p>
<figure>
<img src="/endian-note/字节序.png" alt="0x01234567的字节序">
<figcaption aria-hidden="true">0x01234567的字节序</figcaption>
</figure>
<p>一般来说，只有在数据交换和读取数据的时候才需要注意字节序，例如
PowerPC 的数据转换成 Windows
下的数据的时候需要注意字节序问题；或是数据包数据的转换 (比如说C语言里的
<code>htons</code> 函数可以将主机字节顺序转变成网络字节顺序)。</p>
<h1 id="c-实现">C++ 实现</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">WORD <span class="title">littleEndianToWord</span><span class="params">(<span class="keyword">const</span> BYTE* a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (a[<span class="number">0</span>] &lt;&lt; <span class="number">8</span>) | (a[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD <span class="title">littleEndianToDword</span><span class="params">(<span class="keyword">const</span> BYTE* a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (a[<span class="number">0</span>] &lt;&lt; <span class="number">24</span>) | (a[<span class="number">1</span>] &lt;&lt; <span class="number">16</span>) | (a[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | (a[<span class="number">3</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>对于大端字节序转储，在C++中直接使用强制类型转换即可。</p>
</blockquote>
<h1 id="python-实现">python 实现</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">littleEndianToDword</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="built_in">str</span>(a[<span class="number">0</span>])+<span class="built_in">str</span>(a[<span class="number">1</span>])+<span class="built_in">str</span>(a[<span class="number">2</span>])+<span class="built_in">str</span>(a[<span class="number">3</span>]), <span class="number">16</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bigEndianToDword</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="built_in">str</span>(a[-<span class="number">1</span>])+<span class="built_in">str</span>(a[-<span class="number">2</span>])+<span class="built_in">str</span>(a[-<span class="number">3</span>])+<span class="built_in">str</span>(a[-<span class="number">4</span>]), <span class="number">16</span>)</span><br></pre></td></tr></table></figure>
<p>同时 python 也存在函数可以将大端字节序的 <code>bytes</code>
数组转储为 <code>int</code> 型数据</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span>.from_bytes(<span class="string">b&#x27;&#x27;</span>, <span class="string">&#x27;big&#x27;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
      </tags>
  </entry>
  <entry>
    <title>ctf-flag 笔记</title>
    <url>//flag-note.html</url>
    <content><![CDATA[<h1 id="flag-简述">flag 简述</h1>
<p>flag 英文单词愿意为旗帜，在 CTF
比赛中是我们的目标，通常以一串字符串的形式存在，满足正则表达式：<code>flag&#123;.*&#125;</code></p>
<p>其中不一定以 flag 开头，可能是以比赛名称开头，例如
<code>TQLCTF&#123;.*&#125;</code>；也有可能是以某个组织的名称开头，例如
<code>BUUCTF&#123;.*&#125;</code></p>
<p>而且 flag
又分为<strong>动态flag</strong>和<strong>静态flag</strong>，记得最好不要去提交他人的
flag 哦！</p>
<h1 id="flag-转义器">flag 转义器</h1>
<p>自己手写的简单的 flag 转义器，一是为了方便自己认读
flag，二是为了方便自己写的 flag 像 flag。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">table = (<span class="string">&#x27;Aa4@&#x27;</span>, <span class="string">&#x27;Bb8&#x27;</span>, <span class="string">&#x27;Cc&#x27;</span>, <span class="string">&#x27;Dd&#x27;</span>, <span class="string">&#x27;Ee3&#x27;</span>, <span class="string">&#x27;Ff&#x27;</span>, <span class="string">&#x27;Gg69&#x27;</span>, <span class="string">&#x27;Hh&#x27;</span>, <span class="string">&#x27;Ii&#x27;</span>, <span class="string">&#x27;Jj&#x27;</span>, <span class="string">&#x27;Kk&#x27;</span>, <span class="string">&#x27;Ll1&#x27;</span>, <span class="string">&#x27;Mm&#x27;</span>, <span class="string">&#x27;Nn&#x27;</span>, <span class="string">&#x27;Oo0&#x27;</span>, <span class="string">&#x27;Pp&#x27;</span>, <span class="string">&#x27;Qq&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;Rr&#x27;</span>, <span class="string">&#x27;Ss5$&#x27;</span>, <span class="string">&#x27;Tt7&#x27;</span>, <span class="string">&#x27;Uu&#x27;</span>, <span class="string">&#x27;Vv&#x27;</span>, <span class="string">&#x27;Ww&#x27;</span>, <span class="string">&#x27;Xx&#x27;</span>, <span class="string">&#x27;Yy&#x27;</span>, <span class="string">&#x27;Zz2&#x27;</span>)</span><br><span class="line">alpha = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findalpha</span>(<span class="params">ch</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        <span class="keyword">if</span> ch <span class="keyword">in</span> table[i]:</span><br><span class="line">            <span class="keyword">return</span> alpha[i]</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flag2plain</span>(<span class="params">flag : <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">    start = flag.index(<span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">    plain = flag[:start+<span class="number">1</span>]</span><br><span class="line">    flag = flag[start+<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">        c = findalpha(i)</span><br><span class="line">        <span class="keyword">if</span> c:</span><br><span class="line">            plain += c</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plain += i</span><br><span class="line">    <span class="keyword">return</span> plain+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plain2flag</span>(<span class="params">plain : <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">    random.seed(plain.encode())</span><br><span class="line">    start = plain.index(<span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">    flag = plain[:start+<span class="number">1</span>]</span><br><span class="line">    plain = <span class="built_in">str</span>.lower(plain[start+<span class="number">1</span>:-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> plain:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> alpha:</span><br><span class="line">            idx = alpha.index(i)</span><br><span class="line">            k = random.randrange(<span class="number">0</span>, <span class="built_in">len</span>(table[idx]))</span><br><span class="line">            flag += table[idx][k]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag += i</span><br><span class="line">    <span class="keyword">return</span> flag+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">s = plain2flag(<span class="string">&quot;flag&#123;This_is_flag&#125;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">s = flag2plain(s)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>栅栏密码笔记</title>
    <url>//rail-fence-cipher-note.html</url>
    <content><![CDATA[<h1 id="普通栅栏算法">普通栅栏算法</h1>
<h2 id="加密算法描述">加密算法描述</h2>
<ol type="1">
<li><p>现有明文 <code>Thi5_1s_a_fl4g</code>，对其进行两两分组得到：</p>
<p><code>Th</code>、<code>i5</code>、<code>_1</code>、<code>s_</code>、<code>a_</code>、<code>fl</code>、<code>4g</code></p></li>
<li><p>然后取每组的第 1 个字符连成第一段，每组的第 2
个字符连成第二段，最后得到：</p>
<p><code>Ti_saf4</code>、<code>h51__lg</code></p></li>
<li><p>将以上多段组合起来，得到密文：</p>
<p><code>Ti_saf4h51__lg</code></p></li>
</ol>
<p>从以上可以看出，普通栅栏算法当明文过于简单、分组个数较小和加密轮数低时，容易被直接破解。</p>
<h2 id="解密算法描述">解密算法描述</h2>
<ol type="1">
<li><p>现有密文
<code>Ti_saf4h51__lg</code>，已知加密时是两两分组，我们便将其分为两段
(或者理解为密文长度为 10，加密用的是因数 2 进行分组，则解密使用因数 5
进行分组)：</p>
<p><code>Ti_saf4</code>、<code>h51__lg</code></p></li>
<li><p>然后取每组的第 1 个字符连成第一段，每组的第 2
个字符连成第二段，最后得到：</p>
<p><code>Th</code>、<code>i5</code>、<code>_1</code>、<code>s_</code>、<code>a_</code>、<code>fl</code>、<code>4g</code></p></li>
<li><p>将以上多段组合起来，得到明文：</p>
<p><code>Thi5_1s_a_fl4g</code></p></li>
</ol>
<p>从以上可以看出，普通栅栏算法可以采用同一个函数进行加解密，只是投入的密钥不相同。</p>
<h2 id="算法定义">算法定义</h2>
<p>通过以上算法描述，我们可以做出以下简单定义：</p>
<blockquote>
<p>将明文分成 <span class="math inline">\(k\)</span> 组，取每一组的第
<span class="math inline">\(n\)</span>
个字符连成一段，最后再将各段连接得到密文。</p>
</blockquote>
<p>同时可知栅栏密码本质上是一个换位密码，并不改变明文信息，只改变明文顺序，理论上复杂度只取决于<strong>明文字长</strong>、<strong>分组个数</strong>和<strong>加密轮数</strong>。</p>
<p>栅栏算法可以如下定义，其中<span class="math inline">\(m\)</span>为明文，<span class="math inline">\(c\)</span>为密文，<span class="math inline">\(length\)</span>为明文（密文）长度，<span class="math inline">\(F(x,y)\)</span>为普通栅栏算法： <span class="math display">\[
length=pq(p,q\in\Z)\\
c=F(m,p)\\
m=F(c,q)
\]</span> 以上我们可以称<span class="math inline">\(p\)</span>为私钥
(private key)，而<span class="math inline">\(q\)</span>为公钥 (public
key)</p>
<h2 id="算法实现">算法实现</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">railfence</span>(<span class="params">data:<span class="built_in">str</span>, key:<span class="built_in">int</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(data[i::key] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key))</span><br></pre></td></tr></table></figure>
<p>其中我们也可以实现对密文进行爆破的算法：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">railfence</span>(<span class="params">data:<span class="built_in">str</span>, key:<span class="built_in">int</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(data[i::key] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取 x 的所有因数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factor</span>(<span class="params">x:<span class="built_in">int</span></span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, math.floor(math.sqrt(x))):</span><br><span class="line">        <span class="keyword">if</span> x % i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">yield</span> i</span><br><span class="line">            <span class="keyword">yield</span> x // i</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack</span>(<span class="params">data:<span class="built_in">str</span>, needkeys:<span class="built_in">bool</span>=<span class="literal">False</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> needkeys:</span><br><span class="line">        facs = [i <span class="keyword">for</span> i <span class="keyword">in</span> factor(<span class="built_in">len</span>(data))]</span><br><span class="line">        <span class="keyword">return</span> facs, [railfence(data, i) <span class="keyword">for</span> i <span class="keyword">in</span> facs]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> [railfence(data, i) <span class="keyword">for</span> i <span class="keyword">in</span> factor(<span class="built_in">len</span>(data))]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_crack</span>(<span class="params">data:<span class="built_in">str</span></span>):</span></span><br><span class="line">    keys, msg = crack(data, <span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> k, m <span class="keyword">in</span> <span class="built_in">zip</span>(keys, msg):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;k&#125;</span>栏: <span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">print_crack(<span class="string">&quot;Ti_saf4h51__lg&quot;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="密钥栅栏算法">密钥栅栏算法</h1>
<h2 id="加密算法描述-1">加密算法描述</h2>
<ol type="1">
<li><p>现有明文
<code>Thi5_1s_a_fl4g</code>，对其每七个为一组分组得到：</p>
<p><code>Thi5_1s</code>、<code>_a_fl4g</code></p></li>
<li><p>然后取每组的第 1 个字符连成第一段，每组的第 2
个字符连成第二段，最后得到：</p>
<p><code>T_</code>、<code>ha</code>、<code>i_</code>、<code>5f</code>、<code>_l</code>、<code>14</code>、<code>sg</code></p></li>
<li><p>密钥即是组合顺序，现有密钥
<code>3127645</code>，则组合的密文为：</p>
<p><code>i_T_hasg145f_l</code></p></li>
</ol>
<p>可以看出，相比起普通栅栏算法，更难看出明文原本的顺序，但始终受制于<strong>明文字长</strong>、<strong>分组个数</strong>和<strong>加密轮数</strong>，与密钥复杂度不呈现相关性。</p>
<h2 id="解密算法描述-1">解密算法描述</h2>
<ol type="1">
<li><p>现有密文 <code>i_T_hasg145f_l</code>，按照密钥
<code>3127645</code> 还原各段：</p>
<p><code>T_</code>、<code>ha</code>、<code>i_</code>、<code>5f</code>、<code>_l</code>、<code>14</code>、<code>sg</code></p></li>
<li><p>然后取每段的第 1 个字符连成第一组，每段的第 2
个字符连成第二组，最后得到：</p>
<p><code>Thi5_1s</code>、<code>_a_fl4g</code></p></li>
<li><p>将以上多段组合起来，得到明文：</p>
<p><code>Thi5_1s_a_fl4g</code></p></li>
</ol>
<p>可以看出，相比起普通栅栏算法，还原明文时受制于密钥，如果不掌握密钥恢复的可能性将大大降低。</p>
<h2 id="算法实现-1">算法实现</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">railfence_plus_encode</span>(<span class="params">data:<span class="built_in">str</span>, key:<span class="built_in">list</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([data[i::<span class="built_in">len</span>(key)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key))][i-<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> key)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">railfence_plus_decode</span>(<span class="params">data:<span class="built_in">str</span>, key:<span class="built_in">list</span></span>):</span></span><br><span class="line">    k = <span class="built_in">len</span>(data)//<span class="built_in">len</span>(key)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([data[key.index(i+<span class="number">1</span>)*k + j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key))])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(railfence_plus_encode(<span class="string">&quot;Thi5_1s_a_fl4g&quot;</span>, [<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">5</span>]))</span><br><span class="line"><span class="built_in">print</span>(railfence_plus_decode(<span class="string">&quot;i_T_hasg145f_l&quot;</span>, [<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">5</span>]))</span><br></pre></td></tr></table></figure>
<p>理论上，我们可以对密文进行爆破，仅需得到密钥的全排列即可 (可以使用
<code>itertools.permutations</code>)</p>
<h1 id="w型栅栏算法">W型栅栏算法</h1>
<h2 id="算法描述">算法描述</h2>
<p>将明文按w型排列，然后将每一行的字母依次连起来组成密文，行数就是密钥。</p>
<p>解密则同样画出这个w型图案，将每一列的字母依次连接起来组成明文。</p>
<p>W型栅栏密码的密钥不只是密文长度的因数，任何小于密文长度大于1的整数都有可能。</p>
<h2 id="算法实现-2">算法实现</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 获取 w 型矩阵</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">railfence_w</span>(<span class="params">data:<span class="built_in">str</span>, key:<span class="built_in">int</span></span>):</span></span><br><span class="line">    mat = [[<span class="literal">None</span>]*<span class="built_in">len</span>(data) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key)]</span><br><span class="line">    row = <span class="number">0</span></span><br><span class="line">    upflag = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        mat[row][col] = data[col]</span><br><span class="line">        <span class="keyword">if</span> row == key-<span class="number">1</span>:</span><br><span class="line">            upflag = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> row == <span class="number">0</span>:</span><br><span class="line">            upflag = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> upflag:</span><br><span class="line">            row -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            row += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> mat</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">railfence_w_encode</span>(<span class="params">data, key</span>):</span></span><br><span class="line">    mat = railfence_w(data, key)</span><br><span class="line">    msg = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(key):</span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">            <span class="keyword">if</span> mat[row][col] != <span class="literal">None</span>:</span><br><span class="line">                msg.append(mat[row][col])</span><br><span class="line">    <span class="keyword">return</span> mat, msg</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">railfence_w_decode</span>(<span class="params">data, key</span>):</span></span><br><span class="line">    mat = railfence_w(data, key)</span><br><span class="line">    sub = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(key):</span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">            <span class="keyword">if</span> mat[row][col] != <span class="literal">None</span>:</span><br><span class="line">                mat[row][col] = data[sub]</span><br><span class="line">                sub += <span class="number">1</span></span><br><span class="line">    msg = []</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(key):</span><br><span class="line">            <span class="keyword">if</span> mat[row][col] != <span class="literal">None</span>:</span><br><span class="line">                msg.append(mat[row][col])</span><br><span class="line">    <span class="keyword">return</span> mat, msg</span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆破算法</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_w</span>(<span class="params">data:<span class="built_in">str</span>, needkeys:<span class="built_in">bool</span>=<span class="literal">False</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> needkeys:</span><br><span class="line">        keys = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">len</span>(data))]</span><br><span class="line">        <span class="keyword">return</span> keys, [<span class="string">&#x27;&#x27;</span>.join(railfence_w_decode(data, k)[<span class="number">1</span>]) <span class="keyword">for</span> k <span class="keyword">in</span> keys]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> [<span class="string">&#x27;&#x27;</span>.join(railfence_w_decode(data, k)[<span class="number">1</span>]) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">len</span>(data))]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_crack_w</span>(<span class="params">data:<span class="built_in">str</span></span>):</span></span><br><span class="line">    keys, msg = crack_w(data, <span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> k, m <span class="keyword">in</span> <span class="built_in">zip</span>(keys, msg):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;k&#125;</span>栏: <span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">print_crack_w(<span class="string">&quot;ccehgyaefnpeoobe&#123;lcirg&#125;epriec_ora_g&quot;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>sagemath 入门笔记</title>
    <url>//sagemath-get-started.html</url>
    <content><![CDATA[<h1 id="sagemath-简述">Sagemath 简述</h1>
<p>Sage（或称SageMath）是在GPL协议下发布的开源数学软件，并且整合了许多已有的开源软件包到一个基于Python的统一界面下。其目标是创造一个Magma,
Maple, Mathematica 和 Matlab 的开源替代品。</p>
<p>Sage
包含了从线性代数、微积分，到密码学、数值计算、组合数学、群论、图论、数论等各种初高等数学的计算功能。</p>
<p>虽然 Sage 想要取代 Matlab，但使用上还是有一定的局限性。</p>
<p>现在的 Sage 版本是基于 Python3 的。</p>
<h1 id="sagemath-安装">Sagemath 安装</h1>
<p>在 <a href="https://www.sagemath.org/download.html">https://www.sagemath.org/download.html</a>
中选择相应的安装程序下载并安装。</p>
<h2 id="windows-sage">Windows &amp; Sage</h2>
<p>Sage 不在官网中提供 Windows 的二进制文件下载，需要在其 github
官方发布页中下载：</p>
<p><a href="https://github.com/sagemath/sage-windows/releases">https://github.com/sagemath/sage-windows/releases</a></p>
<p>选择自己需要的版本，下载：</p>
<figure>
<img src="/sagemath-get-started/Sage%20Assets.png" alt="Sage Assets">
<figcaption aria-hidden="true">Sage Assets</figcaption>
</figure>
<figure>
<img src="/sagemath-get-started/Sage%20Setup.png" alt="Sage Setup">
<figcaption aria-hidden="true">Sage Setup</figcaption>
</figure>
<p>安装过程中特别注意 <code>home directory</code> 的选择，这将决定 Sage
Shell 的初始工作目录：</p>
<figure>
<img src="/sagemath-get-started/sagehome.png" alt="sagehome">
<figcaption aria-hidden="true">sagehome</figcaption>
</figure>
<p>还有 <code>Destination Location</code> 即安装目录：</p>
<figure>
<img src="/sagemath-get-started/sagedestination.png" alt="sagedestination">
<figcaption aria-hidden="true">sagedestination</figcaption>
</figure>
<p>其他选项可以按默认配置进行。</p>
<h1 id="sagemath-使用">Sagemath 使用</h1>
<p>现在在 Sage <code>home directory</code> 目录下编写一个
<code>.sage</code> 脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hello world&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>我们打开 <code>SageMath 9.3 Shell</code>，输入 <code>ls</code>
可以查看到我们刚刚编写的脚本文件：</p>
<figure>
<img src="/sagemath-get-started/Sage%20Shell%20-%20ls.png" alt="Sage Shell - ls">
<figcaption aria-hidden="true">Sage Shell - ls</figcaption>
</figure>
<p>使用指令 <code>sage hello.sage</code> 尝试运行我们的脚本：</p>
<figure>
<img src="/sagemath-get-started/Sage%20Shell%20-%20helloworld.png" alt="Sage Shell - helloworld">
<figcaption aria-hidden="true">Sage Shell - helloworld</figcaption>
</figure>
<p>成功运行即可！</p>
<p>同时我们也可以使用另一种方式运行我们的脚本：交互式 Shell</p>
<p>我们运行
<code>SageMath 9.3</code>，第一次运行可能加载较慢，如下图所示：</p>
<figure>
<img src="/sagemath-get-started/Sage%20Console.png" alt="Sage Console">
<figcaption aria-hidden="true">Sage Console</figcaption>
</figure>
<p>其是基于 iPython 而定制的交互式 Shell，我们可以使用 Sage 内置函数
<code>load(filepath)</code> 来运行我们的脚本：</p>
<figure>
<img src="/sagemath-get-started/Sage%20Console%20-%20load.png" alt="Sage Console - load">
<figcaption aria-hidden="true">Sage Console - load</figcaption>
</figure>
<p>如果对于一些运算量较大的脚本，我们可以使用 Sagecell
在线运行我们的脚本得到结果：</p>
<p><a href="https://sagecell.sagemath.org/">https://sagecell.sagemath.org/</a></p>
<h1 id="sage-windows-python3.7">Sage-windows &amp; Python3.7</h1>
<p>Sage-windows 实际上是基于 Cygwin 运行的 Python3.7 脚本。</p>
<p>想要使用 Python3.7 的其他包，我们需要手动使用 <code>pip3</code>
进行安装，但这里提供一个更加快捷的方式：找到本地的 Python3
根目录，将根目录下的 <code>Lib\site-packages</code> 文件夹复制后粘贴到
Sage 根目录下的 <code>runtime\lib\python3.7\site-packages</code></p>
<p>这样相当于快速重新安装一遍已有的 Python
库，但推荐更稳妥的方式还是自己手动重新安装一遍所需要的库 (一般 Sage
已经安装了绝大多数需要使用到的库了)。</p>
<p>然后我们再在 <code>SageMath 9.3 Console</code> 中运行以下脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pkg_resources</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> call</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> packages <span class="keyword">in</span> [dist.project_name <span class="keyword">for</span> dist <span class="keyword">in</span> pkg_resources.working_set]:</span><br><span class="line">    call(<span class="string">&quot;pip3 install --upgrade &quot;</span> + <span class="string">&#x27;&#x27;</span>.join(packages), shell=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>以便快速更新所有脚本。</p>
<h2 id="sagemath-console">SageMath Console</h2>
<p><code>SageMath Console</code> 可以认为是 Sagemath 的一个交互式
iPython。</p>
<h2 id="sagemath-shell">SageMath Shell</h2>
<p><code>SageMath Shell</code> 可以认为是基于 Windows 的 Cygwin
运行的一个终端，内置了许多有用的软件。</p>
<h2 id="sagemath-notebook">SageMath Notebook</h2>
<p><code>SageMath Notebook</code> 是一个基于 <strong>jupyter</strong>
的交互式 web 终端，打开后会开启一个本地 web 服务器方便使用 Sage。</p>
<p>具体的使用可以参考文章：<a href="https://zhuanlan.zhihu.com/p/297736314">https://zhuanlan.zhihu.com/p/297736314</a></p>
<h1 id="sagemath-更多">SageMath 更多</h1>
<p>更多有关 SageMath 的知识可以<a href="/tags/sagemath/">点击此处</a>查看本博客其他有关 SageMath
的文章。</p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>sagemath</tag>
      </tags>
  </entry>
  <entry>
    <title>pwntools 笔记</title>
    <url>//pwntools-note.html</url>
    <content><![CDATA[<h1 id="pwntools-简述">Pwntools 简述</h1>
<p>Pwntools 是一个 CTF 框架和漏洞利用开发库。</p>
<p>它是用 Python
编写的，专为快速原型设计和开发而设计，旨在使漏洞利用编写尽可能简单。</p>
<p>我们可以使用 pip 包管理工具安装 <code>pwntools</code>：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip3 install pwntools</span><br></pre></td></tr></table></figure>
<p>pwntools 需要及时使用最新版，我们可以使用以下命令对 pwntools
更新：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 -m pip install --upgrade pwntools</span><br></pre></td></tr></table></figure>
<h1 id="pwntools-详解">Pwntools 详解</h1>
<h2 id="pwntools-模块索引"><code>pwntools</code> 模块索引</h2>
<table>
<colgroup>
<col style="width: 31%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th>模块名称</th>
<th>模块功能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pwnlib.adb</code></td>
<td>adb 调试桥的封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.args</code></td>
<td>包含命令行参数的一些配置 (包含这个包后会自动从命令行中获取参数)</td>
</tr>
<tr class="odd">
<td><code>pwnlib.asm</code></td>
<td>通过 capstone 进行汇编的编译和反编译等功能的封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.atexception</code></td>
<td>包含未处理异常的回调函数</td>
</tr>
<tr class="odd">
<td><code>pwnlib.atexit</code></td>
<td>atexit 的替代品</td>
</tr>
<tr class="even">
<td><code>pwnlib.constants</code></td>
<td>头文件宏定义的封装，可以通过这个模块直接获取系统宏定义常数</td>
</tr>
<tr class="odd">
<td><code>pwnlib.config</code></td>
<td>Pwntools 配置变量</td>
</tr>
<tr class="even">
<td><code>pwnlib.context</code></td>
<td>包含运行时变量，上下文管理器</td>
</tr>
<tr class="odd">
<td><code>pwnlib.dynelf</code></td>
<td>通过内存 leak 数据自动化定位程序中函数位置</td>
</tr>
<tr class="even">
<td><code>pwnlib.encoders</code></td>
<td>Shellcode 编码工具封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.elf.config</code></td>
<td>elf 核心配置</td>
</tr>
<tr class="even">
<td><code>pwnlib.elf.corefile</code></td>
<td>elf 核心文件转储功能</td>
</tr>
<tr class="odd">
<td><code>pwnlib.elf.elf</code></td>
<td>elf 文件操作封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.exception</code></td>
<td>Pwnlib 异常</td>
</tr>
<tr class="odd">
<td><code>pwnlib.filepointer</code></td>
<td>FILE* 结构体封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.filesystem</code></td>
<td>通过 SSH 为本地文件系统和远程文件系统上的路径提供 Python2
的兼容接口</td>
</tr>
<tr class="odd">
<td><code>pwnlib.flag</code></td>
<td>CTF Flag 管理</td>
</tr>
<tr class="even">
<td><code>pwnlib.fmtstr</code></td>
<td>格式化字符串漏洞利用封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.gdb</code></td>
<td>GDB 调试封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.libcdb</code></td>
<td>Libc 数据库，可以通过一些信息查找对应的地址</td>
</tr>
<tr class="odd">
<td><code>pwnlib.log</code></td>
<td>日志库，跟 Pwntools 的操作</td>
</tr>
<tr class="even">
<td><code>pwnlib.memleak</code></td>
<td>内存泄漏管理工具</td>
</tr>
<tr class="odd">
<td><code>pwnlib.qemu</code></td>
<td>QEMU 适用工具封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.replacements</code></td>
<td>一些标准函数的替代品</td>
</tr>
<tr class="odd">
<td><code>pwnlib.rop.ret2dlresolve</code></td>
<td>提供缓冲区溢出利用的负载自动化生成工具</td>
</tr>
<tr class="even">
<td><code>pwnlib.rop.rop</code></td>
<td>ROP 生成工具，可以直接生成 32 位 ROP</td>
</tr>
<tr class="odd">
<td><code>pwnlib.rop.srop</code></td>
<td>Sigreturn 相关的利用封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.runner</code></td>
<td>Shellcode 运行封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.shellcraft</code></td>
<td>Shellcode 生成工具</td>
</tr>
<tr class="even">
<td><code>pwnlib.shellcraft.aarch64</code></td>
<td>Shellcode for AArch64</td>
</tr>
<tr class="odd">
<td><code>pwnlib.shellcraft.amd64</code></td>
<td>Shellcode for AMD64</td>
</tr>
<tr class="even">
<td><code>pwnlib.shellcraft.arm</code></td>
<td>Shellcode for ARM</td>
</tr>
<tr class="odd">
<td><code>pwnlib.shellcraft.common</code></td>
<td>Shellcode 所有架构的基本利用</td>
</tr>
<tr class="even">
<td><code>pwnlib.shellcraft.i386</code></td>
<td>Shellcode for Intel 80386</td>
</tr>
<tr class="odd">
<td><code>pwnlib.shellcraft.mips</code></td>
<td>Shellcode for MIPS</td>
</tr>
<tr class="even">
<td><code>pwnlib.shellcraft.thumb</code></td>
<td>Shellcode for Thumb Mode</td>
</tr>
<tr class="odd">
<td><code>pwnlib.term</code></td>
<td>终端处理封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.timeout</code></td>
<td>超时处理封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.tubes</code></td>
<td>套接字、SSH 等 IO 封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.tubes.buffer</code></td>
<td>IO 缓冲封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.tubes.process</code></td>
<td>IO 进程封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.tubes.serialtube</code></td>
<td>IO 串行端口封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.tubes.sock</code></td>
<td>套接字封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.tubes.ssh</code></td>
<td>SSH 封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.ui</code></td>
<td>UI 封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.update</code></td>
<td>更新 Pwntools</td>
</tr>
<tr class="odd">
<td><code>pwnlib.useragents</code></td>
<td>useragent 生成封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.util.crc</code></td>
<td>计算一系列 CRC 的封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.util.cyclic</code></td>
<td>一些序列生成器的封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.util.fiddling</code></td>
<td>编码封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.util.getdents</code></td>
<td>Linux 二进制目录处理</td>
</tr>
<tr class="even">
<td><code>pwnlib.util.hashes</code></td>
<td>哈希散列函数封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.util.iters</code></td>
<td>itertools 的扩展</td>
</tr>
<tr class="even">
<td><code>pwnlib.util.lists</code></td>
<td>对 list 的操作封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.util.misc</code></td>
<td>一些没办法分类的杂项函数封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.util.net</code></td>
<td>网络交互封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.util.packing</code></td>
<td>压缩操作封装</td>
</tr>
<tr class="even">
<td><code>pwnlib.util.proc</code></td>
<td>与 <code>/proc/</code> 相关的进程操作封装</td>
</tr>
<tr class="odd">
<td><code>pwnlib.util.safeeval</code></td>
<td>安全的 <code>eval()</code></td>
</tr>
<tr class="even">
<td><code>pwnlib.util.sh_string</code></td>
<td>Shell 字符串 <code>eval()</code></td>
</tr>
<tr class="odd">
<td><code>pwnlib.util.web</code></td>
<td>web 网络交互工具</td>
</tr>
</tbody>
</table>
<blockquote>
<p>推荐使用 <code>from pwn import *</code> 将以上各功能模块直接导入</p>
</blockquote>
<h1 id="pwntools-与服务器">Pwntools 与服务器</h1>
<p>使用 Pwntools 与服务器进行交互，需要利用 <code>pwnlib.tubes</code>
库，方便起见可以直接 <code>from pwn import *</code> 导入所有模块。</p>
<h2 id="建立连接">建立连接</h2>
<p>建立连接我们需要使用 <code>remote</code> 类，它的构造函数需要接收域名
(host) 和 端口 (port) 来跟服务器建立 TCP 或 UDP 连接，相当于 Linux 中的
<code>nc</code> 指令。</p>
<p>其他参数请参考官方文档 <a href="http://docs.pwntools.com/en/latest/tubes.html">http://docs.pwntools.com/en/latest/tubes.html</a></p>
<p>使用示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">io = pwn.remote(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8888</span>)</span><br><span class="line">client = pwn.remote(<span class="string">&quot;Localhost&quot;</span>, <span class="number">8888</span>)</span><br></pre></td></tr></table></figure>
<h2 id="接收数据">接收数据</h2>
<ul>
<li><p><code>recv(numb, timeout)</code></p>
<p><code>numb</code> → 接收的字节数；有默认值</p>
<p><code>timeout</code> → 接收时限，单位秒，超时则中断接收；有默认值</p>
<p><code>@returns</code> → 返回一个保存所接收数据的 <code>bytes</code>
数组</p>
<p>如果不给参数，默认返回缓冲区数据</p>
<p>使用示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 接收所有数据 (但只是缓冲区内容)</span></span><br><span class="line">data = io.recv()</span><br><span class="line"><span class="comment"># 接收 1024 字节数据</span></span><br><span class="line">data = io.recv(<span class="number">1024</span>)</span><br><span class="line"><span class="comment"># 接收 1 秒数据</span></span><br><span class="line">data = io.recv(timeout=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 接收 1024 字节数据，如果超时则直接返回</span></span><br><span class="line">data = io.recv(<span class="number">1024</span>, timeout=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></li>
<li><p><code>recvall(timeout)</code></p>
<p><code>timeout</code> → 接收时限，单位秒，超时则中断接收；默认
forever</p>
<p><code>@returns</code> → 返回一个保存所接收数据的 <code>bytes</code>
数组</p>
<p>使用示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 接收所有数据，直到 socket 关闭</span></span><br><span class="line">data = io.recvall()</span><br><span class="line"><span class="comment"># 接收 1 秒数据</span></span><br><span class="line">data = io.recvall(timeout=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></li>
<li><p><code>recvline(keepends, timeout)</code></p>
<p><code>keepends</code> → 接收数据是否保留回车；默认保留</p>
<p><code>timeout</code> → 接收时限，单位秒，超时则中断接收；有默认值</p>
<p><code>@returns</code> → 返回一个保存所接收数据的 <code>bytes</code>
数组</p>
<p>使用示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 接收一行数据 (但含有&#x27;\n&#x27;)</span></span><br><span class="line">data = io.recvline()</span><br><span class="line"><span class="comment"># 接收一行数据 (不含有&#x27;\n&#x27;)</span></span><br><span class="line">data = io.recvline(<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></li>
<li><p><code>recvuntil(delims, drop, timeout)</code></p>
<p><code>delims</code> → 接收中止标志</p>
<p><code>drop</code> → 是否丢弃中止标志；默认不丢弃</p>
<p><code>timeout</code> → 接收时限，单位秒，超时则中断接收；有默认值</p>
<p><code>@returns</code> → 返回一个保存所接收数据的 <code>bytes</code>
数组</p>
<p>使用示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">接收数据直到接收到 &#x27;start&#x27; 后结束，字符串中包含 &#x27;start&#x27;</span></span><br><span class="line"><span class="string">比如缓冲区中存在数据 &#x27;the game is started!&#x27;</span></span><br><span class="line"><span class="string">那么函数会返回 b&#x27;the game is start&#x27;，缓冲区为 &#x27;ed!&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">data = io.recvuntil(<span class="string">&#x27;start&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">接收数据直到接收到 &#x27;start&#x27; 后结束，字符串中不包含 &#x27;start&#x27;</span></span><br><span class="line"><span class="string">比如缓冲区中存在数据 &#x27;the game is started!&#x27;</span></span><br><span class="line"><span class="string">那么函数会返回 b&#x27;the game is &#x27;，而缓冲区为 &#x27;ed!&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">data = io.recvuntil(<span class="string">&#x27;start&#x27;</span>, <span class="literal">True</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="发送数据">发送数据</h2>
<ul>
<li><p><code>send(data)</code></p>
<p><code>data</code> → 发送的 bytes 数组</p>
<p>使用示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 发送数据，但不包含&#x27;\n&#x27;</span></span><br><span class="line">io.send(<span class="string">&#x27;hey!&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
<li><p><code>sendline(data)</code></p>
<p><code>data</code> → 发送的 bytes 数组，默认值为换行符</p>
<p>使用示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 发送数据，且包含换行符</span></span><br><span class="line">io.sendline(<span class="string">&#x27;hey!&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
<li><p><code>sendthen(delim, data, timeout)</code></p>
<p><code>delims</code> → 接收中止标志</p>
<p><code>data</code> → 发送的 bytes 数组</p>
<p><code>timeout</code> → 接收时限，单位秒，超时则中断接收；有默认值</p>
<p><code>@returns</code> → 返回一个保存所接收数据的 <code>bytes</code>
数组</p>
<p><code>sendlinethen</code> 同理</p>
<p>使用示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 发送数据&#x27;hey!&#x27;，然后 io.recvuntil(&#x27;how are u?&#x27;)</span></span><br><span class="line">data = io.sendthen(<span class="string">&#x27;how are u?&#x27;</span>, <span class="string">&#x27;hey!&#x27;</span>)</span><br><span class="line"><span class="comment"># 发送数据&#x27;hey!&#x27;，然后 io.recvuntil(&#x27;how are u?&#x27;, 1)</span></span><br><span class="line">data = io.sendthen(<span class="string">&#x27;how are u?&#x27;</span>, <span class="string">&#x27;hey!&#x27;</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure></li>
<li><p><code>sendafter(delim, data, timeout)</code></p>
<p><code>delims</code> → 接收中止标志</p>
<p><code>data</code> → 发送的 bytes 数组</p>
<p><code>timeout</code> → 接收时限，单位秒，超时则中断接收；有默认值</p>
<p><code>@returns</code> → 返回一个保存所接收数据的 <code>bytes</code>
数组</p>
<p><code>sendlinethen</code> 同理</p>
<p>使用示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># io.recvuntil(&#x27;how are u?&#x27;)，然后接收数据&#x27;I am fine.&#x27;</span></span><br><span class="line">data = io.sendafter(<span class="string">&#x27;how are u?&#x27;</span>, <span class="string">&#x27;I am fine.&#x27;</span>)</span><br><span class="line"><span class="comment"># io.recvuntil(&#x27;how are u?&#x27;, 1)，然后接收数据&#x27;I am fine.&#x27;</span></span><br><span class="line">data = io.sendafter(<span class="string">&#x27;how are u?&#x27;</span>, <span class="string">&#x27;hey!&#x27;</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="交互模式">交互模式</h2>
<p><code>remote.interactive()</code></p>
<p>可以直接进入终端交互模式，自动接收数据并输出，且会等待输入。</p>
<p>使用示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="完整示例">完整示例</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 与 127.0.0.1:8888 建立tcp连接</span></span><br><span class="line">io = remote(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8888</span>)</span><br><span class="line"><span class="comment"># 接收一行数据(例如 b&#x27;how are u?\n&#x27;)并解码为str类型</span></span><br><span class="line">msg = io.recvline().decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;recv: <span class="subst">&#123;msg&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送一行数据(即发送 b&#x27;I am fine. are u?\n&#x27;)</span></span><br><span class="line">io.sendline(<span class="string">&quot;I am fine. are u?&quot;</span>.encode())</span><br><span class="line"><span class="comment"># 接收一行数据(例如 b&#x27;I am fine, too.\n&#x27;)并解码为str类型</span></span><br><span class="line">msg = io.recvline().decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;recv: <span class="subst">&#123;msg&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当接收的数据不是 &quot;goobye!&quot; 的时候循环</span></span><br><span class="line"><span class="keyword">while</span> msg != <span class="string">&quot;goodbye!&quot;</span>:</span><br><span class="line">    <span class="comment"># 发送一行数据(即发送 b&#x27;baka!\n&#x27;)</span></span><br><span class="line">    io.sendline(<span class="string">&quot;baka!&quot;</span>.encode())</span><br><span class="line">    <span class="comment"># 接收一行数据(例如 b&#x27;???\n&#x27;)并解码为str类型</span></span><br><span class="line">    msg = io.recvline().decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;recv: <span class="subst">&#123;msg&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结束连接</span></span><br><span class="line">io.close()</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title>有关 linux 密码存储方式的分析笔记</title>
    <url>//linux-passwd-note.html</url>
    <content><![CDATA[<h1 id="linux-密码文件简述">Linux 密码文件简述</h1>
<p>众所周知，Linux 有一套用户权限管理系统，但用户名跟密码需要存储在
Linux 内部文件中。</p>
<p>在 Unix 中，用户密码文件是存储在 <code>/etc/passwd</code>
中的。但该文件允许所有用户读取，易导致用户密码泄露，因此 Linux
系统将用户的密码信息从 <code>/etc/passwd</code>
文件中分离出来，单独放到了 <code>/etc/shadow</code> 文件。</p>
<p><code>/etc/shadow</code> 只有 root
用户拥有读权限，其他用户没有任何权限，这样就保证了用户密码的安全性。</p>
<p>Unix 系统的用户密码保存格式也可以参考本文章，只是将
<code>/etc/passwd</code> 中的 <code>x</code> 变更为
<code>/etc/shadow</code> 对应的密码而已。</p>
<p>所以如果<strong>影子文件</strong>(<code>/etc/shadow</code>)
的权限发生了改变，需要注意是否是<strong>恶意攻击</strong>。</p>
<h1 id="etcshadow-格式详解"><code>/etc/shadow</code> 格式详解</h1>
<p><code>/etc/shadow</code> 文件内容示例：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root:$6$kcgcu794R0VP3fDL$aYN8XUbtWvZ4QQtT2xVW.N2CgE3YLPdtnprAAtKZUgNdq8itUJEN6NoYQDarLUevcDCWrxMVId8b18ujwST1b0::0:99999:7:::</span><br></pre></td></tr></table></figure>
<p>文件中每一行代表一个用户，采用 <code>:</code>
作分隔符，一共被划分为九个字段：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name:password:last-change:min-age:max-age:warning:inactive:expire:blank</span><br></pre></td></tr></table></figure>
<p>字段含义：</p>
<table>
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th>字段名</th>
<th>字段含义</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>name</td>
<td>登录名称，必须是有效用户名</td>
</tr>
<tr class="even">
<td>password</td>
<td>已加密密码，分为三个部分用$分隔，第一部分表示用哪种哈希算法；第二部分是用于加密哈希的salt；第三部分是已加密的哈希哈希算法。<br>第一部分：<br>1
表示MD5；5 表示SHA-256；6
表示SHA-512。<br>注意：在密码前，一个感叹号(<code>!</code>)代表该用户被锁定，可以在机器上转到改用户，但无法远程；两个感叹号(<code>!</code>)，表示没有设置密码</td>
</tr>
<tr class="odd">
<td>last-change</td>
<td>最近一次更改密码的日期，以距离1970/1/1的天数表示</td>
</tr>
<tr class="even">
<td>min-age</td>
<td>最小修改时间间隔，即密码更改后多少天内不能再次更改。0表示可以随时更改</td>
</tr>
<tr class="odd">
<td>max-age</td>
<td>密码有效期，必须在期限内修改密码</td>
</tr>
<tr class="even">
<td>warning</td>
<td>警告期，警告用户再过多少天密码将过期。0 表示不提供警告</td>
</tr>
<tr class="odd">
<td>inactive</td>
<td>宽限期，密码过期多少天仍然可以使用</td>
</tr>
<tr class="even">
<td>expire</td>
<td>帐号过期时间，以距离1970/1/1的天数表示。0 或空字符表示永不过期</td>
</tr>
<tr class="odd">
<td>blank</td>
<td>预留字段</td>
</tr>
</tbody>
</table>
<h1 id="更改密码">更改密码</h1>
<p>可以在 <code>root</code> 账户下使用 <code>passwd 用户名</code>
指令交互式更改指定用户名的密码。</p>
<p>示例如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># passwd qsdz</span></span><br><span class="line">Enter new UNIX password:</span><br><span class="line">Retype new UNIX password:</span><br><span class="line">passwd: password updated successfully</span><br></pre></td></tr></table></figure>
<p>其中，输入新密码的时候是<strong>无回显</strong>的</p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hashcat 使用笔记</title>
    <url>//hashcat-note.html</url>
    <content><![CDATA[<h1 id="hashcat-简述">Hashcat 简述</h1>
<p>Hashcat 是自称世界上最快的密码恢复工具。</p>
<p>在 Debian 系的 Linux 中可以使用 <code>apt install hashcat</code>
获取。</p>
<p>也可以在 github 官方页面中获取更多信息：<a href="https://github.com/hashcat/hashcat">https://github.com/hashcat/hashcat</a></p>
<p>支持 hashcat 的散列算法有 Microsoft LM 哈希，MD4，MD5，SHA系列，Unix
加密格式，MySQL 和 Cisco PIX 等。</p>
<p>同时也支持多种计算核心：GPU、CPU、APU、DSP、FPGA、Coprocessor</p>
<h1 id="常用参数">常用参数</h1>
<table>
<thead>
<tr class="header">
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>-m</td>
<td>指定哈希类型，不指定默认为 md5</td>
</tr>
<tr class="even">
<td>-a</td>
<td>指定破解模式</td>
</tr>
<tr class="odd">
<td>-V</td>
<td>查看版本信息</td>
</tr>
<tr class="even">
<td>-o</td>
<td>将输出结果储存到指定文件</td>
</tr>
<tr class="odd">
<td>--force</td>
<td>忽略警告</td>
</tr>
<tr class="even">
<td>--show</td>
<td>仅显示破解的hash密码和对应的明文</td>
</tr>
<tr class="odd">
<td>--remove</td>
<td>从源文件中删除破解成功的hash</td>
</tr>
<tr class="even">
<td>--username</td>
<td>忽略hash表中的用户名</td>
</tr>
<tr class="odd">
<td>-b</td>
<td>测试计算机破解速度和相关硬件信息</td>
</tr>
<tr class="even">
<td>-O</td>
<td>限制密码长度</td>
</tr>
<tr class="odd">
<td>-T</td>
<td>设置线程数</td>
</tr>
<tr class="even">
<td>-r</td>
<td>使用规则文件</td>
</tr>
<tr class="odd">
<td>-1 / -2 / -3</td>
<td>自定义字符集</td>
</tr>
<tr class="even">
<td>-i</td>
<td>启用增量破解模式</td>
</tr>
<tr class="odd">
<td>--increment-min</td>
<td>设置密码最小长度</td>
</tr>
<tr class="even">
<td>--increment-max</td>
<td>设置密码最大长度</td>
</tr>
</tbody>
</table>
<h2 id="a-破解模式">-a 破解模式</h2>
<table>
<thead>
<tr class="header">
<th>-a 参数</th>
<th>攻击模式</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>Straight（字段破解）</td>
</tr>
<tr class="even">
<td>1</td>
<td>Combination（组合破解）</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Brute-force（掩码暴力破解）</td>
</tr>
<tr class="even">
<td>6</td>
<td>Hybrid Wordlist + Mask（字典+掩码破解）</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Hybrid Mask + Wordlist（掩码+字典破解）</td>
</tr>
</tbody>
</table>
<h2 id="掩码字符集">掩码字符集</h2>
<table>
<thead>
<tr class="header">
<th>掩码字符集</th>
<th>指代</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>?l</td>
<td>代表小写字母</td>
</tr>
<tr class="even">
<td>?u</td>
<td>代表大写字母</td>
</tr>
<tr class="odd">
<td>?d</td>
<td>代表数字</td>
</tr>
<tr class="even">
<td>?h</td>
<td>常见小写子目录和数字</td>
</tr>
<tr class="odd">
<td>?H</td>
<td>常见大写字母和数字</td>
</tr>
<tr class="even">
<td>?s</td>
<td>代表特殊字符</td>
</tr>
<tr class="odd">
<td>?a</td>
<td>代表大小写字母、数字以及特殊字符</td>
</tr>
<tr class="even">
<td>?b</td>
<td>0x00-0xff</td>
</tr>
</tbody>
</table>
<blockquote>
<p>同时支持自定义字符集，即</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -1 abc123 ?1?1?1</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="hash-id-对照表">hash id 对照表</h2>
<table>
<colgroup>
<col style="width: 7%">
<col style="width: 53%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th>-m 参数</th>
<th>Name</th>
<th>Category</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>900</td>
<td><code>MD4</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>0</td>
<td><code>MD5</code></td>
<td>Raw Hash</td>
</tr>
<tr class="odd">
<td>5100</td>
<td><code>Half MD5</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>100</td>
<td><code>SHA1</code></td>
<td>Raw Hash</td>
</tr>
<tr class="odd">
<td>1300</td>
<td><code>SHA2-224</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>1400</td>
<td><code>SHA2-256</code></td>
<td>Raw Hash</td>
</tr>
<tr class="odd">
<td>10800</td>
<td><code>SHA2-384</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>1700</td>
<td><code>SHA2-512</code></td>
<td>Raw Hash</td>
</tr>
<tr class="odd">
<td>17300</td>
<td><code>SHA3-224</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>17400</td>
<td><code>SHA3-256</code></td>
<td>Raw Hash</td>
</tr>
<tr class="odd">
<td>17500</td>
<td><code>SHA3-384</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>17600</td>
<td><code>SHA3-512</code></td>
<td>Raw Hash</td>
</tr>
<tr class="odd">
<td>17700</td>
<td><code>Keccak-224</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>17800</td>
<td><code>Keccak-256</code></td>
<td>Raw Hash</td>
</tr>
<tr class="odd">
<td>17900</td>
<td><code>Keccak-384</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>18000</td>
<td><code>Keccak-512</code></td>
<td>Raw Hash</td>
</tr>
<tr class="odd">
<td>600</td>
<td><code>BLAKE2b-512</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>10100</td>
<td><code>SipHash</code></td>
<td>Raw Hash</td>
</tr>
<tr class="odd">
<td>6000</td>
<td><code>RIPEMD-160</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>6100</td>
<td><code>Whirlpool</code></td>
<td>Raw Hash</td>
</tr>
<tr class="odd">
<td>6900</td>
<td><code>GOST R 34.11-94</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>11700</td>
<td><code>GOST R 34.11-2012 (Streebog) 256-bit, big-endian</code></td>
<td>Raw Hash</td>
</tr>
<tr class="odd">
<td>11800</td>
<td><code>GOST R 34.11-2012 (Streebog) 512-bit, big-endian</code></td>
<td>Raw Hash</td>
</tr>
<tr class="even">
<td>10</td>
<td><code>md5($pass.$salt)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>20</td>
<td><code>md5($salt.$pass)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>30</td>
<td><code>md5(utf16le($pass).$salt)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>40</td>
<td><code>md5($salt.utf16le($pass))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>3800</td>
<td><code>md5($salt.$pass.$salt)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>3710</td>
<td><code>md5($salt.md5($pass))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>4010</td>
<td><code>md5($salt.md5($salt.$pass))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>4110</td>
<td><code>md5($salt.md5($pass.$salt))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>2600</td>
<td><code>md5(md5($pass))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>3910</td>
<td><code>md5(md5($pass).md5($salt))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>4300</td>
<td><code>md5(strtoupper(md5($pass)))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>4400</td>
<td><code>md5(sha1($pass))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>110</td>
<td><code>sha1($pass.$salt)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>120</td>
<td><code>sha1($salt.$pass)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>130</td>
<td><code>sha1(utf16le($pass).$salt)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>140</td>
<td><code>sha1($salt.utf16le($pass))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>4500</td>
<td><code>sha1(sha1($pass))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>4520</td>
<td><code>sha1($salt.sha1($pass))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>4700</td>
<td><code>sha1(md5($pass))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>4900</td>
<td><code>sha1($salt.$pass.$salt)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>14400</td>
<td><code>sha1(CX)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>1410</td>
<td><code>sha256($pass.$salt)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>1420</td>
<td><code>sha256($salt.$pass)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>1430</td>
<td><code>sha256(utf16le($pass).$salt)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>1440</td>
<td><code>sha256($salt.utf16le($pass))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>1710</td>
<td><code>sha512($pass.$salt)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>1720</td>
<td><code>sha512($salt.$pass)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>1730</td>
<td><code>sha512(utf16le($pass).$salt)</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="even">
<td>1740</td>
<td><code>sha512($salt.utf16le($pass))</code></td>
<td>Raw Hash, Salted and/or Iterated</td>
</tr>
<tr class="odd">
<td>50</td>
<td><code>HMAC-MD5 (key = $pass)</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="even">
<td>60</td>
<td><code>HMAC-MD5 (key = $salt)</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="odd">
<td>150</td>
<td><code>HMAC-SHA1 (key = $pass)</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="even">
<td>160</td>
<td><code>HMAC-SHA1 (key = $salt)</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="odd">
<td>1450</td>
<td><code>HMAC-SHA256 (key = $pass)</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="even">
<td>1460</td>
<td><code>HMAC-SHA256 (key = $salt)</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="odd">
<td>1750</td>
<td><code>HMAC-SHA512 (key = $pass)</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="even">
<td>1760</td>
<td><code>HMAC-SHA512 (key = $salt)</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="odd">
<td>11750</td>
<td><code>HMAC-Streebog-256 (key = $pass), big-endian</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="even">
<td>11760</td>
<td><code>HMAC-Streebog-256 (key = $salt), big-endian</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="odd">
<td>11850</td>
<td><code>HMAC-Streebog-512 (key = $pass), big-endian</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="even">
<td>11860</td>
<td><code>HMAC-Streebog-512 (key = $salt), big-endian</code></td>
<td>Raw Hash, Authenticated</td>
</tr>
<tr class="odd">
<td>14000</td>
<td><code>DES (PT = $salt, key = $pass)</code></td>
<td>Raw Cipher, Known-Plaintext attack</td>
</tr>
<tr class="even">
<td>14100</td>
<td><code>3DES (PT = $salt, key = $pass)</code></td>
<td>Raw Cipher, Known-Plaintext attack</td>
</tr>
<tr class="odd">
<td>14900</td>
<td><code>Skip32 (PT = $salt, key = $pass)</code></td>
<td>Raw Cipher, Known-Plaintext attack</td>
</tr>
<tr class="even">
<td>15400</td>
<td><code>ChaCha20</code></td>
<td>Raw Cipher, Known-Plaintext attack</td>
</tr>
<tr class="odd">
<td>400</td>
<td><code>phpass</code></td>
<td>Generic KDF</td>
</tr>
<tr class="even">
<td>8900</td>
<td><code>scrypt</code></td>
<td>Generic KDF</td>
</tr>
<tr class="odd">
<td>11900</td>
<td><code>PBKDF2-HMAC-MD5</code></td>
<td>Generic KDF</td>
</tr>
<tr class="even">
<td>12000</td>
<td><code>PBKDF2-HMAC-SHA1</code></td>
<td>Generic KDF</td>
</tr>
<tr class="odd">
<td>10900</td>
<td><code>PBKDF2-HMAC-SHA256</code></td>
<td>Generic KDF</td>
</tr>
<tr class="even">
<td>12100</td>
<td><code>PBKDF2-HMAC-SHA512</code></td>
<td>Generic KDF</td>
</tr>
<tr class="odd">
<td>23</td>
<td><code>Skype</code></td>
<td>Network Protocols</td>
</tr>
<tr class="even">
<td>2500</td>
<td><code>WPA-EAPOL-PBKDF2</code></td>
<td>Network Protocols</td>
</tr>
<tr class="odd">
<td>2501</td>
<td><code>WPA-EAPOL-PMK</code></td>
<td>Network Protocols</td>
</tr>
<tr class="even">
<td>16800</td>
<td><code>WPA-PMKID-PBKDF2</code></td>
<td>Network Protocols</td>
</tr>
<tr class="odd">
<td>16801</td>
<td><code>WPA-PMKID-PMK</code></td>
<td>Network Protocols</td>
</tr>
<tr class="even">
<td>4800</td>
<td><code>iSCSI CHAP authentication, MD5(CHAP)</code></td>
<td>Network Protocols</td>
</tr>
<tr class="odd">
<td>5300</td>
<td><code>IKE-PSK MD5</code></td>
<td>Network Protocols</td>
</tr>
<tr class="even">
<td>5400</td>
<td><code>IKE-PSK SHA1</code></td>
<td>Network Protocols</td>
</tr>
<tr class="odd">
<td>5500</td>
<td><code>NetNTLMv1</code></td>
<td>Network Protocols</td>
</tr>
<tr class="even">
<td>5500</td>
<td><code>NetNTLMv1+ESS</code></td>
<td>Network Protocols</td>
</tr>
<tr class="odd">
<td>5600</td>
<td><code>NetNTLMv2</code></td>
<td>Network Protocols</td>
</tr>
<tr class="even">
<td>7300</td>
<td><code>IPMI2 RAKP HMAC-SHA1</code></td>
<td>Network Protocols</td>
</tr>
<tr class="odd">
<td>7500</td>
<td><code>Kerberos 5 AS-REQ Pre-Auth etype 23</code></td>
<td>Network Protocols</td>
</tr>
<tr class="even">
<td>8300</td>
<td><code>DNSSEC (NSEC3)</code></td>
<td>Network Protocols</td>
</tr>
<tr class="odd">
<td>10200</td>
<td><code>CRAM-MD5</code></td>
<td>Network Protocols</td>
</tr>
<tr class="even">
<td>11100</td>
<td><code>PostgreSQL CRAM (MD5)</code></td>
<td>Network Protocols</td>
</tr>
<tr class="odd">
<td>11200</td>
<td><code>MySQL CRAM (SHA1)</code></td>
<td>Network Protocols</td>
</tr>
<tr class="even">
<td>11400</td>
<td><code>SIP digest authentication (MD5)</code></td>
<td>Network Protocols</td>
</tr>
<tr class="odd">
<td>13100</td>
<td><code>Kerberos 5 TGS-REP etype 23</code></td>
<td>Network Protocols</td>
</tr>
<tr class="even">
<td>16100</td>
<td><code>TACACS+</code></td>
<td>Network Protocols</td>
</tr>
<tr class="odd">
<td>16500</td>
<td><code>JWT (JSON Web Token)</code></td>
<td>Network Protocols</td>
</tr>
<tr class="even">
<td>18200</td>
<td><code>Kerberos 5 AS-REP etype 23</code></td>
<td>Network Protocols</td>
</tr>
<tr class="odd">
<td>121</td>
<td><code>SMF (Simple Machines Forum) &gt; v1.1</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>400</td>
<td><code>phpBB3 (MD5)</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="odd">
<td>2611</td>
<td><code>vBulletin &lt; v3.8.5</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>2711</td>
<td><code>vBulletin &gt;= v3.8.5</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="odd">
<td>2811</td>
<td><code>MyBB 1.2+</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>2811</td>
<td><code>IPB2+ (Invision Power Board)</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="odd">
<td>8400</td>
<td><code>WBB3 (Woltlab Burning Board)</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>11</td>
<td><code>Joomla &lt; 2.5.18</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="odd">
<td>400</td>
<td><code>Joomla &gt;= 2.5.18 (MD5)</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>400</td>
<td><code>WordPress (MD5)</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="odd">
<td>2612</td>
<td><code>PHPS</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>7900</td>
<td><code>Drupal7</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="odd">
<td>21</td>
<td><code>osCommerce</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>21</td>
<td><code>xt:Commerce</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="odd">
<td>11000</td>
<td><code>PrestaShop</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>124</td>
<td><code>Django (SHA-1)</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="odd">
<td>10000</td>
<td><code>Django (PBKDF2-SHA256)</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>16000</td>
<td><code>Tripcode</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="odd">
<td>3711</td>
<td><code>MediaWiki B type</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>13900</td>
<td><code>OpenCart</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="odd">
<td>4521</td>
<td><code>Redmine</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>4522</td>
<td><code>PunBB</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="odd">
<td>12001</td>
<td><code>Atlassian (PBKDF2-HMAC-SHA1)</code></td>
<td>Forums, CMS, E-Commerce, Frameworks</td>
</tr>
<tr class="even">
<td>12</td>
<td><code>PostgreSQL</code></td>
<td>Database Server</td>
</tr>
<tr class="odd">
<td>131</td>
<td><code>MSSQL (2000)</code></td>
<td>Database Server</td>
</tr>
<tr class="even">
<td>132</td>
<td><code>MSSQL (2005)</code></td>
<td>Database Server</td>
</tr>
<tr class="odd">
<td>1731</td>
<td><code>MSSQL (2012, 2014)</code></td>
<td>Database Server</td>
</tr>
<tr class="even">
<td>200</td>
<td><code>MySQL323</code></td>
<td>Database Server</td>
</tr>
<tr class="odd">
<td>300</td>
<td><code>MySQL4.1/MySQL5</code></td>
<td>Database Server</td>
</tr>
<tr class="even">
<td>3100</td>
<td><code>Oracle H: Type (Oracle 7+)</code></td>
<td>Database Server</td>
</tr>
<tr class="odd">
<td>112</td>
<td><code>Oracle S: Type (Oracle 11+)</code></td>
<td>Database Server</td>
</tr>
<tr class="even">
<td>12300</td>
<td><code>Oracle T: Type (Oracle 12+)</code></td>
<td>Database Server</td>
</tr>
<tr class="odd">
<td>8000</td>
<td><code>Sybase ASE</code></td>
<td>Database Server</td>
</tr>
<tr class="even">
<td>141</td>
<td><code>Episerver 6.x &lt; .NET 4</code></td>
<td>HTTP, SMTP, LDAP Server</td>
</tr>
<tr class="odd">
<td>1441</td>
<td><code>Episerver 6.x &gt;= .NET 4</code></td>
<td>HTTP, SMTP, LDAP Server</td>
</tr>
<tr class="even">
<td>1600</td>
<td><code>Apache $apr1$ MD5, md5apr1, MD5 (APR)</code></td>
<td>HTTP, SMTP, LDAP Server</td>
</tr>
<tr class="odd">
<td>12600</td>
<td><code>ColdFusion 10+</code></td>
<td>HTTP, SMTP, LDAP Server</td>
</tr>
<tr class="even">
<td>1421</td>
<td><code>hMailServer</code></td>
<td>HTTP, SMTP, LDAP Server</td>
</tr>
<tr class="odd">
<td>101</td>
<td><code>nsldap, SHA-1(Base64), Netscape LDAP SHA</code></td>
<td>HTTP, SMTP, LDAP Server</td>
</tr>
<tr class="even">
<td>111</td>
<td><code>nsldaps, SSHA-1(Base64), Netscape LDAP SSHA</code></td>
<td>HTTP, SMTP, LDAP Server</td>
</tr>
<tr class="odd">
<td>1411</td>
<td><code>SSHA-256(Base64), LDAP &#123;SSHA256&#125;</code></td>
<td>HTTP, SMTP, LDAP Server</td>
</tr>
<tr class="even">
<td>1711</td>
<td><code>SSHA-512(Base64), LDAP &#123;SSHA512&#125;</code></td>
<td>HTTP, SMTP, LDAP Server</td>
</tr>
<tr class="odd">
<td>16400</td>
<td><code>CRAM-MD5 Dovecot</code></td>
<td>HTTP, SMTP, LDAP Server</td>
</tr>
<tr class="even">
<td>15000</td>
<td><code>FileZilla Server &gt;= 0.9.55</code></td>
<td>FTP Server</td>
</tr>
<tr class="odd">
<td>11500</td>
<td><code>CRC32</code></td>
<td>Checksums</td>
</tr>
<tr class="even">
<td>3000</td>
<td><code>LM</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>1000</td>
<td><code>NTLM</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>1100</td>
<td><code>Domain Cached Credentials (DCC), MS Cache</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>2100</td>
<td><code>Domain Cached Credentials 2 (DCC2), MS Cache 2</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>15300</td>
<td><code>DPAPI masterkey file v1</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>15900</td>
<td><code>DPAPI masterkey file v2</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>12800</td>
<td><code>MS-AzureSync  PBKDF2-HMAC-SHA256</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>1500</td>
<td><code>descrypt, DES (Unix), Traditional DES</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>12400</td>
<td><code>BSDi Crypt, Extended DES</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>500</td>
<td><code>md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>3200</td>
<td><code>bcrypt $2*$, Blowfish (Unix)</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>7400</td>
<td><code>sha256crypt $5$, SHA256 (Unix)</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>1800</td>
<td><code>sha512crypt $6$, SHA512 (Unix)</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>122</td>
<td><code>macOS v10.4, MacOS v10.5, MacOS v10.6</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>1722</td>
<td><code>macOS v10.7</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>7100</td>
<td><code>macOS v10.8+ (PBKDF2-SHA512)</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>6300</td>
<td><code>AIX &#123;smd5&#125;</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>6700</td>
<td><code>AIX &#123;ssha1&#125;</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>6400</td>
<td><code>AIX &#123;ssha256&#125;</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>6500</td>
<td><code>AIX &#123;ssha512&#125;</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>2400</td>
<td><code>Cisco-PIX MD5</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>2410</td>
<td><code>Cisco-ASA MD5</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>500</td>
<td><code>Cisco-IOS $1$ (MD5)</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>5700</td>
<td><code>Cisco-IOS type 4 (SHA256)</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>9200</td>
<td><code>Cisco-IOS $8$ (PBKDF2-SHA256)</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>9300</td>
<td><code>Cisco-IOS $9$ (scrypt)</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>22</td>
<td><code>Juniper NetScreen/SSG (ScreenOS)</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>501</td>
<td><code>Juniper IVE</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>15100</td>
<td><code>Juniper/NetBSD sha1crypt</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>7000</td>
<td><code>FortiGate (FortiOS)</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>5800</td>
<td><code>Samsung Android Password/PIN</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>13800</td>
<td><code>Windows Phone 8+ PIN/password</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>8100</td>
<td><code>Citrix NetScaler</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>8500</td>
<td><code>RACF</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>7200</td>
<td><code>GRUB 2</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>9900</td>
<td><code>Radmin2</code></td>
<td>Operating Systems</td>
</tr>
<tr class="even">
<td>125</td>
<td><code>ArubaOS</code></td>
<td>Operating Systems</td>
</tr>
<tr class="odd">
<td>7700</td>
<td><code>SAP CODVN B (BCODE)</code></td>
<td>Enterprise Application Software (EAS)</td>
</tr>
<tr class="even">
<td>7701</td>
<td><code>SAP CODVN B (BCODE) via RFC_READ_TABLE</code></td>
<td>Enterprise Application Software (EAS)</td>
</tr>
<tr class="odd">
<td>7800</td>
<td><code>SAP CODVN F/G (PASSCODE)</code></td>
<td>Enterprise Application Software (EAS)</td>
</tr>
<tr class="even">
<td>7801</td>
<td><code>SAP CODVN F/G (PASSCODE) via RFC_READ_TABLE</code></td>
<td>Enterprise Application Software (EAS)</td>
</tr>
<tr class="odd">
<td>10300</td>
<td><code>SAP CODVN H (PWDSALTEDHASH) iSSHA-1</code></td>
<td>Enterprise Application Software (EAS)</td>
</tr>
<tr class="even">
<td>8600</td>
<td><code>Lotus Notes/Domino 5</code></td>
<td>Enterprise Application Software (EAS)</td>
</tr>
<tr class="odd">
<td>8700</td>
<td><code>Lotus Notes/Domino 6</code></td>
<td>Enterprise Application Software (EAS)</td>
</tr>
<tr class="even">
<td>9100</td>
<td><code>Lotus Notes/Domino 8</code></td>
<td>Enterprise Application Software (EAS)</td>
</tr>
<tr class="odd">
<td>133</td>
<td><code>PeopleSoft</code></td>
<td>Enterprise Application Software (EAS)</td>
</tr>
<tr class="even">
<td>13500</td>
<td><code>PeopleSoft PS_TOKEN</code></td>
<td>Enterprise Application Software (EAS)</td>
</tr>
<tr class="odd">
<td>11600</td>
<td><code>7-Zip</code></td>
<td>Archives</td>
</tr>
<tr class="even">
<td>12500</td>
<td><code>RAR3-hp</code></td>
<td>Archives</td>
</tr>
<tr class="odd">
<td>13000</td>
<td><code>RAR5</code></td>
<td>Archives</td>
</tr>
<tr class="even">
<td>13200</td>
<td><code>AxCrypt</code></td>
<td>Archives</td>
</tr>
<tr class="odd">
<td>13300</td>
<td><code>AxCrypt in-memory SHA1</code></td>
<td>Archives</td>
</tr>
<tr class="even">
<td>13600</td>
<td><code>WinZip</code></td>
<td>Archives</td>
</tr>
<tr class="odd">
<td>14700</td>
<td><code>iTunes backup &lt; 10.0</code></td>
<td>Backup</td>
</tr>
<tr class="even">
<td>14800</td>
<td><code>iTunes backup &gt;= 10.0</code></td>
<td>Backup</td>
</tr>
<tr class="odd">
<td>62XY</td>
<td><code>TrueCrypt</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>X</td>
<td><code>1 = PBKDF2-HMAC-RIPEMD160</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>X</td>
<td><code>2 = PBKDF2-HMAC-SHA512</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>X</td>
<td><code>3 = PBKDF2-HMAC-Whirlpool</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>X</td>
<td><code>4 = PBKDF2-HMAC-RIPEMD160 + boot-mode</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>1 = XTS  512 bit pure AES</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>1 = XTS  512 bit pure Serpent</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>1 = XTS  512 bit pure Twofish</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>2 = XTS 1024 bit pure AES</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>2 = XTS 1024 bit pure Serpent</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>2 = XTS 1024 bit pure Twofish</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>2 = XTS 1024 bit cascaded AES-Twofish</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>2 = XTS 1024 bit cascaded Serpent-AES</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>2 = XTS 1024 bit cascaded Twofish-Serpent</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>3 = XTS 1536 bit all</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>8800</td>
<td><code>Android FDE &lt;= 4.3</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>12900</td>
<td><code>Android FDE (Samsung DEK)</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>12200</td>
<td><code>eCryptfs</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>137XY</td>
<td><code>VeraCrypt</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>X</td>
<td><code>1 = PBKDF2-HMAC-RIPEMD160</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>X</td>
<td><code>2 = PBKDF2-HMAC-SHA512</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>X</td>
<td><code>3 = PBKDF2-HMAC-Whirlpool</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>X</td>
<td><code>4 = PBKDF2-HMAC-RIPEMD160 + boot-mode</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>X</td>
<td><code>5 = PBKDF2-HMAC-SHA256</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>X</td>
<td><code>6 = PBKDF2-HMAC-SHA256 + boot-mode</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>X</td>
<td><code>7 = PBKDF2-HMAC-Streebog-512</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>1 = XTS  512 bit pure AES</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>1 = XTS  512 bit pure Serpent</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>1 = XTS  512 bit pure Twofish</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>1 = XTS  512 bit pure Camellia</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>1 = XTS  512 bit pure Kuznyechik</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>2 = XTS 1024 bit pure AES</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>2 = XTS 1024 bit pure Serpent</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>2 = XTS 1024 bit pure Twofish</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>2 = XTS 1024 bit pure Camellia</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>2 = XTS 1024 bit pure Kuznyechik</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>2 = XTS 1024 bit cascaded AES-Twofish</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>2 = XTS 1024 bit cascaded Camellia-Kuznyechik</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>2 = XTS 1024 bit cascaded Camellia-Serpent</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>2 = XTS 1024 bit cascaded Kuznyechik-AES</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>2 = XTS 1024 bit cascaded Kuznyechik-Twofish</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>2 = XTS 1024 bit cascaded Serpent-AES</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>Y</td>
<td><code>2 = XTS 1024 bit cascaded Twofish-Serpent</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>Y</td>
<td><code>3 = XTS 1536 bit all</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>14600</td>
<td><code>LUKS</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>16700</td>
<td><code>FileVault 2</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="odd">
<td>18300</td>
<td><code>Apple File System (APFS)</code></td>
<td>Full-Disk Encryption (FDE)</td>
</tr>
<tr class="even">
<td>9700</td>
<td><code>MS Office &lt;= 2003 $0/$1, MD5 + RC4</code></td>
<td>Documents</td>
</tr>
<tr class="odd">
<td>9710</td>
<td><code>MS Office &lt;= 2003 $0/$1, MD5 + RC4, collider #1</code></td>
<td>Documents</td>
</tr>
<tr class="even">
<td>9720</td>
<td><code>MS Office &lt;= 2003 $0/$1, MD5 + RC4, collider #2</code></td>
<td>Documents</td>
</tr>
<tr class="odd">
<td>9800</td>
<td><code>MS Office &lt;= 2003 $3/$4, SHA1 + RC4</code></td>
<td>Documents</td>
</tr>
<tr class="even">
<td>9810</td>
<td><code>MS Office &lt;= 2003 $3, SHA1 + RC4, collider #1</code></td>
<td>Documents</td>
</tr>
<tr class="odd">
<td>9820</td>
<td><code>MS Office &lt;= 2003 $3, SHA1 + RC4, collider #2</code></td>
<td>Documents</td>
</tr>
<tr class="even">
<td>9400</td>
<td><code>MS Office 2007</code></td>
<td>Documents</td>
</tr>
<tr class="odd">
<td>9500</td>
<td><code>MS Office 2010</code></td>
<td>Documents</td>
</tr>
<tr class="even">
<td>9600</td>
<td><code>MS Office 2013</code></td>
<td>Documents</td>
</tr>
<tr class="odd">
<td>10400</td>
<td><code>PDF 1.1 - 1.3 (Acrobat 2 - 4)</code></td>
<td>Documents</td>
</tr>
<tr class="even">
<td>10410</td>
<td><code>PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #1</code></td>
<td>Documents</td>
</tr>
<tr class="odd">
<td>10420</td>
<td><code>PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #2</code></td>
<td>Documents</td>
</tr>
<tr class="even">
<td>10500</td>
<td><code>PDF 1.4 - 1.6 (Acrobat 5 - 8)</code></td>
<td>Documents</td>
</tr>
<tr class="odd">
<td>10600</td>
<td><code>PDF 1.7 Level 3 (Acrobat 9)</code></td>
<td>Documents</td>
</tr>
<tr class="even">
<td>10700</td>
<td><code>PDF 1.7 Level 8 (Acrobat 10 - 11)</code></td>
<td>Documents</td>
</tr>
<tr class="odd">
<td>16200</td>
<td><code>Apple Secure Notes</code></td>
<td>Documents</td>
</tr>
<tr class="even">
<td>9000</td>
<td><code>Password Safe v2</code></td>
<td>Password Managers</td>
</tr>
<tr class="odd">
<td>5200</td>
<td><code>Password Safe v3</code></td>
<td>Password Managers</td>
</tr>
<tr class="even">
<td>6800</td>
<td><code>LastPass + LastPass sniffed</code></td>
<td>Password Managers</td>
</tr>
<tr class="odd">
<td>6600</td>
<td><code>1Password, agilekeychain</code></td>
<td>Password Managers</td>
</tr>
<tr class="even">
<td>8200</td>
<td><code>1Password, cloudkeychain</code></td>
<td>Password Managers</td>
</tr>
<tr class="odd">
<td>11300</td>
<td><code>Bitcoin/Litecoin wallet.dat</code></td>
<td>Password Managers</td>
</tr>
<tr class="even">
<td>12700</td>
<td><code>Blockchain, My Wallet</code></td>
<td>Password Managers</td>
</tr>
<tr class="odd">
<td>15200</td>
<td><code>Blockchain, My Wallet, V2</code></td>
<td>Password Managers</td>
</tr>
<tr class="even">
<td>16600</td>
<td><code>Electrum Wallet (Salt-Type 1-3)</code></td>
<td>Password Managers</td>
</tr>
<tr class="odd">
<td>13400</td>
<td><code>KeePass 1 (AES/Twofish) and KeePass 2 (AES)</code></td>
<td>Password Managers</td>
</tr>
<tr class="even">
<td>15500</td>
<td><code>JKS Java Key Store Private Keys (SHA1)</code></td>
<td>Password Managers</td>
</tr>
<tr class="odd">
<td>15600</td>
<td><code>Ethereum Wallet, PBKDF2-HMAC-SHA256</code></td>
<td>Password Managers</td>
</tr>
<tr class="even">
<td>15700</td>
<td><code>Ethereum Wallet, SCRYPT</code></td>
<td>Password Managers</td>
</tr>
<tr class="odd">
<td>16300</td>
<td><code>Ethereum Pre-Sale Wallet, PBKDF2-HMAC-SHA256</code></td>
<td>Password Managers</td>
</tr>
<tr class="even">
<td>16900</td>
<td><code>Ansible Vault</code></td>
<td>Password Managers</td>
</tr>
<tr class="odd">
<td>18100</td>
<td><code>TOTP (HMAC-SHA1)</code></td>
<td>One-Time Passwords</td>
</tr>
<tr class="even">
<td>99999</td>
<td><code>Plaintext</code></td>
<td>Plaintext</td>
</tr>
</tbody>
</table>
<h1 id="实例演示">实例演示</h1>
<h2 id="使用字典进行爆破">使用字典进行爆破</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 0 0192023a7bbd73250516f069df18b500 password.txt --force</span><br></pre></td></tr></table></figure>
<h2 id="使用指定字符集爆破">使用指定字符集爆破</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 3 63a9f0ea7bb98050796b649e85481845 ?l?l?l?l --force</span><br></pre></td></tr></table></figure>
<h2 id="使用字典掩码进行爆破">使用字典+掩码进行爆破</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 6 1844156d4166d94387f1a4ad031ca5fa password.txt ?d?d?d --force</span><br></pre></td></tr></table></figure>
<h2 id="使用掩码字典进行破解">使用掩码+字典进行破解</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 7 f8def8bcecb2e7925a2b42d60d202deb ?d?d password.txt --force</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意 hashcat 优先选择的规则不一样</p>
</blockquote>
<h2 id="mysql4.15的-password-函数">Mysql4.1/5的 <code>PASSWORD</code>
函数</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 3 -m 300 --force 6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9 ?d?d?d?d?d?d</span><br></pre></td></tr></table></figure>
<h2 id="sha512crypt-6-sha512-unix破解">sha512crypt <span class="math inline">\(6\)</span>, SHA512 (Unix)破解</h2>
<p>可以通过 <code>cat /etc/shadow</code> 获取</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 3 -m 1800 --force $6$mxuA5cdy<span class="variable">$XZRk0CvnPFqOgVopqiPEFAFK72SogKVwwwp7gWaUOb7b6tVwfCpcSUsCEk64ktLLYmzyew</span>/xd0O0hPG/yrm2X. ?l?l?l?l</span><br></pre></td></tr></table></figure>
<p>不需要整理用户名，可以使用 <code>--username</code> 参数</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 3 -m 1800 --force qiyou:$6$QDq75ki3<span class="variable">$jsKm7qTDHz</span>/xBob0kF1Lp170Cgg0i5Tslf3JW/sm9k9Q916mBTyilU3PoOsbRdxV8TAmzvdgNjrCuhfg3jKMY1 ?l?l?l?l?l --username</span><br></pre></td></tr></table></figure>
<h2 id="windows-nt-hashlm-hash破解">Windows NT-hash，LM-hash破解</h2>
<p>可以用 saminside 获取 NT-hash 或 LM-hash 的值</p>
<ul>
<li><p>NT-hash</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat64.exe -a 3 -m 1000 209C6174DA490CAEB422F3FA5A7AE634 ?l?l?l?l?l</span><br></pre></td></tr></table></figure></li>
<li><p>LM-hash</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat64.exe -a 3 -m 3000 F0D412BD764FFE81AAD3B435B51404EE ?l?l?l?l?l</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="mssql-破解">mssql 破解</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 3 -m 132 --force 0x01008c8006c224f71f6bf0036f78d863c3c4ff53f8c3c48edafb ?l?l?l?l?l?d?d?d</span><br></pre></td></tr></table></figure>
<h2 id="wordpress-密码-hash-破解">wordpress 密码 hash 破解</h2>
<p>具体加密脚本在<code>./wp-includes/class-phpass.php</code>的<code>HashPassword</code>函数</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 3 -m 400 --force $P<span class="variable">$BYEYcHEj3vDhV1lwGBv6rpxurKOEWY</span>/ ?d?d?d?d?d?d</span><br></pre></td></tr></table></figure>
<h2 id="discuz-用户密码-hash-破解">discuz 用户密码 hash 破解</h2>
<p>其密码加密方式 <code>md5(md5($pass).$salt)</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 3 -m 2611 --force 14e1b600b1fd579f47433b88e8d85291: ?d?d?d?d?d?d</span><br></pre></td></tr></table></figure>
<h2 id="rar-压缩包密码破解">RAR 压缩包密码破解</h2>
<p>先用 rar2john 获取 RAR 文件 hash 值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; rar2john 1.rar</span><br><span class="line">1.rar:$rar5$16$639e9ce8344c680da12e8bdd4346a6a3$15$a2b056a21a9836d8d48c2844d171b73d$8<span class="variable">$04a52d2224ad082e</span></span><br></pre></td></tr></table></figure>
<p>然后再使用 hashcat 爆破</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 3 -m 13000 --force $rar5$16$639e9ce8344c680da12e8bdd4346a6a3$15$a2b056a21a9836d8d48c2844d171b73d$8<span class="variable">$04a52d2224ad082e</span> ?d?d?d?d?d?d</span><br></pre></td></tr></table></figure>
<p>注意到</p>
<table>
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 81%">
</colgroup>
<thead>
<tr class="header">
<th>-m 参数</th>
<th>类型</th>
<th>示例 hash</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>12500</td>
<td>RAR3-hp</td>
<td><span class="math inline">\(RAR3\)</span><em>0</em>45109af8ab5f297a*adbf6c5385d7a40373e8f77d7b89d317</td>
</tr>
<tr class="even">
<td>13000</td>
<td>RAR5</td>
<td>$rar5$16$74575567518807622265582327032280<span class="math inline">\(15\)</span>f8b4064de34ac02ecabfe</td>
</tr>
</tbody>
</table>
<h2 id="zip-压缩包密码破解">ZIP 压缩包密码破解</h2>
<p>先用 zip2john 获取 RAR 文件 hash 值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; zip2john.exe 1.zip</span><br><span class="line">1.zip:$zip2$*0*3*0*554bb43ff71cb0cac76326f292119dfd*ff23*5*24b28885ee*d4fe362bb1e91319ab53*$/zip2$:::::1.zip-1.txt</span><br></pre></td></tr></table></figure>
<p>然后再使用 hashcat 爆破</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 3 -m 13600 $zip2$*0*3*0*554bb43ff71cb0cac76326f292119dfd*ff23*5*24b28885ee*d4fe362bb1e91319ab53*$/zip2$ --force ?d?d?d?d?d?d</span><br></pre></td></tr></table></figure>
<h2 id="office-密码破解">office 密码破解</h2>
<p>先用 zip2john 获取 RAR 文件 hash 值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; python office2john.py 11.docx</span><br><span class="line">11.docx:$office$*2013*100000*256*16*e4a3eb62e8d3576f861f9eded75e0525*9eeb35f0849a7800d48113440b4bbb9c*577f8d8b2e1c5f60fed76e62327b38d28f25230f6c7dfd66588d9ca8097aabb9</span><br></pre></td></tr></table></figure>
<p>然后再使用 hashcat 爆破</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 3 -m 9600 $office$*2013*100000*256*16*e4a3eb62e8d3576f861f9eded75e0525*9eeb35f0849a7800d48113440b4bbb9c*577f8d8b2e1c5f60fed76e62327b38d28f25230f6c7dfd66588d9ca8097aabb9 --force ?d?d?d?d?d?d</span><br></pre></td></tr></table></figure>
<h2 id="wifi-密码破解">WIFI 密码破解</h2>
<p>首先先把握手包转化为 hccapx 格式</p>
<blockquote>
<p>现在最新版的 hashcat 只支持 hccapx 格式了，以前的 hccap
格式已经不支持了</p>
</blockquote>
<p>可以使用 <a href="https://hashcat.net/cap2hccapx/">https://hashcat.net/cap2hccapx/</a>
进行转换</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -a 3 -m 2500 1.hccapx 1391040?d?d?d?d</span><br></pre></td></tr></table></figure>
<h1 id="使用建议">使用建议</h1>
<ol type="1">
<li><p>对于破解过的hash值，用<code>hashcat64.exe hash --show</code>查看结果</p></li>
<li><p>所有的hash破解结果都在hashcat.potfile文件中</p></li>
<li><p>如果破解的时间太长，可以按s键可以查看破解的状态，p键暂停，r键继续破解，q键退出破解。</p></li>
<li><p>在使用GPU模式进行破解时，可以使用-O参数自动进行优化</p></li>
<li><p>在实际破解中的建议，如果我们盲目的去破解，会占用我们大量的时间和资源</p>
<ol type="1">
<li>首先走一遍常用的弱口令字典</li>
<li>组合密码，如：zhang1999，用姓氏和出生年组合，当然也可以用其它的组合，这里举个例子而已</li>
<li>把常用的掩码组合整理起来放在masks中的.hcmask文件中，然后让它自动加载破解</li>
<li>如果实在不行，你可以尝试低位数的所有组合去跑，不过不建议太高位数的组合去破解，因为如果对方设置的密码很复杂的话，到头来你密码没有破解到，却浪费了大量的时间和资源，得不偿失</li>
</ol></li>
<li><p>Hashcat 参数优化</p>
<ol type="1">
<li><p>Workload tuning 负载调优</p>
<p>该参数支持的值有1,8,40,80,160，可以让GPU发挥最大性能</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--gpu-accel 160</span><br></pre></td></tr></table></figure></li>
<li><p>Gpu loops 负载微调</p>
<p>该参数支持的值的范围是8-1024（有些算法只支持到1000），可以让GPU发挥最大性能。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--gpu-loops 1024</span><br></pre></td></tr></table></figure></li>
<li><p>Segment size 字典缓存大小</p>
<p>该参数是设置内存缓存的大小，作用是将字典放入内存缓存以加快字典破解速度，默认为32MB，可以根据自身内存情况进行设置，当然是越大越块了。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--segment-size 512</span><br></pre></td></tr></table></figure></li>
</ol></li>
</ol>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>ntfs 数据流笔记</title>
    <url>//ntfs-streams-note.html</url>
    <content><![CDATA[<h1 id="ntfs-简述">NTFS 简述</h1>
<p>NTFS文件系统时windows
NT内核系列操作系统支持的、专门为网络和磁盘配额的，文件加密等管理安全特性设计的磁盘格式。NTFS比FAT文件系统更加稳定，更能也更为强大。</p>
<p>NTFS数据流文件也被称为 Alternate data
streams，简称ADS，是NTFS文件系统的一个特性之一，允许单独的数据流文件存在，同时也允许文件附着多个数据流，除了主文件流之外还允许许多非主文件流寄生在主文件流中，使用资源派生的方式来维持与文件的相关信息，并且这些寄生的数据流文件我们使用资源管理器无法看到。</p>
<p>ADS的作用在于，它允许一个文件携带着附加的信息。例如，IE浏览器下载文件时，会向文件添加一个数据流，标记该文件来源于外部，即带有风险，那么，在用户打开文件时，就会弹出文件警告提示。再如，在网址收藏中，也会附加一个favicon数据流以存放网站图标。</p>
<p>ADS原意是为了和Macintosh的HFS文件系统兼容而设计的，使用这种技术可以在一个文件资源里写入相关数据(并不是写入文件中)，而且写进去的数据可以使用很简单的方法把它提取出来作为一个独立文件读取，甚至执行。但不少后门程序使用ADS隐藏自己。</p>
<p>而创建一个NTFS交换数据流文件的方式很简单，命令为
<code>宿主文件：寄宿文件</code></p>
<h1 id="使用-ntfs-交换数据流隐藏数据">使用 NTFS 交换数据流隐藏数据</h1>
<p>以下命令均需要在 NTFS 分区中使用，因为 ADS 是 NTFS 的特性，类似于
FAT32 文件系统并不适用。而且需要使用命令提示符软件，使用 powershell
可能会报错。</p>
<p>因为 NTFS 交换数据流文件可以存放数据，而 NTFS
交换数据流我们又没办法直接通过资源管理器查看，所以我们只需要对其写入数据即可使用
NTFS 交换数据流隐藏数据。</p>
<p>比如说我们使用指令
<code>echo this is a secret &gt; 1.txt:ads.txt</code> 来将文本
<code>this is a secret</code> 写入寄宿于 <code>1.txt</code> 的
<code>ads.txt</code> NTFS 交换数据流文件中。</p>
<p>又或者使用 <code>type 涩图.png &gt; peace.txt:secret.txt</code> 来将
<code>涩图.png</code> 转成文本信息后写入 NTFS 交换数据流文件
<code>peace.txt:secret.txt</code> 中。</p>
<p>同理我们甚至可以使用
<code>type trojan.exe &gt; surprise.txt:horse.exe</code> 将
<code>trojan.exe</code> 写入 NTFS 交换数据流文件
<code>surprise.txt:horse.exe</code> 中。</p>
<p>而实际上上面这个方法在以前的病毒中经常使用。</p>
<h1 id="查看-ntfs-交换数据流数据">查看 NTFS 交换数据流数据</h1>
<h2 id="使用-windows-指令查看">使用 Windows 指令查看</h2>
<p>Windows 指令是可以直接检索到 NTFS
交换数据流的，但前提是需要知道目标的名字。</p>
<p>例如对于 <code>echo this is a secret &gt; 1.txt:ads.txt</code>
生成的数据，我们可以使用 <code>notepad</code> 来查看，即
<code>notepad 1.txt:ads.txt</code>。</p>
<p>对于 <code>type 涩图.png &gt; peace.txt:secret.txt</code>
生成的数据，我们可以使用 <code>mspaint</code> 来查看，即
<code>maspaint peace.txt:secret.txt</code>。</p>
<p>同时使用以上方式也可以直接修改 NTFS 交换数据流的数据 (文件)。</p>
<p>对于 <code>type trojan.exe &gt; surprise.txt:horse.exe</code>
生成的数据，在 Windows XP 上可以使用 <code>start</code>
指令直接启动可执行文件，即
<code>start surprise.txt:horse.exe</code>；但在 Windows 7
及之后的系统中，微软为了安全起见，不能再通过 <code>start</code>
指令启动可执行文件，只能先使用 <code>mklink</code>
指令创建一个符号链接文件指向 NTFS
交换数据流文件，然后再直接执行符号链接文件，即
<code>mklink a.exe surprise.txt:horse.exe &amp;&amp; a.exe</code>。</p>
<h2 id="使用-ntfs-streams-editor-软件查看">使用 Ntfs Streams Editor
软件查看</h2>
<figure>
<img src="/ntfs-streams-note/NtfsStreamsEditor2.png" alt="NtfsStreamsEditor2">
<figcaption aria-hidden="true">NtfsStreamsEditor2</figcaption>
</figure>
<p>我们可以使用它指定一个磁盘或文件夹进行扫描，将直接扫描出该磁盘或文件夹下所存在的数据流，同时可以通过该文件直接打开文件查看内容。</p>
<figure>
<img src="/ntfs-streams-note/scanner.png" alt="scanner">
<figcaption aria-hidden="true">scanner</figcaption>
</figure>
<p>而且我们也可以使用它来写入 NTFS 交换数据流文件，关于 Ntfs Streams
Editor 的更多功能，这里不写详细介绍，建议自行探索。</p>
<h1 id="ntfs-交换数据流与-winrar">NTFS 交换数据流与 WinRAR</h1>
<p>当你想要压缩存在 NTFS
交换数据流的文件时，要注意到现在流行的压缩方式，只有 <code>rar</code>
格式才可以保存 NTFS 交换数据流。</p>
<p>在使用 WinRAR 压缩时，可以使用 <code>高级 - 保存文件流数据</code>
来保存 NTFS 交换数据流不被忽略。</p>
<p>同时解压时也需要使用 WinRAR 解压才能获得完整的 NTFS 交换数据流。</p>
<p>而且我们可以观察到，当被压缩文件有 NTFS 交换数据流的时候，在 RAR
压缩包中会出现值为 <code>Service(NTFS streams) block</code>
的数据块，并且文件名称也会泄露出来，但压缩包中无法直接查看。</p>
<figure>
<img src="/ntfs-streams-note/ADS%20filename.png" alt="ADS filename">
<figcaption aria-hidden="true">ADS filename</figcaption>
</figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>ntfs</tag>
      </tags>
  </entry>
  <entry>
    <title>凯撒加密和维吉尼亚加密的笔记</title>
    <url>//caesar-vigenere-note.html</url>
    <content><![CDATA[<h1 id="凯撒加密">凯撒加密</h1>
<h2 id="简述">简述</h2>
<p>在密码学中，恺撒密码是一种最简单且最广为人知的加密技术。它是一种替换加密的技术，明文中的所有字母都在字母表上向后（或向前）按照一个固定数目进行偏移后被替换成密文。例，当偏移量是3的时候，所有的字母A将被替换成D，B变成E，以此类推。这个加密方法是以恺撒的名字命名的，当年恺撒曾用此方法与其将军们进行联系。恺撒密码通常被作为其他更复杂的加密方法中的一个步骤。恺撒密码还在现代的ROT13系统中被应用。但是和所有的利用字母表进行替换的加密技术一样，凯撒密码的密度是很低的，只需简单地统计字频就可以破译。</p>
<p>需要注意的是，凯撒加密只对二十六个字母（要么都是大写，要么都是小写）有效。</p>
<h2 id="描述">描述</h2>
<p>设 <span class="math inline">\(k\)</span> 为密钥 (key)，字符串 <span class="math inline">\(m\)</span> 为明文，<span class="math inline">\(c\)</span> 为密文，则加密算法为 <span class="math display">\[
c_i=E(m_i,k)
\]</span> 其中函数 <span class="math inline">\(E\)</span> 的算法为，令
<span class="math inline">\(m_i\)</span> 向右偏移 <span class="math inline">\(k\)</span> 位，在
<code>ABCDEFGHIJKLMNOPQRSTUVWXYZ</code> 字母环中移动，即 <span class="math display">\[
E(m_i,k)=(m_i+k)\ mod\ 26
\]</span> 解密算法为 <span class="math display">\[
m_i=D(c_i,k)
\]</span> 其中函数 <span class="math inline">\(D\)</span> 的算法为，令
<span class="math inline">\(c_i\)</span> 向左偏移 k 位，在
<code>ABCDEFGHIJKLMNOPQRSTUVWXYZ</code> 字母环中移动，即 <span class="math display">\[
D(c_i,k)=(c_i-k)\ mod\ 26
\]</span></p>
<h2 id="实现">实现</h2>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 这里只处理大写</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">CaesarChar</span><span class="params">(<span class="keyword">char</span> ch, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (ch - <span class="string">&#x27;A&#x27;</span> + k) % <span class="number">26</span> + <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">CaesarEncoder</span><span class="params">(<span class="keyword">const</span> string&amp; plain, <span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">string <span class="title">result</span><span class="params">(plain)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">char</span>&amp; i : result)</span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="built_in">CaesarChar</span>(i, key);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">CaesarDecoder</span><span class="params">(<span class="keyword">const</span> string&amp; code, <span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">string <span class="title">result</span><span class="params">(code)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">char</span>&amp; i : result)</span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="built_in">CaesarChar</span>(i, -key);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于凯撒加密有十分简单的爆破方法：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 对凯撒加密的单个字符爆破 key</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">CaesarCharKeyCracker</span><span class="params">(<span class="keyword">char</span> plainChar, <span class="keyword">char</span> codeChar)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> diff = codeChar - plainChar;</span><br><span class="line">	<span class="keyword">return</span> diff &lt; <span class="number">0</span> ? diff + <span class="number">26</span> : diff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对凯撒加密的字符串爆破 key，会核验是否满足凯撒加密</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">CaesarStringKeyCracker</span><span class="params">(<span class="keyword">const</span> string&amp; plain, <span class="keyword">const</span> string&amp; code)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> diff = <span class="built_in">CaesarCharKeyCracker</span>(plain[<span class="number">0</span>], code[<span class="number">0</span>]);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; plain.<span class="built_in">size</span>(); ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (diff != <span class="built_in">CaesarCharKeyCracker</span>(plain[i], code[i]))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 说明极有可能不是凯撒加密</span></span><br><span class="line">			<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> diff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对凯撒加密后的字符串爆破密钥 1~25 并返回结果</span></span><br><span class="line"><span class="function">vector&lt;string&gt; <span class="title">CaesarCracker</span><span class="params">(<span class="keyword">const</span> string&amp; code)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;string&gt; result;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">26</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		result.<span class="built_in">push_back</span>(<span class="built_in">CaesarDecoder</span>(code, i));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 返回密钥从 1~25 的解密结果</span></span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>爆破算法使用 python 编写则是：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CaesarCracker</span>(<span class="params">code:<span class="built_in">str</span></span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">26</span>):</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="keyword">lambda</span> x : <span class="built_in">chr</span>((<span class="built_in">ord</span>(x) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - i) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)) <span class="keyword">if</span> <span class="built_in">str</span>.isalpha(x) <span class="keyword">else</span> x, code))</span><br></pre></td></tr></table></figure>
<h1 id="维吉尼亚加密">维吉尼亚加密</h1>
<h2 id="简述-1">简述</h2>
<p>在单一恺撒密码的基础上，法国外交家布莱斯·德·维吉尼亚（Blaise de
Vigenère）发明了一种方法来对同一条信息中的不同字母用不同的密码进行加密。这样，同样的E在一个位置可能被M所取代，而在另一个位置的E则有可能以K的面目出现。这样，就可以防止任何人利用频率分析法解密该条信息。</p>
<p>维吉尼亚密码引入了“密钥”的概念，即根据密钥来决定用哪一行的密表来进行替换，以此来对抗字频统计。</p>
<figure>
<img src="/caesar-vigenere-note/vigenere%20table.png" alt="vigenere table">
<figcaption aria-hidden="true">vigenere table</figcaption>
</figure>
<h2 id="描述-1">描述</h2>
<p>与凯撒加密不同，维吉尼亚的密钥是一个只含有二十六个字母的字符串 <span class="math inline">\(key\)</span>，同理明文为 <span class="math inline">\(m\)</span>，密文为 <span class="math inline">\(c\)</span>，则加密算法为 <span class="math display">\[
c_i=E(m_i,key_i)
\]</span> 其中函数 <span class="math inline">\(E\)</span>
的算法为，在维吉尼亚表中，横行为 <span class="math inline">\(m_i\)</span> 的字符，纵行为 <span class="math inline">\(key_i\)</span>
的字符，选择对应的表中字符为加密字符。</p>
<p>解密算法为 <span class="math display">\[
m_i=D(c_i,key_i)
\]</span> 其中函数 <span class="math inline">\(D\)</span>
的算法为，在维吉尼亚表中，纵行为 <span class="math inline">\(key_i\)</span> 的字符，查找 <span class="math inline">\(key_i\)</span> 对应横行中的字符 <span class="math inline">\(c_i\)</span>，所对应的上方横行字符即为明文字符。</p>
<p>实际上就相当于每一个字符都拥有自己的 key 进行凯撒加密</p>
<h2 id="实现-1">实现</h2>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 这里只处理大写</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">CaesarChar</span><span class="params">(<span class="keyword">char</span> ch, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (ch - <span class="string">&#x27;A&#x27;</span> + k) % <span class="number">26</span> + <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这里只处理大写</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">VigenereCharEncoder</span><span class="params">(<span class="keyword">char</span> ch, <span class="keyword">char</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">CaesarChar</span>(ch, k - <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这里只处理大写</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">VigenereCharDecoder</span><span class="params">(<span class="keyword">char</span> ch, <span class="keyword">char</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">CaesarChar</span>(ch, -(<span class="keyword">int</span>)(k - <span class="string">&#x27;A&#x27;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">VigenereStringEncoder</span><span class="params">(<span class="keyword">const</span> string&amp; plain, <span class="keyword">const</span> string&amp; key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">string <span class="title">result</span><span class="params">(plain)</span></span>;</span><br><span class="line">	<span class="keyword">size_t</span> c = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">char</span>&amp; i : result)</span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="built_in">VigenereCharEncoder</span>(i, key[c]);</span><br><span class="line">		++c;</span><br><span class="line">		<span class="keyword">if</span> (c == key.<span class="built_in">size</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			c -= key.<span class="built_in">size</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">VigenereStringDecoder</span><span class="params">(<span class="keyword">const</span> string&amp; code, <span class="keyword">const</span> string&amp; key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">string <span class="title">result</span><span class="params">(code)</span></span>;</span><br><span class="line">	<span class="keyword">size_t</span> c = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">char</span>&amp; i : result)</span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="built_in">VigenereCharDecoder</span>(i, key[c]);</span><br><span class="line">		++c;</span><br><span class="line">		<span class="keyword">if</span> (c == key.<span class="built_in">size</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			c -= key.<span class="built_in">size</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中对维吉尼亚密钥的爆破算法为</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 对凯撒加密的单个字符爆破 key</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">CaesarCharKeyCracker</span><span class="params">(<span class="keyword">char</span> plainChar, <span class="keyword">char</span> codeChar)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> diff = codeChar - plainChar;</span><br><span class="line">	<span class="keyword">return</span> diff &lt; <span class="number">0</span> ? diff + <span class="number">26</span> : diff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">VigenereKeyCracker</span><span class="params">(<span class="keyword">const</span> string&amp; plain, <span class="keyword">const</span> string&amp; code)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">string <span class="title">key</span><span class="params">(plain)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; plain.<span class="built_in">size</span>(); ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		key[i] = <span class="built_in">CaesarCharKeyCracker</span>(plain[i], code[i]) + <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> key;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>爆破密钥的算法使用 python 编写则是：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">VigenereKeyCracker</span>(<span class="params">plain:<span class="built_in">str</span>, code:<span class="built_in">str</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(j)) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)) <span class="keyword">if</span> <span class="built_in">str</span>.isalpha(i) <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(plain, code))</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>BlowFish 算法笔记</title>
    <url>//blowfish-note.html</url>
    <content><![CDATA[<h1 id="blowfish-简述">BlowFish 简述</h1>
<p>BlowFish 算法基于 Feistel 网络，加密函数迭代执行 16 轮，分组长度为 64
位，密钥长度可以从 32 位到 448
位。算法由两部分组成，密钥扩展部分和数据加密部分，密钥扩展部分将最长最长为
448 位的密钥转化成共 4168 字节长度的子密钥数组，其中，数据加密由一个 16
轮的 Feistel
网络完成，每轮由一个密钥相关置换和一个密钥与数据相关的替换组成。</p>
<figure>
<img src="/blowfish-note/blowfish%20流程图.png" alt="blowfish 流程图">
<figcaption aria-hidden="true">blowfish 流程图</figcaption>
</figure>
<h1 id="blowfish-描述">BlowFish 描述</h1>
<h2 id="密钥预处理">密钥预处理</h2>
<p>BlowFish 算法子密钥在加密前预计算产生。</p>
<p>主要涉及到 P-box 和 S-box。</p>
<h3 id="密钥-key">密钥 Key</h3>
<p>密钥 Key 是 32bits 到 448bits 的可变长度，即 1 到 14 个
<code>DWORD</code> 数字，即 Key 数组最大为
<code>DWORD Key[14]</code>。</p>
<p>接下来使用 <code>Key[i]</code> 表示第 <code>i</code> 个可变密钥。</p>
<h3 id="p-box">P-box</h3>
<p>P-box 也可以被称作密钥数组，由 18 个 32bits 的密钥组成，即数组
<code>DWORD P_box[18]</code></p>
<p>我们首先要使用随机数对数组进行初始化，而常用的方法是使用常量 <span class="math inline">\(\pi\)</span> 的小数部分，将其直接转化为 32bits 位
<code>DWORD</code> 数进行赋值，如</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">P_box[<span class="number">0</span>] = <span class="number">0x76a301d3</span>;</span><br><span class="line">P_box[<span class="number">1</span>] = <span class="number">0xbc452aef</span>;</span><br><span class="line">...</span><br><span class="line">P_box[<span class="number">17</span>] = <span class="number">0xd7acc4a5</span>;</span><br></pre></td></tr></table></figure>
<p>之后让 P-box 与 Key 数组的每一个值进行异或，即
<code>P_box[i] ^= Key[i]</code>。</p>
<p>当超过 Key 数组的长度时，则重复使用 Key 的值进行异或，直到 P-box
中的元素全部异或完成。</p>
<p>如此我们便得到了新的 P-box。</p>
<h3 id="s-box">S-box</h3>
<p>在密码学中，S-box 的全称为
substitution-box，即替换盒子，可以将输入替换成不同的输出，换句话说，可以将
n bits 的输入转换为 m bits 的输出。</p>
<p>在 BlowFish 中，S-box 是动态生成的，负责将 8bits 的输入转换为 32bits
的输出。</p>
<p>故 S-box 的大小为 <code>DWORD S_box[4][256]</code>。</p>
<p>常用的方法是，使用常量 <span class="math inline">\(\pi\)</span>
的小数部分，将其直接转化为 32bits 位 <code>DWORD</code> 数对 S-box
进行初始化，通常接在 P-box 后面进行初始化。</p>
<h3 id="最终处理">最终处理</h3>
<p>通过以上，得到初始化的 P-box 与 S-box。</p>
<p>按照以下步骤对 P-box 进行处理：</p>
<ol type="1">
<li>取全为 0 的 64bits，使用 P-box 和 S-box 数组，对其进行 BlowFish
加密，生成第一个 64bits</li>
<li>将生成的 64bits 作为新的 <code>P_box[0]</code> 和
<code>P_box[1]</code>，再将这 64bits 作为输入，得到新的
<code>P_box[2]</code> 和 <code>P_box[3]</code></li>
<li>同理反复步骤 2，最终生成所有 P-box 数组的元素。</li>
<li>同理反复步骤 2、3，最终生成所有 S-box 数组的元素 (使用
<code>P-box[16]</code> 和 <code>P-box[17]</code> 作为输入)。</li>
</ol>
<h2 id="加解密">加解密</h2>
<p>BlowFish 由 16 轮的 Fistel 网络组成，输入是一个 64bits 的数据元素
X，将 X 分为两个 32bits 部分，为 XL 与 XH。</p>
<h3 id="轮函数">轮函数</h3>
<p>轮函数使用代码描述即为</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 轮函数</span></span><br><span class="line"><span class="function">DWORD <span class="title">Feistel</span><span class="params">(DWORD x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	DWORD h = S[<span class="number">0</span>][x &gt;&gt; <span class="number">24</span>] + S[<span class="number">1</span>][x &gt;&gt; <span class="number">16</span> &amp; <span class="number">0xff</span>];</span><br><span class="line">	<span class="keyword">return</span> (h ^ S[<span class="number">2</span>][x &gt;&gt; <span class="number">8</span> &amp; <span class="number">0xff</span>]) + S[<span class="number">3</span>][x &amp; <span class="number">0xff</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="加密算法">加密算法</h3>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt</span><span class="params">(DWORD&amp; XL, DWORD&amp; XR)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i += <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		XL ^= P[i];</span><br><span class="line">		XR ^= <span class="built_in">Feistel</span>(XL);</span><br><span class="line">		XR ^= P[i + <span class="number">1</span>];</span><br><span class="line">		XL ^= <span class="built_in">Feistel</span>(XR);</span><br><span class="line">	&#125;</span><br><span class="line">	XL ^= P[<span class="number">16</span>];</span><br><span class="line">	XR ^= P[<span class="number">17</span>];</span><br><span class="line">	<span class="built_in">swap</span>(XL, XR);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="解密算法">解密算法</h3>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decrypt</span><span class="params">(DWORD&amp; XL, DWORD&amp; XR)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">16</span>; i &gt; <span class="number">0</span>; i -= <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		XL ^= P[i + <span class="number">1</span>];</span><br><span class="line">		XR ^= <span class="built_in">Feistel</span>(XL);</span><br><span class="line">		XR ^= P[i];</span><br><span class="line">		XL ^= <span class="built_in">Feistel</span>(XR);</span><br><span class="line">	&#125;</span><br><span class="line">	XL ^= P[<span class="number">1</span>];</span><br><span class="line">	XR ^= P[<span class="number">0</span>];</span><br><span class="line">	<span class="built_in">swap</span>(XL, XR);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="blowfish-c-实现">BlowFish &amp; C++ 实现</h1>
<p>请查看 <a href="https://github.com/HasegawaAzusa/BlowFish">https://github.com/HasegawaAzusa/BlowFish</a></p>
<p>代码堪堪能运行而已，仅作示例和理解。</p>
<h1 id="blowfish-优劣">BlowFish 优劣</h1>
<h2 id="优点">优点</h2>
<p>从上面的流程可以看出，blowfish在生成最终的K数组和S-box需要耗费一定的时间，但是一旦生成完毕，或者说密钥不变的情况下，blowfish还是很快速的一种分组加密方法。</p>
<p>每个新的密钥都需要进行大概4
KB文本的预处理，和其他分组密码算法相比，这个会很慢。</p>
<p>那么慢有没有好处呢？</p>
<p>当然有，因为对于一个正常应用来说，是不会经常更换密钥的。所以预处理只会生成一次。在后面使用的时候就会很快了。</p>
<p>而对于恶意攻击者来说，每次尝试新的密钥都需要进行漫长的预处理，所以对攻击者来说要破解blowfish算法是非常不划算的。所以blowfish是可以抵御字典攻击的。</p>
<h2 id="缺点">缺点</h2>
<p>Blowfish使用64位块大小（与AES的128位块大小相比）使它容易受到生日攻击，特别是在HTTPS这样的环境中。
2016年，SWEET32攻击演示了如何利用生日攻击对64位块大小的密码执行纯文本恢复（即解密密文）。</p>
<p>因为blowfish的块只有64bits，比较小，所以GnuPG项目建议不要使用Blowfish来加密大于4
GB的文件。</p>
<p>除此之外，Blowfish如果只进行一轮加密的话，容易受到反射性弱键的已知明文攻击。
但是我们的实现中使用的是16轮加密，所以不容易受到这种攻击。但是Blowfish的发明人布鲁斯·施耐尔（Bruce
Schneier）还是建议大家迁移到Blowfish的继承者Twofish去。</p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>DES 算法笔记</title>
    <url>//des-note.html</url>
    <content><![CDATA[<h1 id="des-算法简述">DES 算法简述</h1>
<p>DES算法是一种最通用的对称密钥算法，因为算法本身是公开的，所以其安全性在于密钥的安全性。基于密钥的算法通常有两类：对称算法和公开密钥算法。对称算法的对称性体现在加密密钥能够从解密密钥推算出来，反之亦然。在大多数对称算法中，加解密的密钥是相同的，DES就是这样。可见，对称密钥算法的加解密密钥都是保密的。而公开密钥算法的加密密钥是公开的，解密密钥是保密的。</p>
<p>下面是 DES 加密算法的整体流程图：</p>
<figure>
<img src="/des-note/DES%20流程图.png" alt="DES 流程图">
<figcaption aria-hidden="true">DES 流程图</figcaption>
</figure>
<p>从流程图中可以看出，DES 明显基于 Feistel 密码结构，其中 f
为轮函数。</p>
<p>并且需要注意到，事实上密钥只有 56bits 参与了 DES
算法（其中第8、16、24、32、40、48、56、64位是校验位，使得每个密钥都有奇数个
1），分组后的明文组和56位的密钥按位替代或交换的方法形成密文组。</p>
<h1 id="des-算法描述">DES 算法描述</h1>
<h2 id="初始置换-ip">初始置换 <span class="math inline">\(IP\)</span></h2>
<p>将输入的 64bits 明文重新进行排序，即将第 58 位放到第 1 位，第 50
位放到第 2 位，并且以此类推，最终有一个 8x8 的置换表如下：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 初始置换表 IP</span></span><br><span class="line"><span class="keyword">int</span> IP[] = &#123; <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>,</span><br><span class="line">			 <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">			 <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>,</span><br><span class="line">			 <span class="number">64</span>, <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>,</span><br><span class="line">			 <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>,  <span class="number">1</span>,</span><br><span class="line">			 <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">			 <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>,</span><br><span class="line">			 <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>置换后，<span class="math inline">\(L_0\)</span> 为新数据的左
32bits，<span class="math inline">\(R_0\)</span> 为新数据的右
32bits，即分为高、低32位。</p>
<h2 id="密钥置换-子密钥-k_i-的获取">密钥置换 (子密钥 <span class="math inline">\(K_i\)</span> 的获取)</h2>
<p>密钥置换将从原始的 56 位密钥中得到 16 个子密钥 (轮密钥) <span class="math inline">\(k_i\)</span>，其中每个子密钥 <span class="math inline">\(k_i\)</span> 都是 48 位。</p>
<p>首先注意到 DES 的输入密钥通常是 64 位，其中每第 8 个位都作为前面 7
位的一个<strong>奇校验位</strong>。但校验位并不会增加密码安全性，所以因为此可以说
DES 的密钥是 56 位的，而不是 64 位的。</p>
<p>于是首先我们需要通过忽略所有第 8 位的方式将 64 位密钥缩短为 56
位。示意图如下：</p>
<figure>
<img src="/des-note/奇校验位.png" alt="奇校验位">
<figcaption aria-hidden="true">奇校验位</figcaption>
</figure>
<p>而置乱使用的表如下：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 密钥置换表，将64位密钥压缩为56位</span></span><br><span class="line"><span class="keyword">int</span> PC_1[] = &#123;<span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>,</span><br><span class="line">			   <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>,</span><br><span class="line">			  <span class="number">10</span>,  <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>,</span><br><span class="line">			  <span class="number">19</span>, <span class="number">11</span>,  <span class="number">3</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>,</span><br><span class="line">			  <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>,</span><br><span class="line">			   <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>,</span><br><span class="line">			  <span class="number">14</span>,  <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>,</span><br><span class="line">			  <span class="number">21</span>, <span class="number">13</span>,  <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>,  <span class="number">4</span>&#125;;</span><br></pre></td></tr></table></figure>
<p>以上被称为第一次置换。</p>
<p>然后要将得到的 56 位密钥将分为 <span class="math inline">\(C_0\)</span> 和 <span class="math inline">\(D_0\)</span> 两部分，同时长度均为 28
位的左右两部分将周期性地向左移动<strong>一位或两位</strong>
(即循环移位)，而移动的具体位数取决于轮数 <span class="math inline">\(i\)</span>，规则如下：</p>
<ul>
<li>在第 <span class="math inline">\(i=1,2,9,16\)</span>
轮中，左右两部分向左移动一位</li>
<li>在 <span class="math inline">\(i\neq 1,2,9,16\)</span>
的其他轮种，左右两部分向左移动两位</li>
</ul>
<blockquote>
<p>循环移动的位置的总数位 <span class="math inline">\(4·1+12·2=28\)</span>，这将带来一个有趣的属性，即
<span class="math inline">\(C_0=C_{16}\)</span> 和 <span class="math inline">\(D_0=D_{16}\)</span>。而这对解密密钥编排
(其中子密钥都是逆序生成的) 非常有用。</p>
</blockquote>
<p><span class="math inline">\(k_i\)</span> 的第二次置换过程图如下：</p>
<figure>
<img src="/des-note/DES%20密钥置换.png" alt="DES 密钥置换">
<figcaption aria-hidden="true">DES 密钥置换</figcaption>
</figure>
<blockquote>
<p>例如对于 01010111 循环移位两位的结果为 01011101</p>
</blockquote>
<p>为了得到 48 位的轮密钥 <span class="math inline">\(k_i\)</span>，左右两部分需要再次进行压缩置换
(第二次置换)。</p>
<p>因为这个过程中，即<strong>置换了每位的顺序</strong>，又<strong>选择了子密钥</strong>，因此称为压缩置换
(注意表中没有 9，18，22，25，35，38，43 和 54
共八位)。压缩置换表如下：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 压缩置换，将56位密钥压缩为48位子密钥</span></span><br><span class="line"><span class="keyword">int</span> PC_2[] = &#123;<span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>,  <span class="number">1</span>,  <span class="number">5</span>,</span><br><span class="line">			   <span class="number">3</span>, <span class="number">28</span>, <span class="number">15</span>,  <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>,</span><br><span class="line">			  <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>,  <span class="number">4</span>, <span class="number">26</span>,  <span class="number">8</span>,</span><br><span class="line">			  <span class="number">16</span>,  <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>,  <span class="number">2</span>,</span><br><span class="line">			  <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>,</span><br><span class="line">			  <span class="number">30</span>, <span class="number">40</span>, <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>,</span><br><span class="line">			  <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>, <span class="number">34</span>, <span class="number">53</span>,</span><br><span class="line">			  <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span>&#125;;</span><br></pre></td></tr></table></figure>
<p>同时每轮左移的位数如下：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 每轮左移的位数</span></span><br><span class="line"><span class="keyword">int</span> shiftBits[] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>&#125;;</span><br></pre></td></tr></table></figure>
<p>最后通过不断的左移后压缩置换，我们依次得到了 <span class="math inline">\(k_1,k_2\cdots
k_{16}\)</span>。(上一次的输出为下一次的输入)</p>
<h2 id="轮函数-f">轮函数 <span class="math inline">\(f\)</span></h2>
<p>在第 <span class="math inline">\(i\)</span> 轮种，<span class="math inline">\(f\)</span> 函数的输入为前一轮输出的右半部分 <span class="math inline">\(R_{i-1}\)</span> 和当前轮密钥 <span class="math inline">\(k_i\)</span>。</p>
<p><span class="math inline">\(f\)</span>
函数的输出将被作异或掩码，用来加密左半部分输入位 <span class="math inline">\(L_{i-1}\)</span>，即与左半部分异或。</p>
<p><span class="math inline">\(f\)</span> 函数结构如图所示：</p>
<figure>
<img src="/des-note/轮函数对应框图.png" alt="轮函数对应框图">
<figcaption aria-hidden="true">轮函数对应框图</figcaption>
</figure>
<p>从上图可知，<span class="math inline">\(f\)</span> 函数首先将输入分成
8 个 4 位的分组，然后将每个分组扩展为 6 位，从而将 32 位的输入扩展为 48
位。这个过程在 E-盒中进行，E-盒是一种特殊的置换。</p>
<h3 id="e-盒置换-e-扩展置换">E 盒置换 (E 扩展置换)</h3>
<p>扩展置置换<strong>目标</strong>是IP置换后获得的右半部分R0，将32位输入扩展为48位(分为4位×8组)输出。</p>
<p>扩展置换<strong>目的</strong>有两个：生成与密钥相同长度的数据以进行异或运算；提供更长的结果，在后续的替代运算中可以进行压缩。</p>
<p>其过程如下图，即将 4 位扩展为 6 位。</p>
<figure>
<img src="/des-note/E%20扩展置换.png" alt="E 扩展置换">
<figcaption aria-hidden="true">E 扩展置换</figcaption>
</figure>
<p>扩展置换表 E 如下：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// E盒扩展置换表，将32位输入扩展至48位输出</span></span><br><span class="line"><span class="keyword">int</span> E[] = &#123;<span class="number">32</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>,</span><br><span class="line">		    <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>,</span><br><span class="line">		    <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>,</span><br><span class="line">		   <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>,</span><br><span class="line">		   <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">		   <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>,</span><br><span class="line">		   <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>,</span><br><span class="line">		   <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>,  <span class="number">1</span>&#125;;</span><br></pre></td></tr></table></figure>
<p>可以看出，扩展的数据是从相邻两组分别取靠近的一位，4位变为6位。靠近32位的位为1，靠近1位的位为32。表中第二行的4取自上组中的末位，9取自下组中的首位。</p>
<p>可以发现，扩展盒增加了 DES
的扩散行为，因为某些输入位会影响两个不同的输出位置。</p>
<h3 id="s-盒置换">S 盒置换</h3>
<p>将扩展得到的 48 位结果与轮密钥 <span class="math inline">\(k_i\)</span> 进行异或操作，并将 8 个 6
位长的分组送入 8 个不同的 S-盒中，它将 6 位的输入映射为 4 位的输出。</p>
<p>具体的操作为：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; <span class="number">48</span>; i += <span class="number">6</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> row = (expandRi[i] &lt;&lt; <span class="number">1</span>) | expandRi[i + <span class="number">5</span>];</span><br><span class="line">    <span class="keyword">int</span> col = (expandRi[i + <span class="number">1</span>] &lt;&lt; <span class="number">3</span>) | (expandRi[i + <span class="number">2</span>] &lt;&lt; <span class="number">2</span>) | (expandRi[i + <span class="number">3</span>] &lt;&lt; <span class="number">1</span>) | expandRi[i + <span class="number">4</span>];</span><br><span class="line">    <span class="keyword">int</span> num = S_BOX[i / <span class="number">6</span>][row][col];</span><br><span class="line">    mappingRi[j++] = num &amp; <span class="number">1</span>;</span><br><span class="line">    mappingRi[j++] = num &amp; <span class="number">2</span>;</span><br><span class="line">    mappingRi[j++] = num &amp; <span class="number">4</span>;</span><br><span class="line">    mappingRi[j++] = num &amp; <span class="number">8</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以下是 8 个 S-盒：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// S盒置换表，每个S盒是4x16的置换表，6位输入映射为4位输出</span></span><br><span class="line"><span class="keyword">int</span> S_BOX[<span class="number">8</span>][<span class="number">4</span>][<span class="number">16</span>] = &#123;</span><br><span class="line">	&#123;  </span><br><span class="line">		&#123;<span class="number">14</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">7</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">0</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">4</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>&#125;, </span><br><span class="line">		&#123;<span class="number">15</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">13</span>&#125; </span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;  </span><br><span class="line">		&#123;<span class="number">15</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">3</span>,<span class="number">13</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">5</span>&#125;, </span><br><span class="line">		&#123;<span class="number">0</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">15</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">9</span>&#125;  </span><br><span class="line">	&#125;, </span><br><span class="line">	&#123;  </span><br><span class="line">		&#123;<span class="number">10</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">13</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">1</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">13</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">7</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">12</span>&#125;  </span><br><span class="line">	&#125;, </span><br><span class="line">	&#123;  </span><br><span class="line">		&#123;<span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">15</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">9</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">3</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">14</span>&#125;  </span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;  </span><br><span class="line">		&#123;<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">14</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">6</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">14</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">11</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>&#125;  </span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;  </span><br><span class="line">		&#123;<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">10</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">8</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>,<span class="number">6</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>&#125;  </span><br><span class="line">	&#125;, </span><br><span class="line">	&#123;  </span><br><span class="line">		&#123;<span class="number">4</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">1</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">13</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">8</span>,<span class="number">6</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">1</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>&#125;  </span><br><span class="line">	&#125;, </span><br><span class="line">	&#123;  </span><br><span class="line">		&#123;<span class="number">13</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">7</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">2</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>&#125;,  </span><br><span class="line">		&#123;<span class="number">2</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>&#125;  </span><br><span class="line">	&#125; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="p-盒置换">P 盒置换</h3>
<p>将 S 盒置换得到的 32 位输出按照 P
盒进行置换，把输入的每一位映射到输出位，任何一位不能被映射两次，也不能略去。</p>
<p>P 盒置换表如下：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// P盒置换表，32位输入映射为32位输出</span></span><br><span class="line"><span class="keyword">int</span> P[] = &#123;<span class="number">16</span>,  <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">		   <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>,</span><br><span class="line">		    <span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>,</span><br><span class="line">		    <span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>,</span><br><span class="line">		    <span class="number">2</span>,  <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>,</span><br><span class="line">		   <span class="number">32</span>, <span class="number">27</span>,  <span class="number">3</span>,  <span class="number">9</span>,</span><br><span class="line">		   <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>,  <span class="number">6</span>,</span><br><span class="line">		   <span class="number">22</span>, <span class="number">11</span>,  <span class="number">4</span>, <span class="number">25</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>通过以上，可以知道，轮函数总共三个步骤。</p>
<ol type="1">
<li>将 32 位输入通过 E 盒置换输出为 48 位；</li>
<li>将 48 位输出跟轮密钥进行异或，再作为 S 盒置换的输入，映射为 32
位；</li>
<li>最后将 32 位的输出作为 P 盒置换的输入，把每一位映射到输出位。</li>
</ol>
<h2 id="逆初始置换-ip-1">逆初始置换 <span class="math inline">\(IP^{-1}\)</span></h2>
<p>合并 <span class="math inline">\(L_{16}\)</span> 和 <span class="math inline">\(R_{16}\)</span> 得到一个 64bits 的数据（即 <span class="math inline">\(R_{16}L_{16}\)</span>），再经过逆初始置换一次，得到密文。</p>
<p>逆初始置换表如下：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 逆初始置换表 IP^(-1)</span></span><br><span class="line"><span class="keyword">int</span> IP_1[] = &#123;<span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>,</span><br><span class="line">			  <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line">			  <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>,</span><br><span class="line">			  <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line">			  <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>,</span><br><span class="line">			  <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">			  <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>,</span><br><span class="line">			  <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>,  <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="逆向密钥置换">逆向密钥置换</h2>
<blockquote>
<p>该小节可以不作了解</p>
</blockquote>
<p>因为 <span class="math inline">\(C_0=C_{16}\)</span> 和 <span class="math inline">\(D_0=D_{16}\)</span>，因此我们可以在第一次置换后，直接得到
<span class="math inline">\(k_{16}\)</span>。 <span class="math display">\[
\begin{align}
k_{16}&amp;=PC-2(C_{16},D_{16})\\
&amp;=PC-2(C_0,D_0)\\
&amp;=PC-2(PC-1(k))
\end{align}
\]</span></p>
<p>而计算 <span class="math inline">\(k_{15}\)</span> 时，需要中间变量
<span class="math inline">\(C_{15}\)</span> 和 <span class="math inline">\(D_{15}\)</span>，而这两个变量都可以由 <span class="math inline">\(C_{16}\)</span> 和 <span class="math inline">\(D_{16}\)</span> 经过循环右移得到： <span class="math display">\[
\begin{align}
k_{15}&amp;=PC-2(C_{15},D_{15})\\
&amp;=PC-2(RS_2(C_{16},RS_2(D_{16})))\\
&amp;=PC-2(RS_2(C_0),RS_2(D_0))
\end{align}
\]</span> 同理，后面的轮密钥 <span class="math inline">\(k_{14},k_{13},\cdots,k_1\)</span>
都是通过类似的方式右移得到的。</p>
<p>在解密模式中，每个轮密钥向右移动的位数为：</p>
<ul>
<li>在解密的第 1 轮中，密钥不移位</li>
<li>在解密的第 2、9 和 16 轮中，左右两位部分均向右移动一位</li>
<li>在 3、4、5、6、7、8、10、11、12、13、14 和 15
轮种，左右两部分均向右移动两位</li>
</ul>
<figure>
<img src="/des-note/逆向密钥置换流程图.png" alt="逆向密钥置换流程图">
<figcaption aria-hidden="true">逆向密钥置换流程图</figcaption>
</figure>
<h2 id="加密算法描述">加密算法描述</h2>
<ol type="1">
<li>将 8 字节即 64 位密钥作为输入，按照密钥置换函数 <span class="math inline">\(PC-1\)</span> 进行压缩置换，变成 56 位</li>
<li>再将输出分为左 28 位和右 28 位的 <span class="math inline">\(C_0,D_0\)</span>，将这两部分进行 16
轮的循环左移及压缩置换 <span class="math inline">\(PC-2\)</span>，依次将上一轮的输出作为下一轮的输入，最后生成
16 个 48 位的轮密钥 (子密钥) <span class="math inline">\(k_1,k_2,\cdots,k_{16}\)</span></li>
<li>加密算法的输入为 64 位明文，对明文进行初始置换 <span class="math inline">\(IP\)</span>，得到 64 位输出，将其均分为左 32
位和右 32 位的 <span class="math inline">\(L_0,R_0\)</span>，将它们作为轮函数 <span class="math inline">\(f\)</span> 的首次输入</li>
<li>轮函数将 <span class="math inline">\(R_0\)</span> 通过 E
盒扩展置换从 32 位变为 48 位</li>
<li>扩展后的 48 位与 <span class="math inline">\(k_1\)</span>
进行异或</li>
<li>异或后的结果再通过 S 盒置换从 48 位变为 32 位</li>
<li>将上一步的输出作为 P 盒置换的输入，得到 32 位的输出</li>
<li>将上一步的输出与左半部分进行异或运算，再将左右部分交换得到 <span class="math inline">\(L_1,R_1\)</span></li>
<li>重复步骤 4~8，其中轮函数的输入为上一轮的输出，共计重复 16
轮迭代，得到 <span class="math inline">\(L_{16},R_{16}\)</span></li>
<li>将 <span class="math inline">\(L_{16}\)</span> 和 <span class="math inline">\(R_{16}\)</span> 交换后合并，得到 64 位的输出
(<span class="math inline">\(R_{16}L_{16}\)</span>)</li>
<li>将输出经过一次逆初始置换 <span class="math inline">\(IP^{-1}\)</span> 即可得到 64 位密文</li>
</ol>
<h2 id="解密算法描述">解密算法描述</h2>
<ol type="1">
<li>与加密算法类似，但是进行逆向密钥置换，得到密钥 <span class="math inline">\(k_{16},k_{15},\cdots,k_1\)</span></li>
<li>再同理将密文作为轮函数输入，但第一次轮函数过程中不与 <span class="math inline">\(k_1\)</span> 异或，而是与 <span class="math inline">\(k_{16}\)</span> 进行异或</li>
<li>经过 16 轮迭代后，最终得到 <span class="math inline">\(L_{16},R_{16}\)</span></li>
<li>将 <span class="math inline">\(L_{16},R_{16}\)</span> 互换后合并为
64 位输出 (<span class="math inline">\(R_{16}L_{16}\)</span>)</li>
<li>再对 64 位输出经过一次逆初始置换 <span class="math inline">\(IP^{-1}\)</span> 即可得到 64 位明文</li>
</ol>
<h1 id="des-算法实现">DES 算法实现</h1>
<p>请查看 <a href="https://github.com/HasegawaAzusa/DES">https://github.com/HasegawaAzusa/DES</a></p>
<p>代码堪堪能运行而已，仅作示例和理解。</p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>python 逆向笔记</title>
    <url>//re-python-note.html</url>
    <content><![CDATA[<h1 id="pyc-文件">PYC 文件</h1>
<p>pyc 文件是 python 在编译过程中出现的主要中间过程文件。pyc
文件是二进制的，类似 java 的字节码，可以由 python 虚拟机直接执行的。</p>
<h2 id="pycodeobject">PyCodeObject</h2>
<p>实际上，pyc 文件就是 PyCodeObject 对象在硬盘上的保存形式。</p>
<p>而 PyCodeObject 的结构如下：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    PyObject_HEAD</span><br><span class="line">    <span class="keyword">int</span> co_argcount;        <span class="comment">/* 位置参数个数 */</span></span><br><span class="line">    <span class="keyword">int</span> co_nlocals;         <span class="comment">/* 局部变量个数 */</span></span><br><span class="line">    <span class="keyword">int</span> co_stacksize;       <span class="comment">/* 栈大小 */</span></span><br><span class="line">    <span class="keyword">int</span> co_flags;   </span><br><span class="line">    PyObject *co_code;      <span class="comment">/* 字节码指令序列 */</span></span><br><span class="line">    PyObject *co_consts;    <span class="comment">/* 所有常量集合 */</span></span><br><span class="line">    PyObject *co_names;     <span class="comment">/* 所有符号名称集合 */</span></span><br><span class="line">    PyObject *co_varnames;  <span class="comment">/* 局部变量名称集合 */</span></span><br><span class="line">    PyObject *co_freevars;  <span class="comment">/* 闭包用的的变量名集合 */</span></span><br><span class="line">    PyObject *co_cellvars;  <span class="comment">/* 内部嵌套函数引用的变量名集合 */</span></span><br><span class="line">    <span class="comment">/* The rest doesn’t count for hash/cmp */</span></span><br><span class="line">    PyObject *co_filename;  <span class="comment">/* 代码所在文件名 */</span></span><br><span class="line">    PyObject *co_name;      <span class="comment">/* 模块名|函数名|类名 */</span></span><br><span class="line">    <span class="keyword">int</span> co_firstlineno;     <span class="comment">/* 代码块在文件中的起始行号 */</span></span><br><span class="line">    PyObject *co_lnotab;    <span class="comment">/* 字节码指令和行号的对应关系 */</span></span><br><span class="line">    <span class="keyword">void</span> *co_zombieframe;   <span class="comment">/* for optimization only (see frameobject.c) */</span></span><br><span class="line">&#125; PyCodeObject;</span><br></pre></td></tr></table></figure>
<h2 id="pyobject_head">PyObject_HEAD</h2>
<p>不同的 Python 版本会有不同的
PyObject_HEAD，以下是各版本的文件头：</p>
<table>
<thead>
<tr class="header">
<th>Python 版本</th>
<th>十六进制文件头</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Python 2.7</td>
<td><code>03f30d0a00000000</code></td>
</tr>
<tr class="even">
<td>Python 3.0</td>
<td><code>3b0c0d0a00000000</code></td>
</tr>
<tr class="odd">
<td>Python 3.1</td>
<td><code>4f0c0d0a00000000</code></td>
</tr>
<tr class="even">
<td>Python 3.2</td>
<td><code>6c0c0d0a00000000</code></td>
</tr>
<tr class="odd">
<td>Python 3.3</td>
<td><code>9e0c0d0a0000000000000000</code></td>
</tr>
<tr class="even">
<td>Python 3.4</td>
<td><code>ee0c0d0a0000000000000000</code></td>
</tr>
<tr class="odd">
<td>Python 3.5</td>
<td><code>170d0d0a0000000000000000</code></td>
</tr>
<tr class="even">
<td>Python 3.6</td>
<td><code>330d0d0a0000000000000000</code></td>
</tr>
<tr class="odd">
<td>Python 3.7</td>
<td><code>420d0d0a000000000000000000000000</code></td>
</tr>
<tr class="even">
<td>Python 3.8</td>
<td><code>550d0d0a000000000000000000000000</code></td>
</tr>
<tr class="odd">
<td>Python 3.9</td>
<td><code>610d0d0a000000000000000000000000</code></td>
</tr>
<tr class="even">
<td>Python 3.10</td>
<td><code>6f0d0d0a000000000000000000000000</code></td>
</tr>
</tbody>
</table>
<p>可以注意到，实际上有改变的只有开头的<strong>两个字节</strong>。</p>
<h2 id="反编译">反编译</h2>
<p>使用 uncompyle 可以将 pyc 文件完美反编译。<a href="https://github.com/rocky/python-uncompyle6">uncompyle6
Github主页</a></p>
<p>可以直接使用 pip 包管理工具安装：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip3 install uncompyle</span><br></pre></td></tr></table></figure>
<p>而 uncompyle 用法如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uncompyle6 *.pyc</span><br></pre></td></tr></table></figure>
<p>uncomyle6 会直接将反编译后的源码输出在标准输出中，推荐用法：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uncompyle6 *.pyc &gt; filename</span><br></pre></td></tr></table></figure>
<p>将源码输出到文件里面，比如说：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uncompyle6 test.pyc &gt; test.py</span><br></pre></td></tr></table></figure>
<h2 id="反反编译">反反编译</h2>
<h3 id="更改魔术头">更改魔术头</h3>
<p>当想要保护我们的 pyc 文件不被反编译，最简单的做法就是更改魔术头，即
PyObject_HEAD。</p>
<p>可能是完全删除魔术头，也可能是修改为不是原生版本的魔术头，我们只需要根据情况添加或修改即可。</p>
<p>有关魔术头可以直接参考 <a href="#PyObject_HEAD">PyObject_HEAD</a></p>
<h1 id="exe-文件">EXE 文件</h1>
<p>使用 PyInstaller 进行封装的 exe 可执行文件，可以使用 pyinstxtractor
进行反编译。<a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor
Github主页</a></p>
<p>基本用法：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 pyinstxtractor.py *.exe</span><br></pre></td></tr></table></figure>
<p>pyinstxtractor 会将 exe 文件拆分回单独的 pyc 文件、pyd 文件，并且会在
pyc 文件中加入当前 python 版本的魔术头
(如果原代码版本不是所使用的版本，会有 warning 提示，需要注意)。</p>
<h1 id="pyd-文件">PYD 文件</h1>
<p>pyd 文件相当于 python 的运行时 dll，在 python 代码中可以直接使用
<code>import</code> 将 pyd 文件当作模块导入。</p>
<p>对于 pyd 的逆向，我们需要借助 ida 的 <code>attach</code>
动态调试跟静态分析。</p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>re</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>图片取证笔记</title>
    <url>//picture-forensics-note.html</url>
    <content><![CDATA[<h1 id="图片取证">图片取证</h1>
<h2 id="简述">简述</h2>
<p>图片取证主要包括隐写 (Steganography)，拼图，读图等。</p>
<p>同时图片又有多种格式，包括但不限于 GIP, PNG, JPEG 等。</p>
<p>以下的各种图片取证形式不限于单一格式。</p>
<h2 id="图片像素差异">图片像素差异</h2>
<p>以下是提取差异像素的示例脚本，注意如果差异的像素是
<code>white</code>，需要将 <code>diff</code>
的初始颜色改为其他颜色。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">comparison = <span class="string">&quot;to.png&quot;</span></span><br><span class="line">target = <span class="string">&quot;to_do.png&quot;</span></span><br><span class="line"></span><br><span class="line">comparison = Image.<span class="built_in">open</span>(comparison)</span><br><span class="line">target = Image.<span class="built_in">open</span>(target)</span><br><span class="line">diff = Image.new(comparison.mode ,comparison.size, <span class="string">&#x27;white&#x27;</span>)</span><br><span class="line"></span><br><span class="line">dcomparison = comparison.load()</span><br><span class="line">dtarget = target.load()</span><br><span class="line">ddiff = diff.load()</span><br><span class="line"></span><br><span class="line">width, height = comparison.size</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">if</span> dcomparison[w, h] != dtarget[w, h]:</span><br><span class="line">            ddiff[w, h] = dtarget[w, h]</span><br><span class="line"></span><br><span class="line">diff.save(<span class="string">&quot;diff.png&quot;</span>, comparison.<span class="built_in">format</span>)</span><br></pre></td></tr></table></figure>
<h2 id="盲水印">盲水印</h2>
<p>主要是使用了 <a href="https://github.com/chishaxie/BlindWaterMark">BlindWaterMark</a>
项目，使用方法：</p>
<ul>
<li><p>加盲水印</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 bwm.py encode 原图.png 水印图.png 输出.png</span><br></pre></td></tr></table></figure></li>
<li><p>解盲水印</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 bwm.py encode 原图.png 盲水印图.png 输出.png</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>需要注意的是，盲水印项目要求</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">opencv-python==<span class="number">4.2</span><span class="number">.0</span><span class="number">.34</span></span><br><span class="line">matplotlib==<span class="number">2.1</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>特别注意！！！</p>
<p>程序 python2 和 python3 版本的加解密结果会有所不同，主要原因是
python2 和 python3 random 的算法不同，如果要让 python3 兼容 python2 的
random 算法请加 <code>--oldseed</code> 参数。</p>
<h2 id="图片拼接">图片拼接</h2>
<p>实现对多张图片的拼接，我们可以使用 <code>montage</code> 软件 (Linux
软件)。</p>
<p>因为 <code>montage</code> 软件可以将图像平铺到可自定义的网格中。</p>
<p>更多关于 <code>montage</code> 软件的使用可以查看：<a href="https://imagemagick.org/">https://imagemagick.org/</a></p>
<p><code>montage</code> 软件有以下操作：</p>
<ul>
<li>将图像平铺到网格中，自动调整大于网格单元大小的图像大小：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">montage &#123;&#123;image1.png&#125;&#125; &#123;&#123;image2.jpg&#125;&#125; &#123;&#123;imageN.png&#125;&#125; montage.jpg</span><br></pre></td></tr></table></figure>
<ul>
<li>将图像平铺成网格，从最大的图像自动计算网格单元大小：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">montage &#123;&#123;image1.png&#125;&#125; &#123;&#123;image2.jpg&#125;&#125; &#123;&#123;imageN.png&#125;&#125; -geometry +0+0 montage.jpg</span><br></pre></td></tr></table></figure>
<ul>
<li>在平铺之前设置网格单元大小并调整图像大小以适应它：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">montage &#123;&#123;image1.png&#125;&#125; &#123;&#123;image2.jpg&#125;&#125; &#123;&#123;imageN.png&#125;&#125; -geometry 640x480+0+0 montage.jpg</span><br></pre></td></tr></table></figure>
<ul>
<li>限制网格中的行数和列数，导致输入图像溢出到多个输出蒙太奇：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">montage &#123;&#123;image1.png&#125;&#125; &#123;&#123;image2.jpg&#125;&#125; &#123;&#123;imageN.png&#125;&#125; -geometry +0+0 -tile 2x3 montage_%d.jpg</span><br></pre></td></tr></table></figure>
<ul>
<li>在平铺之前调整图像大小并裁剪图像以完全填充其网格单元：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">montage &#123;&#123;image1.png&#125;&#125; &#123;&#123;image2.jpg&#125;&#125; &#123;&#123;imageN.png&#125;&#125; -geometry +0+0 -resize 640x480^ -gravity center -crop 640x480+0+0 montage.jpg</span><br></pre></td></tr></table></figure>
<p>例如我们想要横向拼接 <code>flag-0.png</code>、<code>flag-1.png</code>
等图片，输出文件名为 <code>flag.png</code>，可以使用如下命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">montage flag*.png -tile x1 -geometry +1+0 flag.png </span><br></pre></td></tr></table></figure>
<p>最终获得间隔 1 个像素，横向拼接的图片：</p>
<figure>
<img src="/picture-forensics-note/montage%20横向拼接.png" alt="montage 横向拼接">
<figcaption aria-hidden="true">montage 横向拼接</figcaption>
</figure>
<h2 id="拼图">拼图</h2>
<p>拼图问题我们可以使用
<code>gaps</code>，一个基于遗传算法的拼图求解器，具有块大小自动检测功能
(最好使用 Linux 安装)。<a href="https://github.com/nemanja-m/gaps">Gaps
Github 主页</a></p>
<p><code>gaps</code> 参数如下</p>
<table>
<thead>
<tr class="header">
<th>选项</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>--image</code></td>
<td>拼图路径</td>
</tr>
<tr class="even">
<td><code>--size</code></td>
<td>拼图大小 (以像素为单位)</td>
</tr>
<tr class="odd">
<td><code>--generations</code></td>
<td>遗传算法的代数</td>
</tr>
<tr class="even">
<td><code>--population</code></td>
<td>遗传算法中的人数</td>
</tr>
<tr class="odd">
<td><code>--verbose</code></td>
<td>在每一代之后显示最佳解决方案</td>
</tr>
<tr class="even">
<td><code>--save</code></td>
<td>将拼图结果另存为图像</td>
</tr>
</tbody>
</table>
<p>同时可以使用 <code>gaps --help</code> 获取更多帮助。</p>
<p>如果没有明确提供 <code>--size</code> 参数，<code>gaps</code>
会自动检测块的大小。</p>
<h2 id="自动化隐写探测">自动化隐写探测</h2>
<p>隐写工具 <code>zsteg</code> 可以检测 PNG 和 BMP 图片里的隐写数据，在
Linux 里可以直接安装使用。<a href="https://github.com/zed-0xff/zsteg">zsteg Github 主页</a></p>
<p>目前，<code>zsteg</code> 支持检测：</p>
<ul>
<li>LSB steganography in PNG &amp; BMP</li>
<li>zlib-compressed data</li>
<li>OpenStego</li>
<li>Camouflage 1.2.1</li>
<li>LSB with The Eratosthenes set</li>
</ul>
<p>使用方法：scanf("%d, %d", &amp;a, &amp;b);</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">zsteg 可疑图片.png</span><br></pre></td></tr></table></figure>
<p>更多用法请使用 <code>zsteg -h</code> 或者查看 Github 主页。</p>
<h1 id="png-取证">PNG 取证</h1>
<h2 id="简述-1">简述</h2>
<p>以下的各种图片取证形式仅限于 PNG 图片格式。</p>
<h2 id="图片-ihdr-crc32-错误">图片 <code>IHDR</code> CRC32 错误</h2>
<p>一般情况下这是因为宽度或者高度被篡改的缘故，可以使用以下代码对图片的宽度或者长度进行爆破：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_height</span>(<span class="params">filename:<span class="built_in">str</span>, needout:<span class="built_in">bool</span>=<span class="literal">True</span></span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        pngdata = f.read()</span><br><span class="line">    height = <span class="built_in">int</span>.from_bytes(pngdata[<span class="number">20</span>:<span class="number">24</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    target = <span class="built_in">int</span>.from_bytes(pngdata[<span class="number">29</span>:<span class="number">33</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(height+<span class="number">1</span>, <span class="number">0xFFFF</span>):</span><br><span class="line">        data = pngdata[<span class="number">12</span>:<span class="number">20</span>] + h.to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>) + pngdata[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        <span class="keyword">if</span> binascii.crc32(data) == target:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Real height: <span class="subst">&#123;h&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> needout:</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;crack_height_&quot;</span> + filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(pngdata[:<span class="number">12</span>] + data + pngdata[<span class="number">29</span>:])</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;height is real.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_width</span>(<span class="params">filename:<span class="built_in">str</span>, needout:<span class="built_in">bool</span>=<span class="literal">True</span></span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        pngdata = f.read()</span><br><span class="line">    width = <span class="built_in">int</span>.from_bytes(pngdata[<span class="number">16</span>:<span class="number">20</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    target = <span class="built_in">int</span>.from_bytes(pngdata[<span class="number">29</span>:<span class="number">33</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(width+<span class="number">1</span>, <span class="number">0xFFFF</span>):</span><br><span class="line">        data = pngdata[<span class="number">12</span>:<span class="number">16</span>] + w.to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>) + pngdata[<span class="number">20</span>:<span class="number">29</span>]</span><br><span class="line">        <span class="keyword">if</span> binascii.crc32(data) == target:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Real width: <span class="subst">&#123;w&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> needout:</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;crack_width_&quot;</span> + filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(pngdata[:<span class="number">12</span>] + data + pngdata[<span class="number">29</span>:])</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;width is real.&quot;</span>)</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&#x27;false_height.png&#x27;</span></span><br><span class="line">crack_height(filename)</span><br></pre></td></tr></table></figure>
<p><a href="https://adworld.xctf.org.cn/task/answer?type=misc&amp;number=1&amp;grade=1&amp;id=5432&amp;page=1">示例题目</a></p>
<h1 id="gif-取证">GIF 取证</h1>
<h2 id="简述-2">简述</h2>
<p>以下的各种图片取证形式仅限于 GIF 图片格式。</p>
<h2 id="gif-分离">GIF 分离</h2>
<p>如果需要对每一帧图片进行详细操作的话，最好使用 photoshop 打开 GIF
图片，PS 会自动将 GIF 图片的每一帧转换为图层。</p>
<p>也可以使用在线网站获取每一帧：<a href="https://tu.sioe.cn/gj/fenjie/">https://tu.sioe.cn/gj/fenjie/</a></p>
<p>但是最简单的获取 GIF 每一帧图片的方式，可以通过使用
<code>convert</code> 软件 (Linux 软件)。</p>
<p>有关 <code>convert</code> 软件更多详情可以查看 <a href="https://imagemagick.org/">https://imagemagick.org/</a></p>
<p>以下只介绍 <code>convert</code> 分离 GIF 每一帧的用法：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">convert target.gif 输出名.png</span><br></pre></td></tr></table></figure>
<p>例如输入参数为
<code>convert target.gif flag.png</code>，那么软件将会把
<code>target.gif</code> 的每一帧转换为
<code>flag-0.png</code>、<code>flag-1.png</code> 等等，如图所示：</p>
<figure>
<img src="/picture-forensics-note/convert%20处理后.png" alt="convert 处理后">
<figcaption aria-hidden="true">convert 处理后</figcaption>
</figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>misc</tag>
        <tag>forensics</tag>
      </tags>
  </entry>
  <entry>
    <title>Git与CRLF笔记</title>
    <url>//git-crlf-note.html</url>
    <content><![CDATA[<h1 id="crlf-与-lf-简述">CRLF 与 LF 简述</h1>
<ul>
<li>CR → Carriage Return，对应ASCII中转义字符
<code>\r</code>，十六进制为 <code>0D</code>，表示回车</li>
<li>LF → Linefeed，对应ASCII中转义字符 <code>\n</code>，十六进制为
<code>0A</code> 表示换行</li>
<li>CRLF → Carriage Return &amp; Linefeed，<code>\r\n</code>，十六进制为
<code>0D0A</code>，表示回车并换行</li>
</ul>
<p>实际上，这与不同的操作系统有关，Windows 平台下使用 CRLF
表示换行；Unix/Linux/Mac OS X 平台下使用单字符 LF 表示换行；而 MacIntosh
(即早期 Mac 操作系统) 采用 CR 表示换行。</p>
<blockquote>
<p>需要注意到的是，在 Windows 平台下，如果在命令行环境下打印
<code>\r</code> 字符，会将光标前移到第一位。</p>
</blockquote>
<h1 id="git-与-crlf">Git 与 CRLF</h1>
<p>我们知道 Git
是版本管理工具，而跨平台开发也是经常性的事情。这个时候注意到，如果 Linux
下的代码文件，被 Git 拉取到 Windows 平台下时，很可能出现 Windows
平台下出现读取错误、编译错误等问题。</p>
<p>所以 Git 提供了一个名为 <code>core.autocrlf</code>
的配置，可以将换行结尾自动化转换。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global core.autocrlf  [<span class="literal">true</span> | input | <span class="literal">false</span>]</span><br><span class="line">git config --<span class="built_in">local</span> core.autocrlf  [<span class="literal">true</span> | input | <span class="literal">false</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li><code>true</code> → 提交新版本时，将所有换行结尾转换为
CRLF；回退版本时，将所有换行结尾转换为 CRLF。</li>
<li><code>input</code> → 提交新版本时，将所有换行结尾转换为
CRLF；回退版本时，不转换。</li>
<li><code>false</code> → 提交新版本和回退版本时，都不转换。</li>
</ul>
<p>但此项设置只针对 CRLF 和 LF 单一存在的文本文件。</p>
<p>如果想要检查出 CRLF 和 LF 混合存在的文本文件，需要使用
<code>core.safecrlf</code> 配置：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global core.safecrlf [<span class="literal">true</span> | <span class="literal">false</span> | warn]</span><br></pre></td></tr></table></figure>
<ul>
<li><code>true</code> → 禁止提交混合换行符的文本文件。</li>
<li><code>false</code> → 不禁止提交混合换行符的文本文件。</li>
<li><code>warn</code> → 提交混合换行符的文本文件时发出警告。</li>
</ul>
<p>一般来说在进行跨平台开发时，建议使用以下指令，防止发生换行符异常问题。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --<span class="built_in">local</span> core.autocrlf <span class="literal">true</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>git</tag>
        <tag>windows</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>镜像取证笔记</title>
    <url>/post/image-forensics-note.html</url>
    <content><![CDATA[<h1 id="镜像取证">镜像取证</h1>
<p>活取证是在主机存活时发现系统被入侵,然后直接把机器的运行内存 dump
下来，对运行内存进行分析，还原一些进程的中的信息。</p>
<p>主要的工作包括但不限于</p>
<ul>
<li>抓取文件 metadata (元数据)</li>
<li>创建时间线</li>
<li>命令历史</li>
<li>分析日志文件</li>
<li>哈希摘要</li>
<li>转存内存信息</li>
</ul>
<p>而死取证是对机器的磁盘做镜像之后进行分析，在关机后制作硬盘镜像，分析镜像（MBR硬盘分区,GPT全局分区表,LVM逻辑卷）是否存在病毒,木马等恶意程序。</p>
<p>不管是那种取证方式都应尽量避免破环犯罪现场，例如通过内存转储工具对内存进行快照，通过磁盘克隆工具对磁盘进行克隆，方便后期的分析工作。</p>
<h2 id="磁盘取证">磁盘取证</h2>
<h3 id="ext-磁盘映像挂载">ext 磁盘映像挂载</h3>
<p>在 Windows 中可以使用 <a href="http://www.chrysocome.net/explore2fs">explore2fs</a> 临时挂载 ext
文件系统的磁盘映像，但是我们只可以看到未被删除的文件，同时也不可以进行写的操作。</p>
<h3 id="ext3-ext4-磁盘映像恢复已删除文件">ext3 / ext4
磁盘映像恢复已删除文件</h3>
<p>我们可以使用 <code>extundelete</code> 软件恢复 ext3 / ext4
磁盘映像下已经被删除的文件，但无法保证任何特定文件都能够被取消删除。</p>
<p><code>extundelete</code> 是 Linux 的软件，例如 Debian
系的发行版我们都可以直接使用 <code>apt install extundelete</code>
安装此软件。</p>
<p>只需使用以下简单命令便可以恢复已删除文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">extundelete disk-image --restore-all</span><br></pre></td></tr></table></figure>
<h2 id="内存取证">内存取证</h2>
<p>内存取证主要依赖于 <code>volatiliy</code> 工具，现在已经更新到
python3 的版本了。</p>
<p>具体有关 <code>volatiliy3</code> 的操作可以参考 <a href="/vol3-note.html">volatility3 使用笔记</a>。</p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>forensics</tag>
      </tags>
  </entry>
  <entry>
    <title>rockstar 语言笔记</title>
    <url>//rockstar-note.html</url>
    <content><![CDATA[<h1 id="rockstar-简述">Rockstar 简述</h1>
<p>Rockstar
是一种动态类型的计算机编程语言，专为创建歌词程序而设计。Rockstar 深受
1980 年代硬摇滚和力量民谣的抒情惯例的影响。</p>
<p>Github 主页: <a href="https://github.com/RockstarLang/rockstar">https://github.com/RockstarLang/rockstar</a></p>
<p>Rocky 是用 Java 编写的完全符合规范的 Rockstar
实现，是目前唯一支持原始语言规范中描述的 DEC64 数字类型的 Rockstar
实现。</p>
<h1 id="rockstar-规范">rockstar 规范</h1>
<p>rockstar 语言文件一般以 <code>.rock</code>
作为文件后缀，但实质上是文本文件。</p>
<p>公共变量由关键字 a，an，the，my
或自行定义的特定变量名称之一组成，该名称必须仅包含小写ASCII字母 a-z
。变量中允许出现空格。</p>
<p>同时变量是动态类型的，不需要在使用前声明变量。</p>
<p>语言里有所谓的代词，指代解析顺序所确定的最后一个被命名变量。关键字包含
it，she，he，they，ze，hir，zie，zir，xe，xem，ve 和 ver。</p>
<p>赋值和读取语句关键词包括 is，put in，give back ，listen
等。为了保证语言的纯洁性，尽量不要使用阿拉伯数字。</p>
<p>以下是<strong>语言用法示范</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">My heart is true</span><br></pre></td></tr></table></figure>
<p>相当于说 My heart 被赋予布尔逻辑中的真值。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Put my heart in your hand</span><br></pre></td></tr></table></figure>
<p>把 my heart 的值传递给变量 your hand。</p>
<h1 id="rockstar-py">rockstar-py</h1>
<p>rockstar-py 是 rockstar 用 python3 的一个实现。<a href="https://github.com/yyyyyyyan/rockstar-py">rockstar-py
Github主页</a></p>
<p>首先 rockstar-py 仅支持 python3.6 及以上版本，可以直接使用 pip
包管理工具安装它：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip3 install rockstar-py</span><br></pre></td></tr></table></figure>
<p>之后可以使用 <code>rockstar-py -h</code> 以获取更多帮助。</p>
<p>以下仅为<strong>常用参数介绍</strong>：</p>
<ul>
<li><p>将 <code>fizz.rock</code> 文件翻译为 Python 文件
<code>fizz.py</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rockstar-py -i fizz.rock -o fizz.py</span><br></pre></td></tr></table></figure></li>
<li><p>直接运行 <code>fizz.rock</code> 文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rockstar-py -i fizz.rock --<span class="built_in">exec</span></span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>rockstar</tag>
      </tags>
  </entry>
  <entry>
    <title>中国剩余定理CRT笔记</title>
    <url>//CRT-note.html</url>
    <content><![CDATA[<h1 id="描述">描述</h1>
<p>假设整数 <span class="math inline">\(m_1,m_2,\cdots,m_n\)</span>
两两互素，则对于任意的整数 <span class="math inline">\(a_1,a_2,\cdots,a_n\)</span>，方程组 <span class="math display">\[
\begin{cases}
x\equiv a_1\pmod{m_1}\\
x\equiv a_2\pmod{m_2}\\
\cdots\\
x\equiv a_n\pmod{m_n}
\end{cases}
\]</span> 都存在整数解，且若 <span class="math inline">\(X,Y\)</span>
都满足该方程，则必有 <span class="math inline">\(X\equiv
Y\pmod{N}\)</span>，其中 <span class="math inline">\(M=\displaystyle\prod_{i=1}^nm_i\)</span> 。</p>
<p>具体而言，<span class="math inline">\(x\equiv
\displaystyle\sum_{i=1}^na_i\times\frac{M}{m_i}\times\left[\left(\frac{M}{m_i}\right)^{-1}\right]_{m_i}\pmod{M}\\\)</span></p>
<p>这便是<strong>中国剩余定理(Chinese remainder theorem,
CRT)</strong></p>
<p>求解可以使用以下步骤进行构造：</p>
<ol type="1">
<li><p>设 <span class="math inline">\(M=\displaystyle\prod_{i=1}^nm_i\)</span>，并设
<span class="math inline">\(M_i=\frac{M}{m_i}\)</span>，即除了 <span class="math inline">\(m_i\)</span> 以外 <span class="math inline">\(n-1\)</span> 个数的乘积</p></li>
<li><p>设 <span class="math inline">\(t_i=M_i^{-1}\)</span>，即求 <span class="math inline">\(M_i\)</span> 对 <span class="math inline">\(m_i\)</span> 的模反元素</p></li>
<li><p>那么方程组的通解即为 <span class="math display">\[
x=kM+\sum_{i=1}^na_it_iM_i,k\in\mathrm{Z}
\]</span> 在模 <span class="math inline">\(M\)</span>
的环中，方程组仅有一个唯一整数解 <span class="math display">\[
x=\sum_{i=1}^na_it_iM_i
\]</span></p></li>
</ol>
<h1 id="实例">实例</h1>
<p>以“物不知数”问题为例，运用中国剩余定理求解。</p>
<p>在该问题中，线性同余方程组为 <span class="math display">\[
\begin{cases}
x\equiv 2\pmod{3}\\
x\equiv 3\pmod{5}\\
x\equiv 2\pmod{7}
\end{cases}
\]</span> 其中模数 <span class="math inline">\(m_1=3,m_2=5,m_3=7\)</span>，得到 <span class="math inline">\(M=105\)</span>，对应的 <span class="math inline">\(M_1=35,M_2=21,M_3=15\)</span>，从而得到逆元 <span class="math inline">\(t_1=2,t_2=1,t_3=1\)</span></p>
<p>故得到基础解 <span class="math display">\[
70=2\times 35\equiv
\begin{cases}
1\pmod{3}\\
0\pmod{5}\\
0\pmod{7}\\
\end{cases},\
21=2\times 35\equiv
\begin{cases}
0\pmod{3}\\
1\pmod{5}\\
0\pmod{7}\\
\end{cases},\
15=2\times 35\equiv
\begin{cases}
0\pmod{3}\\
0\pmod{5}\\
1\pmod{7}\\
\end{cases}\\
\]</span> 将 <span class="math inline">\(a_1,a_2,a_3\)</span>
与基础解对应相乘并求和，得到方程组的解 <span class="math display">\[
233=2\times 70+3\times 21+2\times 15\equiv
\begin{cases}
2\times1+3\times0+2\times0\equiv2\pmod3\\
2\times0+3\times1+2\times0\equiv2\pmod5\\
2\times0+3\times0+2\times1\equiv2\pmod7
\end{cases}
\]</span> 故方程组通解为 <span class="math display">\[
x=233+k\times105,k\in\mathrm{Z}
\]</span> 当 <span class="math inline">\(k=-2\)</span>
时，有最小正整数解 <span class="math inline">\(x=23\)</span></p>
<h1 id="扩展">扩展</h1>
<p>中国剩余定理是适用于 <span class="math inline">\(m_i\)</span>
两两互素的情况的，如果不互素，需要使用合并方程的思想来转换成两两互素后求解。</p>
<p>证明如下</p>
<p>首先仅考虑方程组中的两个方程 <span class="math display">\[
\begin{cases}
x\equiv a_1\pmod{m_1}\\
x\equiv a_2\pmod{m_2}
\end{cases}
\]</span> 那么有 <span class="math display">\[
x=k_1m_1+a_1\\
x=k_2m_2+a_2\tag{*}
\]</span> 即 <span class="math inline">\(k_1m_1+a_1=k_2m_2+a_2\)</span>，变形为 <span class="math inline">\(m_1k_1=(a_2-a_1)+k_2m_2\)</span>，最终得到 <span class="math display">\[
m_1k_1=a_2-a_1\pmod{m_2}
\]</span> 显然，想要有解，必有 <span class="math inline">\(\gcd(m_1,m_2)|(a_2-a_1)\)</span></p>
<p>不妨设 <span class="math inline">\(d=\gcd(m_1,m_2),c=a_2-a_1\)</span>，则有 <span class="math display">\[
\frac{k_1m_1}{d}=\frac{c}{d}\pmod{\frac{m_2}{d}}\\
\Rightarrow
k_1=\frac{c}{d}\times\left(\frac{m_1}{d}\right)^{-1}\pmod{\frac{m_2}{d}}
\]</span> 令 <span class="math inline">\(K=\displaystyle\frac{c}{d}\times\left(\frac{m_1}{d}\right)^{-1}\)</span>，则
<span class="math inline">\(k_1=y\displaystyle\frac{m_2}{d}+K\\\)</span></p>
<p>代入方程 <span class="math inline">\((*)\)</span> 得 <span class="math display">\[
\begin{aligned}
x&amp;=m_1(y\frac{m_2}{d}+K)+a_1\\
&amp;=m_1K+y\frac{m_1m_2}{d}+a_1
\end{aligned}
\]</span> 即 <span class="math display">\[
x=m_1K+a_1\pmod{\frac{m_1m_2}{d}}
\]</span> 即 <span class="math display">\[
x\equiv a\pmod{m},\mathrm{其中}\ a=m_1K+a_11,m=\frac{m_1m_2}{d}
\]</span> 这样，就将方程组合并成为上面这个方程。</p>
<p>最终，合并 <span class="math inline">\(k\)</span> 个方程的最小 <span class="math inline">\(x\)</span> 值为 <span class="math inline">\(a\mod
m\)</span></p>
<p>例如，因为 <span class="math display">\[
84=2^2\times3\times7,160=2^5\times5,63=3^2\times7
\]</span> 我们通过合并可得 <span class="math display">\[
\begin{cases}
x\equiv23\pmod{84}\\
x\equiv7\pmod{160}\\
x\equiv2\pmod{63}
\end{cases}
\ \mathrm{与}\
\begin{cases}
x\equiv7\pmod{2^5}\\
x\equiv2\pmod{3^2}\\
x\equiv7\pmod{5}\\
x\equiv23\pmod{7}
\end{cases}
\ \mathrm{同解}
\]</span></p>
<h1 id="代码">代码</h1>
<p>对于 <span class="math inline">\(m_i\)</span> 互素的情况</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">alist, mlist</span>):</span></span><br><span class="line">    M = math.prod(mlist)</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ai, mi <span class="keyword">in</span> <span class="built_in">zip</span>(alist, mlist):</span><br><span class="line">        Mi = M // mi</span><br><span class="line">        d, _, ti = gmpy2.gcdext(mi, Mi)</span><br><span class="line">        <span class="keyword">if</span> d != <span class="number">1</span>: <span class="keyword">raise</span> Exception(<span class="string">&quot;Input not palistrwise co-prime&quot;</span>)</span><br><span class="line">        x += ai * ti * Mi</span><br><span class="line">    <span class="keyword">return</span> x % M, M</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>Crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>C语言和C++运算符保留字笔记</title>
    <url>//c-reserved-word-note.html</url>
    <content><![CDATA[<h1 id="c替代标记">C替代标记</h1>
<h2 id="简述">简述</h2>
<p>C替代标记指一批C语言常见运算符的可选拼写。它们实现为C标准库中iso646.h头文件内的一组宏定义。此标记作为C90标准的修正案于1995年增补。</p>
<p>替代标记允许程序员使用C语言按位和逻辑运算符，原因是原先的标记在一些国际和非QWERTY键盘上很难输入。</p>
<blockquote>
<p><del>个人而言使用这些替代标记让我在 python 和 C++
的切换中更加顺畅</del></p>
</blockquote>
<h2 id="c语言">C语言</h2>
<p>在<code>iso646.h</code>中定义了11个宏：</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">宏</th>
<th style="text-align: center;">定义为</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>and</code></td>
<td style="text-align: center;"><code>&amp;&amp;</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>and_eq</code></td>
<td style="text-align: center;"><code>&amp;=</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>bitand</code></td>
<td style="text-align: center;"><code>&amp;</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>bitor</code></td>
<td style="text-align: center;"><code>|</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>compl</code></td>
<td style="text-align: center;"><code>~</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>not</code></td>
<td style="text-align: center;"><code>!</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>not_eq</code></td>
<td style="text-align: center;"><code>!=</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>or</code></td>
<td style="text-align: center;"><code>||</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>or_eq</code></td>
<td style="text-align: center;"><code>|=</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>xor</code></td>
<td style="text-align: center;"><code>^</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>xor_eq</code></td>
<td style="text-align: center;"><code>^=</code></td>
</tr>
</tbody>
</table>
<p>在C语言中只需要包含头文件，即可使用这些关键字。</p>
<p>示例程序：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iso646.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> a = (<span class="number">10086</span>) <span class="keyword">and</span> (<span class="number">1024</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a);</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="c">C++</h2>
<p>在C++中，以上都为运算符关键字，无需包含头文件便可编译。</p>
<p>为了兼容C语言，C++98标准提供了头文件<code>&lt;ciso646&gt;</code>，但实际上这是个空文件。</p>
<p>实例程序：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> a = (<span class="number">10086</span>) <span class="built_in"><span class="keyword">and</span></span> (<span class="number">1024</span>);</span><br><span class="line">  std::cout &lt;&lt; a &lt;&lt; std::endl;</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>c++</tag>
        <tag>c</tag>
      </tags>
  </entry>
  <entry>
    <title>归档工具笔记</title>
    <url>//archiver-note.html</url>
    <content><![CDATA[<h1 id="简述">简述</h1>
<p>归档文件是由一个或多个计算机文件以及元数据组成的压缩文件。</p>
<p><strong>归档的特点</strong></p>
<ol type="1">
<li>数据压缩</li>
<li>加密</li>
<li>文件连接</li>
<li>自动提取</li>
<li>自动安装</li>
<li>源卷和媒体信息</li>
<li>文件跨越</li>
<li>校验和</li>
<li>目录结构信息</li>
<li>其他元数据（关于数据的数据）</li>
<li>错误发现</li>
</ol>
<p><strong>应用领域</strong></p>
<ol type="1">
<li>将计算机文件系统与元数据一起存储。</li>
<li>在本地传输文件有用。</li>
<li>用于通过网络传输文件。</li>
<li>软件包装应用。</li>
</ol>
<p>目的是使用时间换取空间。</p>
<p>目前来说，有很多种归档工具，下面只介绍我所见过的归档工具。</p>
<blockquote>
<p>仅是略写，更多详细的使用方式请使用相应工具的帮助功能
(<code>-h / -? / --help</code>)</p>
</blockquote>
<h1 id="ar">ar</h1>
<h2 id="简述-1">简述</h2>
<p><code>ar</code> 在 Linux 命令行中可以直接调用此工具。</p>
<h2 id="特征">特征</h2>
<p>文件开头含有 <code>!&lt;arch&gt;</code> 或者
<code>!&lt;thin&gt;</code> (这是一种简化的压缩)。</p>
<h2 id="命令">命令</h2>
<table>
<thead>
<tr class="header">
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>d</code></td>
<td>从归档文件中删除文件</td>
</tr>
<tr class="even">
<td><code>m[ab]</code></td>
<td>在归档文件中移动文件</td>
</tr>
<tr class="odd">
<td><code>p</code></td>
<td>打印在归档文件中找到的文件</td>
</tr>
<tr class="even">
<td><code>q[f]</code></td>
<td>将文件快速追加到归档文件中</td>
</tr>
<tr class="odd">
<td><code>r[ab][f][u]</code></td>
<td>替换归档文件中已有的文件或加入新文件</td>
</tr>
<tr class="even">
<td><code>s</code></td>
<td>act as ranlib</td>
</tr>
<tr class="odd">
<td><code>t</code></td>
<td>显示归档文件的内容</td>
</tr>
<tr class="even">
<td><code>x[o]</code></td>
<td>从归档文件中提取文件 (解压)</td>
</tr>
</tbody>
</table>
<h2 id="特定命令修饰符">特定命令修饰符</h2>
<table>
<thead>
<tr class="header">
<th>命令修饰符</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>[a]</code></td>
<td>将文件置于 [成员名] 之后</td>
</tr>
<tr class="even">
<td><code>[b]</code></td>
<td>将文件置于 [成员名] 之前 (于 <code>[i]</code> 相同)</td>
</tr>
<tr class="odd">
<td><code>[D]</code></td>
<td>use zero for timestamps and uids/gids</td>
</tr>
<tr class="even">
<td><code>[U]</code></td>
<td>use actual timestamps and uids/gids (default)</td>
</tr>
<tr class="odd">
<td><code>[N]</code></td>
<td>use instance <code>[count]</code> of name</td>
</tr>
<tr class="even">
<td><code>[f]</code></td>
<td>truncate inserted file names</td>
</tr>
<tr class="odd">
<td><code>[P]</code></td>
<td>在匹配时使用完整的路径名</td>
</tr>
<tr class="even">
<td><code>[o]</code></td>
<td>保留原来的日期</td>
</tr>
<tr class="odd">
<td><code>[u]</code></td>
<td>只替换比当前归档内容更新的文件</td>
</tr>
</tbody>
</table>
<h2 id="通用修饰符">通用修饰符</h2>
<table>
<thead>
<tr class="header">
<th>通用修饰符</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>[c]</code></td>
<td>不在必须创建库的时候给出警告</td>
</tr>
<tr class="even">
<td><code>[s]</code></td>
<td>创建归档索引 (cf. ranlib)</td>
</tr>
<tr class="odd">
<td><code>[S]</code></td>
<td>不要创建符号表</td>
</tr>
<tr class="even">
<td><code>[T]</code></td>
<td>make a thin archive</td>
</tr>
<tr class="odd">
<td><code>[v]</code></td>
<td>输出较多信息</td>
</tr>
<tr class="even">
<td><code>[V]</code></td>
<td>显示版本号</td>
</tr>
</tbody>
</table>
<h2 id="实例">实例</h2>
<ul>
<li><p>打包文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ar rv output.bak a.c b.c</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ar rv output.bak *.c</span><br></pre></td></tr></table></figure></li>
<li><p>显示打包文件内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ar t output.bak</span><br></pre></td></tr></table></figure></li>
<li><p>解压文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ar x output.bak</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="bzip2">bzip2</h1>
<h2 id="简述-2">简述</h2>
<p><code>bzip2</code> 是一个优秀的压缩算法，在 Linux 中经常被使用。</p>
<p>可以在 Linux 命令行中直接调用此工具。</p>
<p>可以使用 Bandizip 来解压缩。</p>
<h2 id="特征-1">特征</h2>
<p>后缀是 <code>.bz2</code></p>
<h2 id="命令-1">命令</h2>
<table>
<colgroup>
<col style="width: 6%">
<col style="width: 93%">
</colgroup>
<thead>
<tr class="header">
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-c</code></td>
<td>将压缩与解压缩的结果送到标准输出</td>
</tr>
<tr class="even">
<td><code>-d</code></td>
<td>执行解压缩</td>
</tr>
<tr class="odd">
<td><code>-f</code></td>
<td>bzip2在压缩或解压缩时，若输出文件与现有文件同名，预设不会覆盖现有文件。若要覆盖。请使用此参数</td>
</tr>
<tr class="even">
<td><code>-k</code></td>
<td>bzip2在压缩或解压缩后，会删除原始文件。若要保留原始文件，请使用此参数</td>
</tr>
<tr class="odd">
<td><code>-s</code></td>
<td>降低程序执行时内存的使用量</td>
</tr>
<tr class="even">
<td><code>-t</code></td>
<td>测试 <code>.bz2</code> 压缩文件的完整性</td>
</tr>
<tr class="odd">
<td><code>-v</code></td>
<td>压缩或解压缩文件时，显示详细的信息</td>
</tr>
<tr class="even">
<td><code>-z</code></td>
<td>强制执行压缩</td>
</tr>
<tr class="odd">
<td><code>-V</code></td>
<td>显示版本信息</td>
</tr>
<tr class="even">
<td><code>-#</code></td>
<td>指定压缩比；默认是6；数字越大压缩比越大（1-9）</td>
</tr>
</tbody>
</table>
<h2 id="实例-1">实例</h2>
<ul>
<li><p>压缩</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bzip2 filename</span><br></pre></td></tr></table></figure>
<p>压缩会将原来的文件删除，然后输出
<code>filename.bz2</code>，如果需要保留原文件请使用 <code>-k</code>
。</p></li>
<li><p>解压</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bzip2 -d filename</span><br></pre></td></tr></table></figure>
<p>解压会将压缩包删除，然后如果 <code>filename</code> 里有后缀
<code>.bz2</code>，则输出无后缀的文件；如果没有后缀，则输出同名文件。如果需要保留原文件请使用
<code>-k</code> 。</p></li>
</ul>
<h1 id="cpio">cpio</h1>
<h2 id="简述-3">简述</h2>
<p><code>cpio</code> 是用来建立，还原备份档的工具程序，它可以加入，解开
<code>cpio</code> 或 <code>tar</code> 备份档内的文件。</p>
<h2 id="特征-2">特征</h2>
<p>后缀是 <code>.cpio</code></p>
<h2 id="命令-2">命令</h2>
<table>
<thead>
<tr class="header">
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-o</code></td>
<td>指定运行为copy-out模式，即归档模式</td>
</tr>
<tr class="even">
<td><code>-i</code></td>
<td>指定运行为copy-in模式，即提取模式</td>
</tr>
<tr class="odd">
<td><code>-p</code></td>
<td>指定运行为copy-pass模式，即目录拷贝模式</td>
</tr>
<tr class="even">
<td><code>-t</code></td>
<td>列出归档文件中的文件列表</td>
</tr>
<tr class="odd">
<td><code>-d</code></td>
<td>当需要的时候自动创建目录</td>
</tr>
<tr class="even">
<td><code>-v</code></td>
<td>详细显示指令的执行过程</td>
</tr>
</tbody>
</table>
<h2 id="实例-2">实例</h2>
<ul>
<li><p>归档</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ls | cpio -ov &gt; obj.cpio</span><br></pre></td></tr></table></figure>
<p>将当前目录的文件归档到 <code>obj.cpio</code> 中</p></li>
<li><p>提取</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cpio -idv &lt; obj.cpio</span><br></pre></td></tr></table></figure>
<p>提取归档文件 <code>obj.cpio</code></p></li>
</ul>
<h1 id="gzip">gzip</h1>
<h2 id="简述-4">简述</h2>
<p><code>gzip</code> 的是标准的，广泛使用的文件压缩和解压工具。
<code>gzip</code> 允许文件级联。</p>
<p>可以直接在 Linux 命令行中调用此工具。</p>
<p>可以使用 Bandizip 解压缩。</p>
<h2 id="特征-3">特征</h2>
<p>后缀为 <code>.gz</code></p>
<h2 id="命令-3">命令</h2>
<table>
<colgroup>
<col style="width: 6%">
<col style="width: 93%">
</colgroup>
<thead>
<tr class="header">
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-c</code></td>
<td>将输出写到标准输出上，并保留原有文件</td>
</tr>
<tr class="even">
<td><code>-d</code></td>
<td>将压缩文件解压</td>
</tr>
<tr class="odd">
<td><code>-l</code></td>
<td>对每个压缩文件，显示下列字段：<br>压缩文件的大小；未压缩文件的大小；压缩比；未压缩文件的名字</td>
</tr>
<tr class="even">
<td><code>-r</code></td>
<td>递归式地查找指定目录并压缩其中的所有文件或者是解压缩</td>
</tr>
<tr class="odd">
<td><code>-t</code></td>
<td>测试，检查压缩文件是否完整</td>
</tr>
<tr class="even">
<td><code>-v</code></td>
<td>对每一个压缩和解压的文件，显示文件名和压缩比</td>
</tr>
<tr class="odd">
<td><code>-#</code></td>
<td>指定压缩比（1-9），系统缺省值为 6。</td>
</tr>
</tbody>
</table>
<h2 id="实例-3">实例</h2>
<ul>
<li><p>压缩</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gzip filename</span><br></pre></td></tr></table></figure></li>
<li><p>解压</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gzip -dv filename</span><br></pre></td></tr></table></figure></li>
<li><p>列出压缩文件信息</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gzip -l filename</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="lz4">lz4</h1>
<h2 id="简述-5">简述</h2>
<p><code>lz4</code> 在压缩率上略微逊色,
但是在解压速度上有着惊人的优势。</p>
<p>因为压缩时高效的多核利用，再加上惊艳的解压，<code>lz4</code>
已经在非常多重要场合使用了</p>
<h2 id="特征-4">特征</h2>
<p>后缀为 <code>.lz4</code></p>
<h2 id="命令-4">命令</h2>
<table>
<thead>
<tr class="header">
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-d</code></td>
<td>解压缩（默认为 <code>.lz4</code> 扩展名）</td>
</tr>
<tr class="even">
<td><code>-z</code></td>
<td>强制压缩</td>
</tr>
<tr class="odd">
<td><code>-f</code></td>
<td>覆盖输出而不提示</td>
</tr>
<tr class="even">
<td><code>-k</code></td>
<td>保留源文件（默认）</td>
</tr>
<tr class="odd">
<td><code>-v</code></td>
<td>详细模式</td>
</tr>
<tr class="even">
<td><code>-q</code></td>
<td>取消警告；指定两次也可以取消错误</td>
</tr>
<tr class="odd">
<td><code>-t</code></td>
<td>测试压缩文件完整性</td>
</tr>
<tr class="even">
<td><code>-m</code></td>
<td>多个输入文件（表示自动输出文件名）</td>
</tr>
<tr class="odd">
<td><code>-r</code></td>
<td>在目录上递归操作（也设置为-m）</td>
</tr>
<tr class="even">
<td><code>-l</code></td>
<td>使用旧格式压缩（Linux内核压缩）</td>
</tr>
<tr class="odd">
<td><code>-#</code></td>
<td>压缩效率（1-9），默认为1</td>
</tr>
</tbody>
</table>
<h2 id="实例-4">实例</h2>
<ul>
<li><p>压缩</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lz4 filename</span><br></pre></td></tr></table></figure></li>
<li><p>解压</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lz4 -d filename</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="lzip">lzip</h1>
<h2 id="简述-6">简述</h2>
<p><code>lzip</code> 是一个无损的数据压缩和解压缩工具，它采用的是 LZMA
算法。</p>
<p>可以使用 Bandizip 解压缩</p>
<h2 id="特征-5">特征</h2>
<p>后缀为 <code>.lz</code></p>
<h2 id="实例-5">实例</h2>
<ul>
<li><p>压缩</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lzip filename</span><br></pre></td></tr></table></figure></li>
<li><p>解压</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lzip -d filename</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="lzma">lzma</h1>
<h2 id="简述-7">简述</h2>
<p>LZMA，（Lempel-Ziv-Markov
chain-Algorithm的缩写），是一个Deflate和LZ77算法改良和优化后的压缩算法，开发者是Igor
Pavlov，2001年被首次应用于7-Zip压缩工具中，是
2001年以来得到发展的一个数据压缩算法。</p>
<p>Linux 命令行中可以直接调用 <code>lzma</code> 工具。</p>
<p>可以使用 Bandizip 解压缩。</p>
<h2 id="特征-6">特征</h2>
<p>后缀为 <code>.lzma</code></p>
<h2 id="命令-5">命令</h2>
<table>
<colgroup>
<col style="width: 6%">
<col style="width: 93%">
</colgroup>
<thead>
<tr class="header">
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-d</code></td>
<td>解压缩</td>
</tr>
<tr class="even">
<td><code>-f</code></td>
<td>强制解压/压缩，忽略一切问题，比如：目标文件已经存在，直接覆盖等</td>
</tr>
<tr class="odd">
<td><code>-k</code></td>
<td>不删除原始文件</td>
</tr>
<tr class="even">
<td><code>-t</code></td>
<td>测试，不解压</td>
</tr>
<tr class="odd">
<td><code>-v</code></td>
<td>显示进度等信息，</td>
</tr>
<tr class="even">
<td><code>-z</code></td>
<td>强制压缩</td>
</tr>
<tr class="odd">
<td><code>-#</code></td>
<td>压缩比（1-9），默认1</td>
</tr>
</tbody>
</table>
<h2 id="实例-6">实例</h2>
<ul>
<li><p>压缩</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lzma test.tar</span><br></pre></td></tr></table></figure>
<p>默认删除文件，如果需要保留需要使用 <code>-k</code> 选项</p></li>
<li><p>解压</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lzma -d test.tar.lzma</span><br></pre></td></tr></table></figure>
<p>默认删除文件，如果需要保留需要使用 <code>-k</code> 选项</p></li>
</ul>
<h1 id="lzop">lzop</h1>
<h2 id="简述-8">简述</h2>
<p><code>lzop</code> 工具最适合在注重压缩速度的场合，压缩文件时会新建
<code>.lzo</code> 文件，而原文件保持不变 (使用 <code>-U</code>
选项除外)</p>
<h2 id="特征-7">特征</h2>
<p>后缀为 <code>.lzo</code></p>
<h2 id="命令-6">命令</h2>
<table>
<colgroup>
<col style="width: 6%">
<col style="width: 93%">
</colgroup>
<thead>
<tr class="header">
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-d</code></td>
<td>解压缩</td>
</tr>
<tr class="even">
<td><code>-f</code></td>
<td>强制解压/压缩，忽略一切问题，比如：目标文件已经存在，直接覆盖等</td>
</tr>
<tr class="odd">
<td><code>-l</code></td>
<td>列出压缩文件的信息</td>
</tr>
<tr class="even">
<td><code>-U</code></td>
<td>删除原始文件</td>
</tr>
<tr class="odd">
<td><code>-t</code></td>
<td>测试，不解压</td>
</tr>
<tr class="even">
<td><code>-v</code></td>
<td>显示进度等信息，</td>
</tr>
<tr class="odd">
<td><code>-z</code></td>
<td>强制压缩</td>
</tr>
<tr class="even">
<td><code>-#</code></td>
<td>压缩比（1-9），默认1</td>
</tr>
</tbody>
</table>
<h2 id="实例-7">实例</h2>
<ul>
<li><p>压缩</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lzop filename</span><br></pre></td></tr></table></figure></li>
<li><p>解压</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lzop -dv filename.lzo</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="tar">tar</h1>
<h2 id="简述-9">简述</h2>
<p>Linux <code>tar</code>（英文全拼：tape archive
）命令用于备份文件。</p>
<p><code>tar</code>
是用来建立，还原备份文件的工具程序，它可以加入，解开备份文件内的文件。</p>
<p>可以使用 Bandizip 解压缩</p>
<h2 id="特征-8">特征</h2>
<p>后缀为 <code>.tar</code></p>
<h2 id="命令-7">命令</h2>
<table>
<thead>
<tr class="header">
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-c</code></td>
<td>建立一个压缩文件</td>
</tr>
<tr class="even">
<td><code>-x</code></td>
<td>将压缩文件解压</td>
</tr>
<tr class="odd">
<td><code>-t</code></td>
<td>查看压缩文件详细信息</td>
</tr>
<tr class="even">
<td><code>-z</code></td>
<td>是否需要用 <code>gzip</code> 压缩</td>
</tr>
<tr class="odd">
<td><code>-j</code></td>
<td>是否需要用 <code>bzip2</code> 压缩</td>
</tr>
<tr class="even">
<td><code>-v</code></td>
<td>显示详细信息</td>
</tr>
<tr class="odd">
<td><code>-f</code></td>
<td>指定档名</td>
</tr>
<tr class="even">
<td><code>-p</code></td>
<td>使用原文件的原来属性</td>
</tr>
</tbody>
</table>
<h2 id="实例-8">实例</h2>
<ul>
<li><p>打包</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -cvf test.tar test.txt</span><br></pre></td></tr></table></figure></li>
<li><p>以 <code>gzip</code> 压缩</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zcvf test.tar test.txt</span><br></pre></td></tr></table></figure></li>
<li><p>以 <code>bzip2</code> 压缩</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -jcvf test.tar test.txt</span><br></pre></td></tr></table></figure></li>
<li><p>解压缩</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zxvf test.tar</span><br></pre></td></tr></table></figure>
<p>还可以指定压缩包内的某个文件打开</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zxvf test.tar test.txt</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="xz">xz</h1>
<h2 id="简述-10">简述</h2>
<p><code>xz</code> 是一种压缩文件格式，采用LZMA SDK压缩，目标文件较
<code>gzip</code> 压缩文件小。</p>
<p>可以使用 Bandizip 解压缩。</p>
<h2 id="特征-9">特征</h2>
<p>文件后缀为 <code>.xz</code></p>
<h2 id="命令-8">命令</h2>
<table>
<thead>
<tr class="header">
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-d</code></td>
<td>解压缩</td>
</tr>
<tr class="even">
<td><code>-z</code></td>
<td>强制压缩</td>
</tr>
<tr class="odd">
<td><code>-f</code></td>
<td>覆盖输出而不提示</td>
</tr>
<tr class="even">
<td><code>-k</code></td>
<td>保留源文件（默认）</td>
</tr>
<tr class="odd">
<td><code>-v</code></td>
<td>详细模式</td>
</tr>
<tr class="even">
<td><code>-q</code></td>
<td>取消警告；指定两次也可以取消错误</td>
</tr>
<tr class="odd">
<td><code>-t</code></td>
<td>测试压缩文件完整性</td>
</tr>
<tr class="even">
<td><code>-m</code></td>
<td>多个输入文件（表示自动输出文件名）</td>
</tr>
<tr class="odd">
<td><code>-r</code></td>
<td>在目录上递归操作（也设置为-m）</td>
</tr>
<tr class="even">
<td><code>-l</code></td>
<td>使用旧格式压缩（Linux内核压缩）</td>
</tr>
<tr class="odd">
<td><code>-#</code></td>
<td>压缩效率（1-9），默认为6</td>
</tr>
</tbody>
</table>
<h2 id="实例-9">实例</h2>
<ul>
<li><p>压缩</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xz test.txt</span><br></pre></td></tr></table></figure></li>
<li><p>解压</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xz -d test.txt.xz</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>torrent笔记</title>
    <url>//torrent-note.html</url>
    <content><![CDATA[<h1 id="前文">前文</h1>
<p>要理解下面的内容之前，首先要知道什么是 BitTorrent</p>
<p>BitTorrent 是一种点对点（P2P, Peers to
Peers）的通信协议，用于在互联网上分发大量的数据和电子文件，包括但不限于数字视频文件或者歌曲文件。</p>
<p>而点对点（P2P, Peers to Peers）网络是指仅两台或多台 PC
连接并共享资源而无需通过单独的服务器的用户网络。</p>
<p>BitTorrent 协议可用于减少分发大文件对服务器和网络的影响。BitTorrent
协议不是从单个源服务器下载文件，而是允许用户加入主机“群”（一群人下载和上传相同的文件），以同时从彼此下载和上传。</p>
<p>使用 BitTorrent
协议，几台基本计算机（例如家用计算机）可以取代大型服务器，同时有效地将文件分发给许多收件人。这种较低的带宽使用量还有助于防止给定区域的互联网流量大幅飙升，从而为所有用户保持更高的互联网速度，无论他们是否使用
BitTorrent 协议。</p>
<h1 id="bencoding-编码">Bencoding 编码</h1>
<p>Bencoding 编码在 BitTorrent 协议中非常常见，更重要的是，BT
种子文件本身就是一个该编码的字典。</p>
<p>Bencoding 编码是一种非常简洁的数据格式，共支持 4 种不同的类型：</p>
<ol type="1">
<li><p>字符串</p>
<p>格式为 <code>&lt;字符串长度&gt;:&lt;字符串&gt;</code>，例如
<code>4:qsdz</code> 代表字符串 <code>qsdz</code></p></li>
<li><p>整型</p>
<p>格式为 <code>i&lt;值&gt;e</code>，例如 <code>i10086e</code> 代表整型
<code>10086</code></p></li>
<li><p>列表</p>
<p>格式为 <code>l[data1][data2][...]e</code>，例如
<code>l4:qsdz4:yydsi666ee</code> 可以拆分看作
<code>l[4:qsdz][4:yyds][i666e]e</code>，即表示列表
<code>[qsdz, yyds, 666]</code></p></li>
<li><p>字典</p>
<p>格式为 <code>d[key1][value2][...]e</code>，例如
<code>d4:qsdzi666e4:yyds2:mee</code> 可以拆分看作
<code>d[4:qsdz][i666e][4:yyds][2:me]e</code>，即表示字典
<code>&#123;qsdz:666, yyds:me&#125;</code></p>
<p>但是需要注意的是，字典的 key
必须是字符串，并且需按照字母顺序排序。</p></li>
</ol>
<h1 id="seeds-peers-leechers">Seeds &amp; Peers &amp; Leechers</h1>
<p><strong>Seed </strong>是一个在其客户端中打开 torrent
文件的人（假设你正在尝试下载相同的文件），你和他们之间的唯一区别是他们已经下载了完整的文件并且现在正在<strong>播种</strong>，即正在<strong>共享</strong>给
<strong>Peers</strong> 文件，但不从其他人那里下载文件的任何部分。</p>
<p><strong>Leecher</strong>
是那些同时进行下载和上传的人。如果用户开始共享他已经拥有的文件，并下载其他用户已经上传或正在上传
torrent 文件的文件，他就成为了
<strong>Leecher</strong>。显而易见，<strong>Leechers</strong>
倾向于下载他们所没有的资源，共享他们已有的资源。</p>
<p>理论上来说，<strong>播种</strong>的人越多，对种子文件的下载速度就会越快。当
<strong>Leechers</strong>
的文件下载完成，并且他们仍然没有从上传中删除该文件时，他们就会成为
<strong>Seeds</strong>。</p>
<figure>
<img src="/torrent-note/关系图.png" alt="关系图">
<figcaption aria-hidden="true">关系图</figcaption>
</figure>
<p>在上图中，中间的电脑即是 <strong>Seed</strong>，而其他的电脑是
<strong>Peers</strong>。</p>
<p><strong>Peer</strong>
是在种子网络中同时下载和上传文件的人。文件是分块下载的，当一个用户下载了一些文件块后，他就会自动开始上传它。</p>
<p>如果更多的人参与到种子网络中，文件的下载速度就会更快。当一个节点下载完毕并希望继续上传时，他就变成了
<strong>Seed</strong>。</p>
<h1 id="种子文件与磁力链接">种子文件与磁力链接</h1>
<p>在很早的网络时代，下载都是简单的集中式客户端/服务器模式，一个或多个服务器支撑成千上万的客户端连接下载，不仅带宽遇到了瓶颈，而且太容易出现单点故障。这时
P2P 被提出来解决这个问题，通过分布式提高网络资源的利用率。但是 P2P
只是一个理念，真正将这个理念贯彻的还是 BitTorrent 协议。</p>
<p>在 BitTorrent （简称
BT）中，所有的资源被切成很小的一份文件块（<strong>pieces</strong>），在这个基础上，BitTorrent
网络中的所有具有相同请求的用户可以相互传资源碎片，并且谁传得越多谁就能获得越多。</p>
<p>而种子文件，就是拥有完整资源的人，根据 BitTorrent
协议，生成的一个包含 Tracker 信息和文件信息的文本文件。</p>
<p>Tracker 信息主要是BT下载中需要用到的 Tracker 服务器的地址和针对
Tracker 服务器的设置，文件信息是根据对目标文件的计算生成的，计算结果根据
BitTorrent 协议内的 Bencode
规则进行编码。它的主要原理是需要把提供下载的文件虚拟分成大小相等的块，块大小必须为2k的整数次方（由于是虚拟分块，硬盘上并不产生各个块文件），并把每个块的索引信息和
Hash
验证码写入种子文件中；所以，种子文件就是被下载文件的<strong>索引</strong>。</p>
<p>下载者要下载文件内容，需要先得到相应的种子文件，然后使用 BT
客户端软件进行下载。 下载时，BT 客户端首先解析种子文件得到 Tracker
地址，然后连接 Tracker 服务器。Tracker
服务器回应下载者的请求，提供下载者其他下载者（包括发布者）的 IP。</p>
<p>下载者再连接其他下载者，根据种子文件，两者分别告知对方自己已经有的块，然后交换对方所没有的数据。此时不需要其他服务器参与，分散了单个线路上的数据流量，因此减轻了服务器负担。
下载者每得到一个块，需要算出下载块的 Hash
验证码与种子文件中的对比，如果一样则说明块正确，不一样则需要重新下载这个块。</p>
<p>与此同时，当拥有完整文件的用户越多，种子的寿命也就越长。</p>
<p>综上所述，可以看出 Tracker
服务器在BT网络中充当着非常重要的作用，和传统的客户端/服务器模式一样，Tracker
服务器同样会存在单点故障问题。所以在BT技术的基础上，后来又衍生出 DHT
网络和磁力链接技术，DHT 全称为分布式哈希表（Distributed Hash
Table），是一种分布式存储方法。</p>
<p>DHT 网络是 Tracker-less 的，不依赖于其他的 Tracker
服务器。在这种情况下，每个客户端负责一个小范围的路由，并负责存储一小部分数据，从而实现整个
DHT
网络的寻址和存储。使用支持该技术的BT下载软件，用户无需连上Tracker就可以下载，因为软件会在
DHT 网络中寻找下载同一文件的其他用户并与之通讯，开始下载任务。</p>
<p>在网络中定位资源最简单的方法是URL（统一资源定位符），它是通过资源的位置来进行定位。而在DHT网络中，则是使用URN（统一资源名称）来进行定位，磁力链接就是基于文件内容的散列函数值来链接到特定文件，生成一个唯一的文件识别符，从而在DHT网络中定位并下载文件。</p>
<p>磁力链接格式如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">magnet:?xt=urn:btih:e2467cbf021192c241367b892230dc1e05c0580e</span><br></pre></td></tr></table></figure>
<p>其中 <code>urn</code> 为统一资源名称，<code>bith</code> 是
<strong>BitTorrent Info Hash</strong> 的缩写，是 BitTorrent 使用的 Hash
函数。</p>
<p>实际上除了 <code>bith</code> 还可以是其他类型的 Hash
函数，但主流仍然是 <code>bith</code>。</p>
<p>通过这一串字符串，BT 工具就可以在 DHT 网络中定位下载文件。</p>
<p>根据以上我们可以得知，种子的稳定性高，信息多，但不便于传播扩散；而磁力链接不稳定，可能在某时刻不能获取，但是很便于扩散。</p>
<h1 id="dht-网络">DHT 网络</h1>
<p>磁力链接的发明使得 P2P 客户端直接从 DHT
网络中寻找资源，而不是传统的依赖于 Tracker 服务器，这样就避免了 Tracker
服务器的单点故障问题，所以从 DHT 中获取的种子有时候也叫做
<code>Trackerless torrent</code>。DHT
网络是一种分布式的去中心化网络，每个加入 DHT
网络的节点都要负责存储这个网络中的资源和其他成员的联系信息。</p>
<p>DHT
网络很像是六人定律，它通过用户与用户之间的联系和转移，最终得到我们的目标。</p>
<p>如果一个新节点要加入到 DHT
网络中，它必须要先认识一个人带你进去。这样的人我们把他叫做
<code>bootstrap node</code>，常见的 <code>bootstrap node</code>
有：<code>router.bittorrent.com</code>、<code>router.utorrent.com</code>、<code>router.bitcomet.com</code>、<code>dht.transmissionbt.com</code>
等等。</p>
<p>所以在一个 torrent 流量中，我们经常能看到一开始会有 DNS
请求。例如下图</p>
<figure>
<img src="/torrent-note/bootstrap%20node.png" alt="bootstrap node">
<figcaption aria-hidden="true">bootstrap node</figcaption>
</figure>
<h1 id="krpc-协议">KRPC 协议</h1>
<p>DHT 建立在 UDP 之上，想要获取需要的 Peers 信息，首先要了解下
<code>Kademlia</code> 的 <code>KRPC</code> 协议。 关于路由表和 Kademlia
的介绍，可以参照官方文档。我们这里的重点在于如何根据磁力链接获取拥有该磁力链接对应的种子文件信息的
Peers，所以只需要了解 <code>KRPC</code> 协议。 <code>KRPC</code>
协议是由 Bencoding 编码组成的一个简单的 RPC
结构，有4种请求：<code>ping</code>、<code>find_node</code>、<code>get_peers</code>
和 <code>announce_peer</code>。</p>
<ul>
<li><code>ping</code> → 检测节点是否可达，请求包含一个参数
<code>id</code>，代表该节点的 id。对应的回复也应该包含回复者的id。</li>
<li><code>find_node</code> → 该请求包含两个参数 <code>id</code> 和
<code>target</code>，<code>id</code> 为该节点的 id，<code>target</code>
为要查询的 id。回复中应该包含被请求节点的路由表中距离
<code>target</code> 最接近的 8 个 id。</li>
<li><code>get_peers</code> → 该请求包含两个参数 <code>id</code> 和
<code>infohash</code>，<code>id</code> 为该节点的
id，<code>info_hash</code> 为种子文件的SHA1哈希值，也就是磁力链接的
<code>btih</code> 值。如果被请求的节点有对应 <code>info_hash</code> 的
<strong>peers</strong>，他将返回一个关键字
<code>values</code>，这是一个列表类型的字符串。每一个字符串包含了
<code>CompactIP-address/portinfo</code>
格式的peers信息。如果被请求的节点没有这个 <code>infohash</code> 的
<strong>peers</strong>，那么他将返回关键字
<code>nodes</code>，这个关键字包含了被请求节点的路由表中离
<code>info_hash</code> 最近的 K 个 <strong>nodes</strong>，使用
<code>Compactnodeinfo</code> 格式回复。</li>
<li><code>announce_peer</code> → 如果节点正在下载 torrent
文件，则需要通知其他人你正在哪个端口进行下载，这样就可以分享给其他人，让其他人连接你进行下载。</li>
</ul>
<p>在 WireShark 中，可以查看 <code>BT-DHT</code> 协议查看这些请求：</p>
<ul>
<li><p><code>ping</code></p>
<figure>
<img src="/torrent-note/ping%20request.png" alt="ping request">
<figcaption aria-hidden="true">ping request</figcaption>
</figure></li>
<li><p><code>find_node</code></p>
<figure>
<img src="/torrent-note/find_node%20request.png" alt="find_node request">
<figcaption aria-hidden="true">find_node request</figcaption>
</figure></li>
<li><p><code>get_peers</code></p>
<figure>
<img src="/torrent-note/get_peers%20request.png" alt="get_peers request">
<figcaption aria-hidden="true">get_peers request</figcaption>
</figure></li>
<li><p><code>announce_peer</code></p>
<figure>
<img src="/torrent-note/announce_peer%20request.png" alt="announce_peer request">
<figcaption aria-hidden="true">announce_peer request</figcaption>
</figure></li>
</ul>
<h1 id="种子文件格式">种子文件格式</h1>
<p>BT种子文件整个是一个 Bencoding 编码字典格式，比较重要的
<code>key</code> 有：</p>
<ul>
<li><code>announce</code> → tracker 服务器的地址</li>
<li><code>announce-list</code> → 可选的 tracker 服务器地址</li>
<li><code>creation date</code> → 文件创建时间</li>
<li><code>created by</code> → 文件创建者</li>
<li><code>info</code> → BT 种子文件的文件信息</li>
</ul>
<p>而 <code>info</code> 的 <code>value</code>
会根据种子包含的是单文件还是多文件有所区别，以下是公共部分：</p>
<ul>
<li><code>piece length</code> → 每一数据块的长度</li>
<li><code>pieces</code> → 所有数据块的 SHA1 校验值</li>
</ul>
<p>如果种子包含的是单文件，则还有以下 <code>key</code></p>
<ul>
<li><code>name</code> → 文件名称</li>
<li><code>length</code> → 文件的长度</li>
</ul>
<p>如果包含的是多文件，则是以下 <code>key</code></p>
<ul>
<li><code>name</code> → 文件夹名称</li>
<li><code>files</code> →
文件列表，每个文件列表下面是包括每一个单文件的信息，文件信息是个字典</li>
</ul>
<p>而 <code>info</code> 中的内容是种子文件中的重中之重，在 DHT
网络中保留的内容就是 <code>info</code> 字段的内容。</p>
<p>而磁力链接中的 <code>infohash</code> 便是根据 <code>info</code>
字段的内容计算的，<code>info</code> 字段的 <code>pieces</code>
字段为每个数据块的校验值，作用便是验证下载的文件是否正确。</p>
<p>要注意的是 <code>info</code>字段的下载也是分块的下载完成后使用
<code>infohash</code> 进行校验。</p>
<p>所以，我们可以知道，磁力链接下载文件分成两个步骤：</p>
<ol type="1">
<li>根据 <code>infohash</code> 下载种子文件的 <code>info</code>
字段，注意到种子文件并不是必须的。</li>
<li>再根据 <code>info</code>
下载源文件，将每一个数据块进行校验，不一致则重新下载。</li>
</ol>
<p>需要注意的是，一般的种子文件会包含 <code>announce</code>，也就是
tracker 服务器的地址，如果没有 tracker 服务器，文件中可能会包含
<code>nodes</code>，<code>nodes</code> 是存有种子信息的
<strong>peer</strong> 节点，这样的种子文件就是
<code>trackerless torrent</code>。如果有 nodes 客户端直接从
<code>nodes</code> 获取种子信息，而从 DHT 网络中下载下来的种子文件既没有
<code>annouce</code> 也没有 <code>nodes</code>，客户端只能通过
<code>info</code> 字段计算出 <code>hashinfo</code>，再从
<code>bootstrap node</code> 节点开始在 DHT 网络中寻找种子信息。</p>
<h1 id="utp-协议">uTP 协议</h1>
<p><code>uTP</code> 是一个基于 UDP 的开放的 BT 点对点文件共享协议。</p>
<p>在<code>uTP</code>协议出现之前，BT下载会占用网络中大量的链接，直接导致其它网络应用服务质量下载和网络的拥堵，因此有很多ISP都开始限制BT的下载。<code>uTP</code>减轻了网络延迟并解决了传统的基于TCP的BT协议所遇到的拥塞控制问题，提供可靠的有序的传送。</p>
<p>一个有效的 <code>uTP</code> 数据包包含下面格式的报头：</p>
<figure>
<img src="/torrent-note/uTP-header.png" alt="uTP-header">
<figcaption aria-hidden="true">uTP-header</figcaption>
</figure>
<p>其中，我们最为关心的是
<code>type</code>、<code>connection id</code>、<code>seq_nr</code>和<code>ack_nr</code>
这几个值。<code>type</code> 字段表示包类型，uTP的包类型有下面5种：</p>
<ul>
<li><code>ST_DATA</code> = 0 → 最重要的数据包，uTP
就是使用该类型的包传送数据</li>
<li><code>ST_FIN</code> = 1 → 关闭连接，这是 uTP
连接的最后一个包，类似于 TCP 中的 FIN</li>
<li><code>ST_STATE</code> = 2 →
简单的应答包，表明已从对方收到了数据包，该包不包含任何数据，<code>seq_nr</code>
值不变</li>
<li><code>ST_RESET</code> = 3 → 终止连接，类似于 TCP 中的
<code>RST</code></li>
<li><code>ST_SYN</code> = 4 → 初始化连接，类似于 TCP 中的
<code>SYN</code>，这是 uTP 连接的第一个包</li>
</ul>
<p>关于 <code>uTP</code> 协议的内容参考官方文档<a href="http://www.bittorrent.org/beps/bep_0029.html">BEP-029</a>。</p>
<p><code>uTP</code> 的一个很重要的特点是使用 <code>connection id</code>
来标识一次连接，而不是每个包算一次连接。所以在分析 <code>ST_DATA</code>
时，需要注意找所有 <code>connection id</code> 相同的数据包，然后按
<code>seq_nr</code> 排序，<code>seq_nr</code> 应该是依次递增的（注意
<code>ST_STATE</code> 包不会增加<code>seq_nr</code>值），如果发现两个
<code>ST_DATA</code> 的 <code>seq_nr</code>
值相同则说明后面那个报文是重复报文需要忽略掉，如果发现两个
<code>ST_DATA</code> 的 <code>seq_nr</code>
值不是连续的，中间差了一个或多个，则可能是由于网络原因发生了丢包现象，数据包将不可用。</p>
<p>下图是一个简单的 <code>ST_SYN</code> 包：</p>
<figure>
<img src="/torrent-note/st_syn.png" alt="st_syn">
<figcaption aria-hidden="true">st_syn</figcaption>
</figure>
<h1 id="peer-wire协议">Peer Wire协议</h1>
<p><code>Peer Wire</code>
协议是Peer之间的通信协议，通常由一个握手消息开始。握手消息的格式是这样的：<code>&lt;pstrlen&gt;&lt;pstr&gt;&lt;reserved&gt;&lt;info_hash&gt;&lt;peer_id&gt;</code>
下面是一个握手报文的示例：</p>
<figure>
<img src="/torrent-note/handshake.png" alt="handshake">
<figcaption aria-hidden="true">handshake</figcaption>
</figure>
<p>关于 <code>Peer Wire</code> 协议的详细内容，请参考<a href="https://wiki.theory.org/BitTorrentSpecification">BitTorrent的规范</a>。</p>
]]></content>
      <tags>
        <tag>note</tag>
        <tag>torrent</tag>
      </tags>
  </entry>
</search>
